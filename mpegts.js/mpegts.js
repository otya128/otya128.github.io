!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.mpegts=t():e.mpegts=t()}(window,(function(){return function(e){var t={};function i(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(a,n,function(t){return e[t]}.bind(null,n));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=29)}([function(e,t,i){"use strict";var a=i(9),n=i.n(a),r=function(){function e(){}return e.e=function(t,i){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var a="[".concat(t,"] > ").concat(i);e.ENABLE_CALLBACK&&e.emitter.emit("log","error",a),e.ENABLE_ERROR&&(console.error?console.error(a):console.warn?console.warn(a):console.log(a))},e.i=function(t,i){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var a="[".concat(t,"] > ").concat(i);e.ENABLE_CALLBACK&&e.emitter.emit("log","info",a),e.ENABLE_INFO&&(console.info?console.info(a):console.log(a))},e.w=function(t,i){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var a="[".concat(t,"] > ").concat(i);e.ENABLE_CALLBACK&&e.emitter.emit("log","warn",a),e.ENABLE_WARN&&(console.warn?console.warn(a):console.log(a))},e.d=function(t,i){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var a="[".concat(t,"] > ").concat(i);e.ENABLE_CALLBACK&&e.emitter.emit("log","debug",a),e.ENABLE_DEBUG&&(console.debug?console.debug(a):console.log(a))},e.v=function(t,i){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var a="[".concat(t,"] > ").concat(i);e.ENABLE_CALLBACK&&e.emitter.emit("log","verbose",a),e.ENABLE_VERBOSE&&console.log(a)},e}();r.GLOBAL_TAG="mpegts.js",r.FORCE_GLOBAL_TAG=!1,r.ENABLE_ERROR=!0,r.ENABLE_INFO=!0,r.ENABLE_WARN=!0,r.ENABLE_DEBUG=!0,r.ENABLE_VERBOSE=!0,r.ENABLE_CALLBACK=!1,r.emitter=new n.a,t.a=r},function(e,t,i){"use strict";var a;!function(e){e.IO_ERROR="io_error",e.DEMUX_ERROR="demux_error",e.INIT_SEGMENT="init_segment",e.MEDIA_SEGMENT="media_segment",e.LOADING_COMPLETE="loading_complete",e.RECOVERED_EARLY_EOF="recovered_early_eof",e.MEDIA_INFO="media_info",e.METADATA_ARRIVED="metadata_arrived",e.SCRIPTDATA_ARRIVED="scriptdata_arrived",e.TIMED_ID3_METADATA_ARRIVED="timed_id3_metadata_arrived",e.SYNCHRONOUS_KLV_METADATA_ARRIVED="synchronous_klv_metadata_arrived",e.ASYNCHRONOUS_KLV_METADATA_ARRIVED="asynchronous_klv_metadata_arrived",e.SMPTE2038_METADATA_ARRIVED="smpte2038_metadata_arrived",e.SCTE35_METADATA_ARRIVED="scte35_metadata_arrived",e.PES_PRIVATE_DATA_DESCRIPTOR="pes_private_data_descriptor",e.PES_PRIVATE_DATA_ARRIVED="pes_private_data_arrived",e.STATISTICS_INFO="statistics_info",e.RECOMMEND_SEEKPOINT="recommend_seekpoint",e.DURATION_AVAILABLE="duration_available",e.SYSTEM_CLOCK="system_clock",e.AUDIO_TRACKS_METADATA="audio_tracks_metadata"}(a||(a={})),t.a=a},function(e,t,i){"use strict";i.d(t,"c",(function(){return n})),i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return o}));var a=i(3),n={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},r={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},o=function(){function e(e){this._type=e||"undefined",this._status=n.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return e.prototype.destroy=function(){this._status=n.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null},e.prototype.isWorking=function(){return this._status===n.kConnecting||this._status===n.kBuffering},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"needStashBuffer",{get:function(){return this._needStash},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onContentLengthKnown",{get:function(){return this._onContentLengthKnown},set:function(e){this._onContentLengthKnown=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onURLRedirect",{get:function(){return this._onURLRedirect},set:function(e){this._onURLRedirect=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(e){this._onDataArrival=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onError",{get:function(){return this._onError},set:function(e){this._onError=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onComplete",{get:function(){return this._onComplete},set:function(e){this._onComplete=e},enumerable:!1,configurable:!0}),e.prototype.open=function(e,t){throw new a.c("Unimplemented abstract function!")},e.prototype.abort=function(){throw new a.c("Unimplemented abstract function!")},e}()},function(e,t,i){"use strict";i.d(t,"d",(function(){return r})),i.d(t,"a",(function(){return o})),i.d(t,"b",(function(){return s})),i.d(t,"c",(function(){return _}));var a,n=(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=function(){function e(e){this._message=e}return Object.defineProperty(e.prototype,"name",{get:function(){return"RuntimeException"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return this.name+": "+this.message},e}(),o=function(e){function t(t){return e.call(this,t)||this}return n(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"IllegalStateException"},enumerable:!1,configurable:!0}),t}(r),s=function(e){function t(t){return e.call(this,t)||this}return n(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"InvalidArgumentException"},enumerable:!1,configurable:!0}),t}(r),_=function(e){function t(t){return e.call(this,t)||this}return n(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"NotImplementedException"},enumerable:!1,configurable:!0}),t}(r)},function(e,t,i){"use strict";var a;!function(e){e.ERROR="error",e.LOADING_COMPLETE="loading_complete",e.RECOVERED_EARLY_EOF="recovered_early_eof",e.MEDIA_INFO="media_info",e.METADATA_ARRIVED="metadata_arrived",e.SCRIPTDATA_ARRIVED="scriptdata_arrived",e.TIMED_ID3_METADATA_ARRIVED="timed_id3_metadata_arrived",e.SYNCHRONOUS_KLV_METADATA_ARRIVED="synchronous_klv_metadata_arrived",e.ASYNCHRONOUS_KLV_METADATA_ARRIVED="asynchronous_klv_metadata_arrived",e.SMPTE2038_METADATA_ARRIVED="smpte2038_metadata_arrived",e.SCTE35_METADATA_ARRIVED="scte35_metadata_arrived",e.PES_PRIVATE_DATA_DESCRIPTOR="pes_private_data_descriptor",e.PES_PRIVATE_DATA_ARRIVED="pes_private_data_arrived",e.STATISTICS_INFO="statistics_info",e.DESTROYING="destroying",e.SYSTEM_CLOCK="system_clock",e.AUDIO_TRACKS_METADATA="audio_tracks_metadata"}(a||(a={})),t.a=a},function(e,t,i){"use strict";var a={};!function(){var e=self.navigator.userAgent.toLowerCase(),t=/(edge)\/([\w.]+)/.exec(e)||/(opr)[\/]([\w.]+)/.exec(e)||/(chrome)[ \/]([\w.]+)/.exec(e)||/(iemobile)[\/]([\w.]+)/.exec(e)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(e)||[],i=/(ipad)/.exec(e)||/(ipod)/.exec(e)||/(windows phone)/.exec(e)||/(iphone)/.exec(e)||/(kindle)/.exec(e)||/(android)/.exec(e)||/(windows)/.exec(e)||/(mac)/.exec(e)||/(linux)/.exec(e)||/(cros)/.exec(e)||[],n={browser:t[5]||t[3]||t[1]||"",version:t[2]||t[4]||"0",majorVersion:t[4]||t[2]||"0",platform:i[0]||""},r={};if(n.browser){r[n.browser]=!0;var o=n.majorVersion.split(".");r.version={major:parseInt(n.majorVersion,10),string:n.version},o.length>1&&(r.version.minor=parseInt(o[1],10)),o.length>2&&(r.version.build=parseInt(o[2],10))}if(n.platform&&(r[n.platform]=!0),(r.chrome||r.opr||r.safari)&&(r.webkit=!0),r.rv||r.iemobile){r.rv&&delete r.rv;n.browser="msie",r.msie=!0}if(r.edge){delete r.edge;n.browser="msedge",r.msedge=!0}if(r.opr){n.browser="opera",r.opera=!0}if(r.safari&&r.android){n.browser="android",r.android=!0}for(var s in r.name=n.browser,r.platform=n.platform,a)a.hasOwnProperty(s)&&delete a[s];Object.assign(a,r)}(),t.a=a},function(e,t,i){"use strict";t.a={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"}},function(e,t,i){"use strict";var a;!function(e){e.ERROR="error",e.SOURCE_OPEN="source_open",e.UPDATE_END="update_end",e.BUFFER_FULL="buffer_full",e.START_STREAMING="start_streaming",e.END_STREAMING="end_streaming"}(a||(a={})),t.a=a},function(e,t,i){"use strict";var a=i(9),n=i.n(a),r=i(0),o=function(){function e(){}return Object.defineProperty(e,"forceGlobalTag",{get:function(){return r.a.FORCE_GLOBAL_TAG},set:function(t){r.a.FORCE_GLOBAL_TAG=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"globalTag",{get:function(){return r.a.GLOBAL_TAG},set:function(t){r.a.GLOBAL_TAG=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableAll",{get:function(){return r.a.ENABLE_VERBOSE&&r.a.ENABLE_DEBUG&&r.a.ENABLE_INFO&&r.a.ENABLE_WARN&&r.a.ENABLE_ERROR},set:function(t){r.a.ENABLE_VERBOSE=t,r.a.ENABLE_DEBUG=t,r.a.ENABLE_INFO=t,r.a.ENABLE_WARN=t,r.a.ENABLE_ERROR=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableDebug",{get:function(){return r.a.ENABLE_DEBUG},set:function(t){r.a.ENABLE_DEBUG=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableVerbose",{get:function(){return r.a.ENABLE_VERBOSE},set:function(t){r.a.ENABLE_VERBOSE=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableInfo",{get:function(){return r.a.ENABLE_INFO},set:function(t){r.a.ENABLE_INFO=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableWarn",{get:function(){return r.a.ENABLE_WARN},set:function(t){r.a.ENABLE_WARN=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableError",{get:function(){return r.a.ENABLE_ERROR},set:function(t){r.a.ENABLE_ERROR=t,e._notifyChange()},enumerable:!1,configurable:!0}),e.getConfig=function(){return{globalTag:r.a.GLOBAL_TAG,forceGlobalTag:r.a.FORCE_GLOBAL_TAG,enableVerbose:r.a.ENABLE_VERBOSE,enableDebug:r.a.ENABLE_DEBUG,enableInfo:r.a.ENABLE_INFO,enableWarn:r.a.ENABLE_WARN,enableError:r.a.ENABLE_ERROR,enableCallback:r.a.ENABLE_CALLBACK}},e.applyConfig=function(e){r.a.GLOBAL_TAG=e.globalTag,r.a.FORCE_GLOBAL_TAG=e.forceGlobalTag,r.a.ENABLE_VERBOSE=e.enableVerbose,r.a.ENABLE_DEBUG=e.enableDebug,r.a.ENABLE_INFO=e.enableInfo,r.a.ENABLE_WARN=e.enableWarn,r.a.ENABLE_ERROR=e.enableError,r.a.ENABLE_CALLBACK=e.enableCallback},e._notifyChange=function(){var t=e.emitter;if(t.listenerCount("change")>0){var i=e.getConfig();t.emit("change",i)}},e.registerListener=function(t){e.emitter.addListener("change",t)},e.removeListener=function(t){e.emitter.removeListener("change",t)},e.addLogListener=function(t){r.a.emitter.addListener("log",t),r.a.emitter.listenerCount("log")>0&&(r.a.ENABLE_CALLBACK=!0,e._notifyChange())},e.removeLogListener=function(t){r.a.emitter.removeListener("log",t),0===r.a.emitter.listenerCount("log")&&(r.a.ENABLE_CALLBACK=!1,e._notifyChange())},e}();o.emitter=new n.a,t.a=o},function(e,t,i){"use strict";var a,n="object"==typeof Reflect?Reflect:null,r=n&&"function"==typeof n.apply?n.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)};a=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise((function(i,a){function n(i){e.removeListener(t,r),a(i)}function r(){"function"==typeof e.removeListener&&e.removeListener("error",n),i([].slice.call(arguments))}g(e,t,r,{once:!0}),"error"!==t&&function(e,t,i){"function"==typeof e.on&&g(e,"error",t,i)}(e,n,{once:!0})}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var _=10;function d(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function u(e,t,i,a){var n,r,o,s;if(d(i),void 0===(r=e._events)?(r=e._events=Object.create(null),e._eventsCount=0):(void 0!==r.newListener&&(e.emit("newListener",t,i.listener?i.listener:i),r=e._events),o=r[t]),void 0===o)o=r[t]=i,++e._eventsCount;else if("function"==typeof o?o=r[t]=a?[i,o]:[o,i]:a?o.unshift(i):o.push(i),(n=c(e))>0&&o.length>n&&!o.warned){o.warned=!0;var _=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");_.name="MaxListenersExceededWarning",_.emitter=e,_.type=t,_.count=o.length,s=_,console&&console.warn&&console.warn(s)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,i){var a={fired:!1,wrapFn:void 0,target:e,type:t,listener:i},n=l.bind(a);return n.listener=i,a.wrapFn=n,n}function f(e,t,i){var a=e._events;if(void 0===a)return[];var n=a[t];return void 0===n?[]:"function"==typeof n?i?[n.listener||n]:[n]:i?function(e){for(var t=new Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}(n):m(n,n.length)}function p(e){var t=this._events;if(void 0!==t){var i=t[e];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function m(e,t){for(var i=new Array(t),a=0;a<t;++a)i[a]=e[a];return i}function g(e,t,i,a){if("function"==typeof e.on)a.once?e.once(t,i):e.on(t,i);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function n(r){a.once&&e.removeEventListener(t,n),i(r)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return _},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");_=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return c(this)},s.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var a="error"===e,n=this._events;if(void 0!==n)a=a&&void 0===n.error;else if(!a)return!1;if(a){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var _=n[e];if(void 0===_)return!1;if("function"==typeof _)r(_,this,t);else{var d=_.length,c=m(_,d);for(i=0;i<d;++i)r(c[i],this,t)}return!0},s.prototype.addListener=function(e,t){return u(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return u(this,e,t,!0)},s.prototype.once=function(e,t){return d(t),this.on(e,h(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return d(t),this.prependListener(e,h(this,e,t)),this},s.prototype.removeListener=function(e,t){var i,a,n,r,o;if(d(t),void 0===(a=this._events))return this;if(void 0===(i=a[e]))return this;if(i===t||i.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete a[e],a.removeListener&&this.emit("removeListener",e,i.listener||t));else if("function"!=typeof i){for(n=-1,r=i.length-1;r>=0;r--)if(i[r]===t||i[r].listener===t){o=i[r].listener,n=r;break}if(n<0)return this;0===n?i.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(i,n),1===i.length&&(a[e]=i[0]),void 0!==a.removeListener&&this.emit("removeListener",e,o||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,i,a;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[e]),this;if(0===arguments.length){var n,r=Object.keys(i);for(a=0;a<r.length;++a)"removeListener"!==(n=r[a])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=i[e]))this.removeListener(e,t);else if(void 0!==t)for(a=t.length-1;a>=0;a--)this.removeListener(e,t[a]);return this},s.prototype.listeners=function(e){return f(this,e,!0)},s.prototype.rawListeners=function(e){return f(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},s.prototype.listenerCount=p,s.prototype.eventNames=function(){return this._eventsCount>0?a(this._events):[]}},function(e,t,i){"use strict";var a=function(){function e(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return e.prototype.isComplete=function(){var e=!1===this.hasAudio||!0===this.hasAudio&&null!=this.audioCodec&&null!=this.audioSampleRate&&null!=this.audioChannelCount,t=!1===this.hasVideo||!0===this.hasVideo&&null!=this.videoCodec&&null!=this.width&&null!=this.height&&null!=this.fps&&null!=this.profile&&null!=this.level&&null!=this.refFrames&&null!=this.chromaFormat&&null!=this.sarNum&&null!=this.sarDen;return null!=this.mimeType&&e&&t},e.prototype.isSeekable=function(){return!0===this.hasKeyframesIndex},e.prototype.getNearestKeyframe=function(e){if(null==this.keyframesIndex)return null;var t=this.keyframesIndex,i=this._search(t.times,e);return{index:i,milliseconds:t.times[i],fileposition:t.filepositions[i]}},e.prototype._search=function(e,t){var i=0,a=e.length-1,n=0,r=0,o=a;for(t<e[0]&&(i=0,r=o+1);r<=o;){if((n=r+Math.floor((o-r)/2))===a||t>=e[n]&&t<e[n+1]){i=n;break}e[n]<t?r=n+1:o=n-1}return i},e}();t.a=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MMTPReader=t.MMT_PID_CDT=t.MMT_PID_TOT=t.MMT_PID_SDT=t.MMT_PID_SDTT=t.MMT_PID_BIT=t.MMT_PID_EIT=t.MMT_PID_CAT=t.MMT_PID_PLT=t.MMTP_FRAGMENTATION_INDICATOR_TAIL=t.MMTP_FRAGMENTATION_INDICATOR_MIDDLE=t.MMTP_FRAGMENTATION_INDICATOR_HEAD=t.MMTP_FRAGMENTATION_INDICATOR_COMPLETE=void 0;var a=i(16),n=i(36),r=i(15);t.MMTP_FRAGMENTATION_INDICATOR_COMPLETE=0,t.MMTP_FRAGMENTATION_INDICATOR_HEAD=1,t.MMTP_FRAGMENTATION_INDICATOR_MIDDLE=2,t.MMTP_FRAGMENTATION_INDICATOR_TAIL=3,t.MMT_PID_PLT=0,t.MMT_PID_CAT=1,t.MMT_PID_EIT=32768,t.MMT_PID_BIT=32770,t.MMT_PID_SDTT=32771,t.MMT_PID_SDT=32772,t.MMT_PID_TOT=32773,t.MMT_PID_CDT=32774;var o=function(){function e(e){this.eventTarget=e,this.siPacketQueue=new Map}return e.prototype.reset=function(){this.siPacketQueue.clear()},e.prototype.onSI=function(e,i){var n,o,s=(0,a.readMessages)((0,r.concatBuffers)(i));if(null!=s)switch(s.messageId){case"PA":if(e===t.MMT_PID_PLT&&"PLT"===(null===(n=s.tables[0])||void 0===n?void 0:n.tableId)){var _=s.tables[0];this.eventTarget.dispatchEvent("plt",{packetId:e,table:_})}else"MPT"===(null===(o=s.tables[0])||void 0===o?void 0:o.tableId)&&this.eventTarget.dispatchEvent("mpt",{packetId:e,table:s.tables[0]});break;case"M2section":switch(e){case t.MMT_PID_SDT:"SDT[actual]"!==s.table.tableId&&"SDT[other]"!==s.table.tableId||this.eventTarget.dispatchEvent("sdt",{packetId:e,table:s.table});break;case t.MMT_PID_CDT:"CDT"===s.table.tableId&&this.eventTarget.dispatchEvent("cdt",{packetId:e,table:s.table});break;case t.MMT_PID_BIT:"BIT"===s.table.tableId&&this.eventTarget.dispatchEvent("bit",{packetId:e,table:s.table});break;case t.MMT_PID_EIT:"EIT[p/f]"!==s.table.tableId&&"EIT[schedule basic]"!==s.table.tableId&&"EIT[schedule extended]"!==s.table.tableId||this.eventTarget.dispatchEvent("eit",{packetId:e,table:s.table})}break;case"M2shortSection":e===t.MMT_PID_TOT&&this.eventTarget.dispatchEvent("tot",{packetId:e,table:s.table})}},e.prototype.push=function(e,i){var a=new r.BinaryReader(e,i);if(a.canRead(12)){var o=a.readUint8(),s=o>>6,_=!!(o>>5&1),d=o>>4&3,c=!!(o>>1&1),u=!!(1&o),l=63&a.readUint8(),h=a.readUint16(),f=a.readUint32(),p=a.readUint32();if(!_||a.canRead(4)){var m=_?a.readUint32():void 0;if(c){if(!a.canRead(4))return;var g=a.readUint16(),v=a.readUint16();if(!a.canRead(v))return;for(var E=a.subarray(v),y=0;0==g&&y+4<=E.length;){var T=E[y]<<8|E[y+1];if(!!(T>>15))break;var S=32767&T,A=E[y+2]<<8|E[y+3];if((y+=4)+A>E.length)break;switch(S){case 1:if(A<1)break;if(0!==(E[y]>>3&3))return}y+=A}}if(0===l){if(0===this.eventTarget.getListenerCount("mpu"))return;if(!a.canRead(2))return;var R=a.readUint16();if(!a.canRead(R))return;var b=(0,n.readMPU)(a.subarray(R));if(null!=b){var I={version:s,fecType:d,extensionFlag:c,rapFlag:u,payloadType:l,packetId:h,timestamp:f,packetSequenceNumber:p,packetCounter:m};this.eventTarget.dispatchEvent("mpu",{mmtHeader:I,mpu:b})}}else if(2===l){if(!a.canRead(2))return;if(h===t.MMT_PID_SDT&&0===this.eventTarget.getListenerCount("sdt"))return;if(h===t.MMT_PID_CDT&&0===this.eventTarget.getListenerCount("cdt"))return;if(h===t.MMT_PID_BIT&&0===this.eventTarget.getListenerCount("bit"))return;if(h===t.MMT_PID_EIT&&0===this.eventTarget.getListenerCount("eit"))return;if(h===t.MMT_PID_TOT&&0===this.eventTarget.getListenerCount("tot"))return;var M=a.readUint8(),O=M>>6,C=!!(1&M);a.readUint8();if(!C){var D=e.slice(a.tell());if(O===t.MMTP_FRAGMENTATION_INDICATOR_COMPLETE)this.onSI(h,[D]),this.siPacketQueue.delete(h);else if(O===t.MMTP_FRAGMENTATION_INDICATOR_HEAD)this.siPacketQueue.set(h,[D]);else{var L=this.siPacketQueue.get(h);null!=L&&(L.push(D),O===t.MMTP_FRAGMENTATION_INDICATOR_TAIL&&this.onSI(h,L))}}}}}},e}();t.MMTPReader=o},function(e,t,i){"use strict";i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return o}));var a=i(2),n=i(6),r={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},o={NETWORK_EXCEPTION:a.b.EXCEPTION,NETWORK_STATUS_CODE_INVALID:a.b.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:a.b.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:a.b.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:n.a.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:n.a.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:n.a.CODEC_UNSUPPORTED}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MH_LOGO_TRANSMISSION_TYPE_INDIRECT=t.MH_LOGO_TRANSMISSION_TYPE_DIRECT=t.EVENT_GROUP_TYPE_MOVEMENT_FROM_OTHER_NETWORK=t.EVENT_GROUP_TYPE_RELAY_TO_OTHER_NETWORK=t.EVENT_GROUP_TYPE_MOVEMENT=t.EVENT_GROUP_TYPE_RELAY=t.EVENT_GROUP_TYPE_SHARING=t.DATA_COMPONENT_ID_MULTIMEDIA_2G=t.DATA_COMPONENT_ID_SUBTITLE_2G=t.MH_AUDIO_COMPONENT_TYPE_22POINT2=t.MH_AUDIO_COMPONENT_TYPE_7POINT1=t.MH_AUDIO_COMPONENT_TYPE_5POINT1=t.MH_AUDIO_COMPONENT_TYPE_STEREO=t.MH_AUDIO_COMPONENT_TYPE_MASK_SOUND_MODE=t.MH_AUDIO_COMPONENT_TYPE_FOR_HEARING_IMPAIRED=t.MH_AUDIO_COMPONENT_TYPE_COMMENTARY_FOR_VISUALLY_IMPAIRED=t.MH_AUDIO_COMPONENT_TYPE_NOT_SPECIFIED=t.MH_AUDIO_COMPONENT_TYPE_MASK_HANDICAPPED=t.MH_AUDIO_COMPONENT_TYPE_DIALOG_CONTROL_NONE=t.MH_AUDIO_COMPONENT_TYPE_MASK_DIALOGUE_CONTROL=t.MH_AUDIO_COMPONENT_STREAM_CONTENT_MPEG4_ALS=t.MH_AUDIO_COMPONENT_STREAM_CONTENT_MPEG4_AAC=t.TRANSFER_CHARACTERISTICS_BT2100_HLG=t.TRANSFER_CHARACTERISTICS_BT2020=t.TRANSFER_CHARACTERISTICS_IEC_61966_2_4=t.TRANSFER_CHARACTERISTICS_BT709=t.FRAME_RATE_119_88=t.FRAME_RATE_59_94=t.FRAME_RATE_29_97=t.ASPECT_RATIO_16_9=t.VIDEO_RESOLUTION_4320=t.VIDEO_RESOLUTION_2160=t.VIDEO_RESOLUTION_1080=t.DOCUMENT_RESOLUTION_7680_4320=t.DOCUMENT_RESOLUTION_3840_2160=t.DOCUMENT_RESOLUTION_1920_1080=t.STREAM_TYPE_LATM_LOAS=t.QUALITY_INDICATOR_MODE3=t.QUALITY_INDICATOR_MODE2=t.QUALITY_INDICATOR_MODE1=t.SAMPLING_RATE_48000=void 0,t.readMMTSIDescriptors=function(e){var t=new r.BinaryReader(e),i=[];for(;t.canRead(3);){var a=t.readUint16(),o=void 0;switch(a){case 61441:var U=t.readUint16();if(!t.canRead(U))return i;var B=t.subarray(U);o=A(B);break;case 61442:U=t.readUint16();if(!t.canRead(U))return i;B=t.subarray(U);o=R(B);break;default:U=t.readUint8();if(!t.canRead(U))return i;B=t.subarray(U);switch(a){case 32772:o=s(B);break;case 32824:o=_(B);break;case 32775:o=(0,n.readEmergencyInformationDescriptor)(B);break;case 32832:o=d(B);break;case 32825:o=c(B);break;case 32787:o=u(B);break;case 32820:o=l(B);break;case 32768:o=h(B);break;case 1:o=f(B);break;case 32823:o=p(B);break;case 32784:o=m(B);break;case 32785:o=g(B);break;case 32788:o=v(B);break;case 32789:o=E(B);break;case 32800:o=y(B);break;case 32806:o=T(B);break;case 32780:o=S(B);break;case 32786:o=b(B);break;case 32790:o=I(B);break;case 32831:o=M(B);break;case 32793:o=O(B);break;case 32833:o=C(B);break;case 32805:o=D(B);break;case 32791:o=L(B);break;case 32792:o=P(B);break;case 32781:o=k(B);break;case 32830:o=N(B);break;case 32803:o=w(B)}}null!=o&&i.push(o)}return i};var a=i(27),n=i(24),r=i(15),o=i(35);Object.defineProperty(t,"SAMPLING_RATE_48000",{enumerable:!0,get:function(){return o.SAMPLING_RATE_48000}}),Object.defineProperty(t,"QUALITY_INDICATOR_MODE1",{enumerable:!0,get:function(){return o.QUALITY_INDICATOR_MODE1}}),Object.defineProperty(t,"QUALITY_INDICATOR_MODE2",{enumerable:!0,get:function(){return o.QUALITY_INDICATOR_MODE2}}),Object.defineProperty(t,"QUALITY_INDICATOR_MODE3",{enumerable:!0,get:function(){return o.QUALITY_INDICATOR_MODE3}}),Object.defineProperty(t,"STREAM_TYPE_LATM_LOAS",{enumerable:!0,get:function(){return o.STREAM_TYPE_LATM_LOAS}});function s(e){var t=new r.BinaryReader(e);if(t.canRead(2)){var i=t.readUint16(),n=(0,a.readMMTGeneralLocationInfo)(t);if(null!=n)return{tag:"accessControl",caSystemId:i,locationInfo:n,privateData:e.slice(t.tell())}}}function _(e){var t=new r.BinaryReader(e);if(t.canRead(1)){var i=t.readUint8(),a=i>>6,n=32&i,o=16&i;if(!n||t.canRead(1)){var s=n?t.readUint8():void 0,_=o?[]:void 0;if(null!=_){if(!t.canRead(1))return;var d=t.readUint8();if(!t.canRead(d))return;for(var c=new r.BinaryReader(t.subarray(d));c.canRead(4);){var u=t.readUint16(),l=t.readUint8();t.skip(1);var h=l>>6,f=32&l;if(f&&!t.canRead(1))break;var p=f?t.readUint8():void 0;_.push({componentTag:u,digitalRecordingControlData:h,maximumBitRate:p})}}return{tag:"contentCopyControl",digitalRecordingControlData:a,maximumBitRate:s,componentControls:_}}}}function d(e){var t=new r.BinaryReader(e);if(t.canRead(9)){var i=t.readNTP64Timestamp();return t.skip(1),{tag:"emergencyNews",transmitTimestamp:i}}}function c(e){if(!(e.length<2))return{tag:"contentUsageControl",remoteViewMode:!!(128&e[0]),copyRestrictionMode:!!(64&e[0]),imageConstraintToken:!!(32&e[0]),retentionMode:!!(16&e[1]),retentionState:(14&e[1])>>1,encryptionMode:!!(1&e[1])}}function u(e){for(var t=new r.BinaryReader(e),i=[];t.canRead(4);){var a=t.readUint24(),n=t.readUint8();i.push({countryCode:a,rating:n})}return{tag:"mhParentalRating",ratings:i}}function l(e){var t=new r.BinaryReader(e);if(t.canRead(3)){var i=t.readUint8()>>4,n=t.readUint8()>>4,o=t.readUint8(),s=!!(128&o),_=!!(64&o),d=15&o,c=(0,a.readMMTGeneralLocationInfo)(t);if(null!=c){var u=_?(0,a.readMMTGeneralLocationInfo)(t):void 0;if(!_||null!=u){for(var l=[],h=0;h<d&&t.canRead(1);h++){var f=t.readUint8(),p=(0,a.readMMTGeneralLocationInfo)(t);if(null==p)return;l.push({emtTag:f,emtLocationInfo:p})}return{tag:"applicationService",applicationFormat:i,documentResolution:n,defaultAITFlag:s,aitLocationInfo:c,dtMessageLocationInfo:u,emtList:l,privateData:e.slice(t.tell())}}}}}function h(e){if(!(e.length<2))return{tag:"assetGroup",groupIdentification:e[0],selectionLevel:e[1]}}function f(e){for(var t=new r.BinaryReader(e),i=[];t.canRead(12);){var a=t.readUint32(),n=t.readNTP64Timestamp();i.push({mpuSequenceNumber:a,mpuPresentationTime:n})}return{tag:"mpuTimestamp",timestamps:i}}function p(e){if(!(e.length<4))return{tag:"mhHierarchy",temporalScalabilityFlag:!!(64&e[0]),spatialScalabilityFlag:!!(32&e[0]),qualityScalabilityFlag:!!(16&e[0]),hierarchyType:15&e[0],hierarchyLayerIndex:63&e[1],trefPresentFlag:!!(128&e[2]),hierarchyEmbeddedLayerIndex:63&e[2],hierarchyChannel:63&e[3]}}function m(e){var t=new r.BinaryReader(e);if(t.canRead(8)){var i=t.readUint8(),a=i>>4,n=15&i,o=t.readUint8();return{tag:"videoComponent",videoResolution:a,videoAspectRatio:n,videoScanFlag:!!(128&o),videoFrameRate:31&o,componentTag:t.readUint16(),videoTransferCharacteristics:t.readUint8()>>4,iso639LanguageCode:t.readUint24(),text:e.slice(t.tell())}}}function g(e){var t=new r.BinaryReader(e);if(t.canRead(2))return{tag:"streamIdentifier",componentTag:t.readUint16()}}function v(e){var t=new r.BinaryReader(e);if(t.canRead(10)){var i=15&t.readUint8(),a=t.readUint8(),n=t.readUint16(),o=t.readUint8(),s=t.readUint8(),_=t.readUint8(),d=!!(128&_),c=!!(64&_),u=_>>4&3,l=_>>1&7,h=t.readUint24();if(!d||t.canRead(3))return{tag:"mhAudioComponent",streamContent:i,componentType:a,componentTag:n,streamType:o,simulcastGroupTag:s,mainComponentFlag:c,qualityIndicator:u,samplingRate:l,iso639LanguageCode:h,esMultiLingualISO639LanguageCode:d?t.readUint24():void 0,text:t.slice()}}}function E(e){var t=function(e){if(e.canRead(1)&&1===e.readUint8()&&e.canRead(7))return{regionSpecType:"BSDigital",prefectureBitmap:e.slice(7)}}(new r.BinaryReader(e));if(null!=t)return{tag:"targetRegion",targetRegion:t}}function y(e){if(!(e.length<2)){var i=e[0]<<8|e[1],a=e.slice(2);return{tag:"dataComponent",dataComponentId:i,additionalDataComponentInfo:a,additionalAribSubtitleInfo:i===t.DATA_COMPONENT_ID_SUBTITLE_2G?function(e){var t=new r.BinaryReader(e);if(!t.canRead(8))return;var i=t.readUint8(),a=t.readUint8(),n=a>>4,o=!!(8&a),s=t.readUint24(),_=t.readUint8(),d=_>>6,c=_>>2&15,u=3&_,l=t.readUint8(),h=l>>4,f=15&l,p=t.readUint8(),m=p>>4,g=15&p;if(o&&!t.canRead(4))return;var v,E=o?t.readUint32():void 0;if(2===h){if(!t.canRead(9))return;var y=t.readNTP64Timestamp(),T=t.readUint8()>>6;v={startTime:y,leapIndicator:T}}return{subtitleTag:i,subtitleInfoVersion:n,iso639LanguageCode:s,type:d,subtitleFormat:c,opm:u,tmd:h,dmf:f,resolution:m,compressionType:g,startMPUSequenceNumber:E,referenceStartTime:v}}(a):void 0}}}function T(e){var t=new r.BinaryReader(e);if(t.canRead(1)){var i=t.readUint8(),a=i>>1&3,n=!!(1&i);if(!n||t.canRead(4)){var o=n?t.readUint32():void 0;if(1!==a||t.canRead(2)){for(var s=1===a?t.readUint16():void 0,_=[];t.canRead(8);){var d=t.readUint32(),c=t.readUint8()>>6,u=t.readUint16(),l=t.readUint8(),h=[];if(2===a&&t.canRead(4*l))for(var f=0;f<l;f++){var p=t.readUint16(),m=t.readUint16();h.push({dtsPTSOffset:p,ptsOffset:m})}else{if(!t.canRead(2*l))break;for(f=0;f<l;f++){p=t.readUint16();h.push({dtsPTSOffset:p})}}_.push({mpuSequenceNumber:d,mpuPresentationTimeLeapIndicator:c,mpuDecodingTimeOffset:u,accessUnits:h})}return{tag:"mpuExtendedTimestamp",ptsOffsetType:a,timescale:o,defaultPTSOffset:s,timestamps:_}}}}}function S(e){var i=new r.BinaryReader(e);if(i.canRead(1)){var a=i.readUint8(),n=a>>4,o=15&a,s=[];if(i.canRead(4*o)){for(var _=0;_<o;_++){var d=i.readUint16(),c=i.readUint16();s.push({serviceId:d,eventId:c})}if(n===t.EVENT_GROUP_TYPE_RELAY_TO_OTHER_NETWORK||n===t.EVENT_GROUP_TYPE_MOVEMENT_FROM_OTHER_NETWORK){for(var u=[];i.canRead(8);){var l=i.readUint16(),h=i.readUint16();d=i.readUint16(),c=i.readUint16();u.push({originalNetworkId:l,tlvStreamId:h,serviceId:d,eventId:c})}return{tag:"mhEventGroup",groupType:n,events:s,otherNetworkEvents:u}}return{tag:"mhEventGroup",groupType:n,events:s,privateData:i.slice()}}}}function A(e){var t=new r.BinaryReader(e);if(t.canRead(4)){var i=t.readUint24(),a=t.readUint8();if(t.canRead(a)){var n=t.slice(a);if(t.canRead(2)){var o=t.readUint16();if(t.canRead(o))return{tag:"mhShortEvent",iso639LanguageCode:i,eventName:n,text:t.slice(o)}}}}}function R(e){var t=new r.BinaryReader(e);if(t.canRead(6)){var i=t.readUint8(),a=i>>4,n=15&i,o=t.readUint24(),s=t.readUint16();if(t.canRead(s)){for(var _=[],d=new r.BinaryReader(t.subarray(s));d.canRead(1);){var c=d.readUint8();if(!d.canRead(c))break;var u=d.slice(c);if(!d.canRead(2))break;var l=d.readUint16();if(!d.canRead(l))break;var h=d.slice(l);_.push({itemDescription:u,item:h})}if(t.canRead(2)){var f=t.readUint16();if(t.canRead(f))return{tag:"mhExtendedEvent",descriptorNumber:a,lastDescriptorNumber:n,iso639LanguageCode:o,items:_,text:t.slice(f)}}}}}function b(e){for(var t=new r.BinaryReader(e),i=[];t.canRead(2);){var a=t.readUint8(),n=t.readUint8();i.push({contentNibbleLevel1:a>>4,contentNibbleLevel2:15&a,userNibble:n})}return{tag:"mhContent",items:i}}function I(e){var t=new r.BinaryReader(e);if(t.canRead(8)){var i=t.readUint16(),a=t.readUint8(),n=a>>4,o=a>>1&7,s=!!(1&a),_=t.readUint16(),d=t.readUint24();return{tag:"mhSeries",seriesId:i,repeatLabel:n,programPattern:o,expireDateValidFlag:s,expireDate:_,episodeNumber:d>>12,lastEpisodeNumber:4095&d,seriesName:t.slice()}}}function M(e){var t=new r.BinaryReader(e);if(t.canRead(2)){var i,a,n=t.readUint16();if(32===n){if(!t.canRead(6))return;var o=t.readUint16(),s=t.readUint24(),_=t.readUint8();if(!t.canRead(_))return;i={componentTag:o,iso639LanguageCode:s,text:t.slice(_)}}if(33===n){if(!t.canRead(1))return;a={associatedContentsFlag:!!(t.readUint8()>>7)}}if(t.canRead(1)){var d=t.readUint8();if(t.canRead(d))return{tag:"multimediaServiceInfo",dataComponentId:n,subtitleServiceInfo:i,dataServiceInfo:a,selector:t.slice(d)}}}}function O(e){var t=new r.BinaryReader(e);if(t.canRead(2)){var i=t.readUint8(),a=t.readUint8();if(t.canRead(a)){var n=t.slice(a);if(t.canRead(1)){var o=t.readUint8();if(t.canRead(o))return{tag:"mhServiceDescriptor",serviceType:i,serviceProviderName:n,serviceName:t.slice(o)}}}}}function C(e){var t=new r.BinaryReader(e);if(t.canRead(3)){var i=t.readUint16(),a=t.readUint8(),n=a>>4,o=15&a;if(t.canRead(2*o)){for(var s=[],_=0;_<o;_++)s.push(t.readUint16());if(t.canRead(1)){var d=t.readUint8();if(t.canRead(d)){var c=t.slice(d);if(t.canRead(1)){var u=t.readUint8();if(t.canRead(u))return{tag:"mhCAContractInfoDescriptor",caSystemId:i,caUnitId:n,components:s,contractVerificationInfo:c,feeName:t.slice(u)}}}}}}}function D(e){var i=new r.BinaryReader(e);if(i.canRead(1)){var a=i.readUint8();if(a===t.MH_LOGO_TRANSMISSION_TYPE_DIRECT){if(!i.canRead(6))return;for(var n=511&i.readUint16(),o=4095&i.readUint16(),s=i.readUint16(),_=[];i.canRead(3);){var d=i.readUint8(),c=i.readUint8(),u=i.readUint8();_.push({logoType:d,startSectionNumber:c,numOfSections:u})}return{tag:"mhLogoTransmission",logoTransmissionType:a,logoId:n,logoVersion:o,downloadDataId:s,logoList:_}}if(a===t.MH_LOGO_TRANSMISSION_TYPE_INDIRECT){if(!i.canRead(2))return;return{tag:"mhLogoTransmission",logoTransmissionType:a,logoId:n=511&i.readUint16()}}}}function L(e){var t=new r.BinaryReader(e);if(t.canRead(3)){for(var i=t.readUint8(),a=t.readUint16(),n=[];t.canRead(2);){var o=t.readUint8(),s=t.readUint8(),_=t.slice(s);n.push({tableId:o,tableDescription:_})}return{tag:"mhSIParameterDescriptor",parameterVersion:i,updateTime:a,tableParameters:n}}}function P(e){return{tag:"mhBroadcasterName",name:new r.BinaryReader(e).slice()}}function k(e){for(var t=new r.BinaryReader(e),i=[];t.canRead(3);){var a=t.readUint16(),n=t.readUint8();i.push({serviceId:a,serviceType:n})}return{tag:"mhServiceList",services:i}}function N(e){var t=new r.BinaryReader(e),i=t.readUint8(),a=i>>4,n=15&i,o=t.readUint8()>>4;if(t.canRead(3*a+1*n+2*o)){for(var s=[],_=0;_<a;_++){var d=t.readUint16(),c=t.readUint8();s.push({networkId:d,broadcasterId:c})}var u=[];for(_=0;_<n;_++){var l=t.readUint8();u.push(l)}var h=[];for(_=0;_<o;_++){var f=t.readUint16();h.push(f)}return{tag:"siRelatedBroadcaster",broadcasterIdList:s,affiliationIdList:u,originalNetworkIdList:h}}}function w(e){for(var t=new r.BinaryReader(e),i=[];t.canRead(13);){var a=t.readUint24(),n=t.readUint8(),o=n>>2,s=!!(1&n),_=t.readUint16(),d=t.readUint40(),c=t.readUint16();i.push({countryCode:a,countryRegionId:o,localTimeOffsetPolarity:s,localTimeOffset:_,timeOfChange:d,nextTimeOffset:c})}return{tag:"mhLocalTimeOffset",offsets:i}}t.DOCUMENT_RESOLUTION_1920_1080=0,t.DOCUMENT_RESOLUTION_3840_2160=1,t.DOCUMENT_RESOLUTION_7680_4320=2,t.VIDEO_RESOLUTION_1080=5,t.VIDEO_RESOLUTION_2160=6,t.VIDEO_RESOLUTION_4320=7,t.ASPECT_RATIO_16_9=3,t.FRAME_RATE_29_97=5,t.FRAME_RATE_59_94=8,t.FRAME_RATE_119_88=11,t.TRANSFER_CHARACTERISTICS_BT709=1,t.TRANSFER_CHARACTERISTICS_IEC_61966_2_4=2,t.TRANSFER_CHARACTERISTICS_BT2020=3,t.TRANSFER_CHARACTERISTICS_BT2100_HLG=5,t.MH_AUDIO_COMPONENT_STREAM_CONTENT_MPEG4_AAC=3,t.MH_AUDIO_COMPONENT_STREAM_CONTENT_MPEG4_ALS=4,t.MH_AUDIO_COMPONENT_TYPE_MASK_DIALOGUE_CONTROL=128,t.MH_AUDIO_COMPONENT_TYPE_DIALOG_CONTROL_NONE=0,t.MH_AUDIO_COMPONENT_TYPE_MASK_HANDICAPPED=96,t.MH_AUDIO_COMPONENT_TYPE_NOT_SPECIFIED=0,t.MH_AUDIO_COMPONENT_TYPE_COMMENTARY_FOR_VISUALLY_IMPAIRED=32,t.MH_AUDIO_COMPONENT_TYPE_FOR_HEARING_IMPAIRED=64,t.MH_AUDIO_COMPONENT_TYPE_MASK_SOUND_MODE=31,t.MH_AUDIO_COMPONENT_TYPE_STEREO=3,t.MH_AUDIO_COMPONENT_TYPE_5POINT1=9,t.MH_AUDIO_COMPONENT_TYPE_7POINT1=14,t.MH_AUDIO_COMPONENT_TYPE_22POINT2=17,t.DATA_COMPONENT_ID_SUBTITLE_2G=32,t.DATA_COMPONENT_ID_MULTIMEDIA_2G=33,t.EVENT_GROUP_TYPE_SHARING=1,t.EVENT_GROUP_TYPE_RELAY=2,t.EVENT_GROUP_TYPE_MOVEMENT=3,t.EVENT_GROUP_TYPE_RELAY_TO_OTHER_NETWORK=4,t.EVENT_GROUP_TYPE_MOVEMENT_FROM_OTHER_NETWORK=5,t.MH_LOGO_TRANSMISSION_TYPE_DIRECT=1,t.MH_LOGO_TRANSMISSION_TYPE_INDIRECT=2},function(e,t,i){"use strict";i.d(t,"d",(function(){return a})),i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return r})),i.d(t,"c",(function(){return o}));var a=function(e,t,i,a,n){this.dts=e,this.pts=t,this.duration=i,this.originalDts=a,this.isSyncPoint=n,this.fileposition=null},n=function(){function e(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return e.prototype.appendSyncPoint=function(e){e.isSyncPoint=!0,this.syncPoints.push(e)},e}(),r=function(){function e(){this._list=[]}return e.prototype.clear=function(){this._list=[]},e.prototype.appendArray=function(e){var t=this._list;0!==e.length&&(t.length>0&&e[0].originalDts<t[t.length-1].originalDts&&this.clear(),Array.prototype.push.apply(t,e))},e.prototype.getLastSyncPointBeforeDts=function(e){if(0==this._list.length)return null;var t=this._list,i=0,a=t.length-1,n=0,r=0,o=a;for(e<t[0].dts&&(i=0,r=o+1);r<=o;){if((n=r+Math.floor((o-r)/2))===a||e>=t[n].dts&&e<t[n+1].dts){i=n;break}t[n].dts<e?r=n+1:o=n-1}return this._list[i]},e}(),o=function(){function e(e){this._type=e,this._list=[],this._lastAppendLocation=-1}return Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),e.prototype.isEmpty=function(){return 0===this._list.length},e.prototype.clear=function(){this._list=[],this._lastAppendLocation=-1},e.prototype._searchNearestSegmentBefore=function(e){var t=this._list;if(0===t.length)return-2;var i=t.length-1,a=0,n=0,r=i,o=0;if(e<t[0].originalBeginDts)return o=-1;for(;n<=r;){if((a=n+Math.floor((r-n)/2))===i||e>t[a].lastSample.originalDts&&e<t[a+1].originalBeginDts){o=a;break}t[a].originalBeginDts<e?n=a+1:r=a-1}return o},e.prototype._searchNearestSegmentAfter=function(e){return this._searchNearestSegmentBefore(e)+1},e.prototype.append=function(e){var t=this._list,i=e,a=this._lastAppendLocation,n=0;-1!==a&&a<t.length&&i.originalBeginDts>=t[a].lastSample.originalDts&&(a===t.length-1||a<t.length-1&&i.originalBeginDts<t[a+1].originalBeginDts)?n=a+1:t.length>0&&(n=this._searchNearestSegmentBefore(i.originalBeginDts)+1),this._lastAppendLocation=n,this._list.splice(n,0,i)},e.prototype.getLastSegmentBefore=function(e){var t=this._searchNearestSegmentBefore(e);return t>=0?this._list[t]:null},e.prototype.getLastSampleBefore=function(e){var t=this.getLastSegmentBefore(e);return null!=t?t.lastSample:null},e.prototype.getLastSyncPointBefore=function(e){for(var t=this._searchNearestSegmentBefore(e),i=this._list[t].syncPoints;0===i.length&&t>0;)t--,i=this._list[t].syncPoints;return i.length>0?i[i.length-1]:null},e}()},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BinaryReader=void 0,t.concatBuffers=function(e){if(1===e.length)return e[0];for(var t=e.reduce((function(e,t){return e+t.length}),0),i=new Uint8Array(t),a=0,n=0,r=e;n<r.length;n++){var o=r[n];i.set(o,a),a+=o.length}return i},t.fourCC=function(e){var t=255&e.charCodeAt(0),i=255&e.charCodeAt(1),a=255&e.charCodeAt(2),n=255&e.charCodeAt(3);return t<<24|i<<16|a<<8|n},t.threeCC=function(e){var t=255&e.charCodeAt(0),i=255&e.charCodeAt(1),a=255&e.charCodeAt(2);return t<<16|i<<8|a},t.mjdToUnixEpoch=n,t.bcdTimeToSeconds=r,t.mjdBCDToUnixEpoch=function(e){return n(Math.floor(e/(1<<24)))+r(e)-32400},t.bcdToBinary=function(e){return 1e7*(e>>>28&15)+1e6*(e>>>24&15)+1e5*(e>>>20&15)+1e4*(e>>>16&15)+1e3*(e>>>12&15)+100*(e>>>8&15)+10*(e>>>4&15)+(15&e)},t.ipv4ToString=function(e){return"".concat(e[0],".").concat(e[1],".").concat(e[2],".").concat(e[3])},t.ipv6ToString=function(e){for(var t="",i=0,a=-1,n=0,r=0,o=0;o<16;o+=2){0===(s=e[o]<<8|e[o+1])?r+=2:(r=0,n=o),i<r&&(i=r,a=n)}for(o=0;o<16;o+=2){var s=e[o]<<8|e[o+1];i>2&&o>a&&o<=a+i?o===a+i&&(t+=":"):(t+=s.toString(16),o+2<16&&(t+=":"))}return t};var a=function(){function e(e,t){this.buffer=e,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.offset=null!=t?t:0}return e.prototype.readUint8=function(){return this.offset+=1,this.view.getUint8(this.offset-1)},e.prototype.readInt16=function(){return this.offset+=2,this.view.getInt16(this.offset-2)},e.prototype.readUint16=function(){return this.offset+=2,this.view.getUint16(this.offset-2)},e.prototype.readUint24=function(){var e=this.view.getUint16(this.offset),t=this.view.getUint8(this.offset+2);return this.offset+=3,e<<8|t},e.prototype.readUint32=function(){return this.offset+=4,this.view.getUint32(this.offset-4)},e.prototype.readUint40=function(){var e=this.view.getUint32(this.offset),t=this.view.getUint8(this.offset+4);return this.offset+=5,256*e+t},e.prototype.readNTP64Timestamp=function(){var e=this.readUint32(),t=this.readUint32();return e&1<<31?{seconds:e,fractional:t}:{seconds:e+4294967296,fractional:t}},e.prototype.slice=function(e){if(null==e){var t=this.buffer.slice(this.offset);return this.offset=this.buffer.length,t}return this.offset+=e,this.buffer.slice(this.offset-e,this.offset)},e.prototype.subarray=function(e){if(null==e){var t=this.buffer.slice(this.offset);return this.offset=this.buffer.length,t}return this.offset+=e,this.buffer.subarray(this.offset-e,this.offset)},e.prototype.skip=function(e){this.offset+=e},e.prototype.tell=function(){return this.offset},e.prototype.canRead=function(e){return this.view.byteLength>=e+this.offset},e}();function n(e){return 86400*(e-40587)}function r(e){return 3600*(10*(e>>20&15)+(e>>16&15))+60*(10*(e>>12&15)+(e>>8&15))+(10*(e>>4&15)+(15&e))}t.BinaryReader=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MH_CDT_LOGO_TYPE_2K=t.MH_CDT_LOGO_TYPE_SMALL=t.MH_CDT_LOGO_TYPE_LARGE=t.MH_CDT_DATA_TYPE_LOGO_DATA=t.MMT_ASSET_TYPE_APPLICATION=t.MMT_ASSET_TYPE_TIMED_TEXT=t.MMT_ASSET_TYPE_MP4A=t.MMT_ASSET_TYPE_HEV1=t.MMT_SI_TABLE_EMT=t.MMT_SI_TABLE_DAMT=t.MMT_SI_TABLE_DDMT=t.MMT_SI_TABLE_MH_CDT=t.MMT_SI_TABLE_MH_TOT=t.MMT_SI_TABLE_MH_SDT_OTHER=t.MMT_SI_TABLE_MH_SDT_ACTUAL=t.MMT_SI_TABLE_MH_BIT=t.MMT_SI_TABLE_MH_SDTT=t.MMT_SI_TABLE_MH_AIT=t.MMT_SI_TABLE_MH_EIT_SCHEDULE_EXTENDED_END=t.MMT_SI_TABLE_MH_EIT_SCHEDULE_EXTENDED_BEGIN=t.MMT_SI_TABLE_MH_EIT_SCHEDULE_BASIC_END=t.MMT_SI_TABLE_MH_EIT_SCHEDULE_BASIC_BEGIN=t.MMT_SI_TABLE_MH_EIT_PF=t.MMT_SI_TABLE_CAT=t.MMT_SI_TABLE_EMM_MESSAGE=t.MMT_SI_TABLE_EMM=t.MMT_SI_TABLE_ECM=t.MMT_SI_TABLE_PLT=t.MMT_SI_TABLE_MPT=void 0,t.readMessages=function(e){var i=new r.BinaryReader(e);if(!i.canRead(3))return;var a,_=i.readUint16(),d=i.readUint8();switch(_){case 0:if(!i.canRead(4))break;var c=i.readUint32();if(!i.canRead(c))break;var u=i.subarray(c);a=function(e,i){var a=new r.BinaryReader(i);if(!a.canRead(1))return;var n=a.readUint8();if(n>0){if(!a.canRead(4*n))return;a.skip(4*n)}var _=function(e){var i=new r.BinaryReader(e),a=[];for(;i.canRead(4);){var n=i.readUint8(),_=i.readUint8(),d=i.readUint16(),c=i.subarray(d),u=void 0;switch(n){case t.MMT_SI_TABLE_MPT:u=o(_,c);break;case t.MMT_SI_TABLE_PLT:u=s(_,c)}null!=u&&a.push(u)}return a}(i.subarray(a.tell()));return{messageId:"PA",version:e,tables:_}}(d,u);break;case 32768:if(!i.canRead(2))break;var l=i.readUint16();if(!i.canRead(l))break;u=i.subarray(l);a=function(e,i){var a=new r.BinaryReader(i);if(!a.canRead(3))return;var o=a.readUint8(),s=a.readUint16();if(!(32768&s))return;var _=4095&s;if(!a.canRead(_)||_<4)return;var d,c=a.subarray(_-4);o>=t.MMT_SI_TABLE_MH_EIT_PF&&o<=t.MMT_SI_TABLE_MH_EIT_SCHEDULE_EXTENDED_END&&(d=function(e,i){var a=new r.BinaryReader(i);if(!a.canRead(11))return;var o,s,_=a.readUint16(),d=a.readUint8(),c=d>>1&31,u=!!(1&d),l=a.readUint8(),h=a.readUint8(),f=a.readUint16(),p=a.readUint16(),m=a.readUint8(),g=a.readUint8(),v=[];for(;a.canRead(12);){var E=a.readUint16(),y=a.readUint40(),T=a.readUint24(),S=a.readUint16(),A=S>>13,R=!!(S>>12&1),b=4095&S;if(!a.canRead(b))break;var I=(0,n.readMMTSIDescriptors)(a.subarray(b));v.push({eventId:E,startTime:0xffffffffff===y?void 0:y,duration:16777215===T?void 0:T,runningStatus:A,freeCAMode:R,descriptors:I})}o=e===t.MMT_SI_TABLE_MH_EIT_PF?0:e<=t.MMT_SI_TABLE_MH_EIT_SCHEDULE_BASIC_END?e-t.MMT_SI_TABLE_MH_EIT_SCHEDULE_BASIC_BEGIN:e-t.MMT_SI_TABLE_MH_EIT_SCHEDULE_EXTENDED_BEGIN;s=g===t.MMT_SI_TABLE_MH_EIT_PF?0:g<=t.MMT_SI_TABLE_MH_EIT_SCHEDULE_BASIC_END?g-t.MMT_SI_TABLE_MH_EIT_SCHEDULE_BASIC_BEGIN:g-t.MMT_SI_TABLE_MH_EIT_SCHEDULE_EXTENDED_BEGIN;return{tableId:e===t.MMT_SI_TABLE_MH_EIT_PF?"EIT[p/f]":e<=t.MMT_SI_TABLE_MH_EIT_SCHEDULE_BASIC_END?"EIT[schedule basic]":"EIT[schedule extended]",tableIndex:o,tableIdNumber:e,serviceId:_,versionNumber:c,currentNextIndicator:u,sectionNumber:l,lastSectionNumber:h,tlvStreamId:f,originalNetworkId:p,segmentLastSectionNumber:m,lastTableId:g,lastTableIndex:s,events:v}}(o,c));switch(o){case t.MMT_SI_TABLE_MH_SDTT:break;case t.MMT_SI_TABLE_MH_BIT:d=function(e,t){var i=new r.BinaryReader(t);if(!i.canRead(7))return;var a=i.readUint16(),o=i.readUint8(),s=o>>1&31,_=!!(1&o),d=i.readUint8(),c=i.readUint8(),u=i.readUint16(),l=!!(u>>12&1),h=4095&u;if(!i.canRead(h))return;var f=(0,n.readMMTSIDescriptors)(i.subarray(h)),p=[];for(;i.canRead(3);){var m=i.readUint8(),g=4095&i.readUint16(),v=(0,n.readMMTSIDescriptors)(i.subarray(g));p.push({broadcasterId:m,broadcasterDescriptors:v})}return{tableId:"BIT",originalNetworkId:a,versionNumber:s,currentNextIndicator:_,sectionNumber:d,lastSectionNumber:c,broadcastViewPropriety:l,firstDescriptors:f,broadcasters:p}}(0,c);break;case t.MMT_SI_TABLE_MH_SDT_ACTUAL:case t.MMT_SI_TABLE_MH_SDT_OTHER:d=function(e,i){var a=new r.BinaryReader(i);if(!a.canRead(8))return;var o=a.readUint16(),s=a.readUint8(),_=s>>1&31,d=!!(1&s),c=a.readUint8(),u=a.readUint8(),l=a.readUint16();a.skip(1);var h=[];for(;a.canRead(5);){var f=a.readUint16(),p=a.readUint8(),m=p>>5&7,g=!!(p>>1&1),v=!!(1&p),E=a.readUint16(),y=E>>13,T=!!(E>>12&1),S=4095&E;if(!a.canRead(S))break;var A=(0,n.readMMTSIDescriptors)(a.subarray(S));h.push({serviceId:f,eitUserDefinedFlags:m,eitScheduleFlag:g,eitPresentFollowingFlag:v,runningStatus:y,freeCAMode:T,descriptors:A})}return{tableId:e===t.MMT_SI_TABLE_MH_SDT_ACTUAL?"SDT[actual]":"SDT[other]",tlvStreamId:o,versionNumber:_,currentNextIndicator:d,sectionNumber:c,lastSectionNumber:u,originalNetworkId:l,services:h}}(o,c);break;case t.MMT_SI_TABLE_MH_TOT:break;case t.MMT_SI_TABLE_MH_CDT:d=function(e,t){var i=new r.BinaryReader(t);if(!i.canRead(10))return;var a=i.readUint16(),o=i.readUint8(),s=o>>1&31,_=!!(1&o),d=i.readUint8(),c=i.readUint8(),u=i.readUint16(),l=i.readUint8(),h=4095&i.readUint16();if(!i.canRead(h))return;var f=(0,n.readMMTSIDescriptors)(i.subarray(h));if(!i.canRead(7))return;var p=i.readUint8(),m=511&i.readUint16(),g=4095&i.readUint16(),v=i.readUint16();if(!i.canRead(v))return;var E=i.slice(v);return{tableId:"CDT",downloadDataId:a,versionNumber:s,currentNextIndicator:_,sectionNumber:d,lastSectionNumber:c,originalNetworkId:u,dataType:l,descriptors:f,dataModule:{logoType:p,logoId:m,logoVersion:g,data:E}}}(0,c)}if(o==t.MMT_SI_TABLE_ECM||o==t.MMT_SI_TABLE_EMM||o==t.MMT_SI_TABLE_EMM_MESSAGE)return;if(null==d)return;return{messageId:"M2section",version:e,table:d}}(d,u);break;case 32769:if(!i.canRead(2))break;var h=i.readUint16();if(!i.canRead(h))break;u=i.subarray(h);break;case 32770:if(!i.canRead(2))break;var f=i.readUint16();if(!i.canRead(f))break;u=i.subarray(f);a=function(e,i){var a=new r.BinaryReader(i);if(!a.canRead(3))return;var o=a.readUint8(),s=a.readUint16();if(32768&s)return;var _=4095&s;if(!a.canRead(_)||_<4)return;var d,c=a.subarray(_-4);switch(o){case t.MMT_SI_TABLE_MH_TOT:d=function(e,t){var i=new r.BinaryReader(t);if(!i.canRead(7))return;var a=i.readUint40(),o=4095&i.readUint16();if(!i.canRead(o))return;var s=(0,n.readMMTSIDescriptors)(i.subarray(o));return{tableId:"TOT",jstTime:a,descriptors:s}}(0,c)}if(null==d)return;return{messageId:"M2shortSection",version:e,table:d}}(d,u);break;case 32771:if(!i.canRead(4))break;var p=i.readUint32();if(!i.canRead(p))break;u=i.subarray(p)}return a},t.mmtPackageIdToServiceId=function(e){if(2!==e.length)return;return e[0]<<8|e[1]};var a=i(27),n=i(13),r=i(15);function o(e,t){var i=new r.BinaryReader(t);if(i.canRead(2)){var o=3&i.readUint8(),s=i.readUint8();if(i.canRead(s)){var _=i.slice(s);if(i.canRead(2)){var d=i.readUint16();if(i.canRead(d)){var c=(0,n.readMMTSIDescriptors)(i.subarray(d));if(i.canRead(1)){for(var u=i.readUint8(),l=[],h=0;h<u&&i.canRead(6);h++){var f=i.readUint8(),p=i.readUint32(),m=i.readUint8();if(!i.canRead(m))break;var g=i.slice(m);if(!i.canRead(6))break;for(var v=i.readUint32(),E=!!(1&i.readUint8()),y=i.readUint8(),T=[],S=0;S<y;S++){var A=(0,a.readMMTGeneralLocationInfo)(i);if(null==A)return;T.push(A)}if(!i.canRead(2))break;var R=i.readUint16();if(!i.canRead(R))break;var b=(0,n.readMMTSIDescriptors)(i.subarray(R));l.push({identifierType:f,assetIdScheme:p,assetId:g,assetType:v,assetClockRelationFlag:E,locations:T,assetDescriptors:b})}return{tableId:"MPT",version:e,mptMode:o,mmtPackageId:_,mptDescriptors:c,assets:l}}}}}}}function s(e,t){var i=new r.BinaryReader(t);if(i.canRead(1)){for(var n=i.readUint8(),o=[],s=0;s<n&&i.canRead(1);s++){var _=i.readUint8();if(!i.canRead(_))break;var d=i.slice(_),c=(0,a.readMMTGeneralLocationInfo)(i);if(null==c)return;o.push({mmtPackageId:d,locationInfo:c})}return{tableId:"PLT",version:e,packages:o}}}t.MMT_SI_TABLE_MPT=32,t.MMT_SI_TABLE_PLT=128,t.MMT_SI_TABLE_ECM=130,t.MMT_SI_TABLE_EMM=132,t.MMT_SI_TABLE_EMM_MESSAGE=133,t.MMT_SI_TABLE_CAT=134,t.MMT_SI_TABLE_MH_EIT_PF=139,t.MMT_SI_TABLE_MH_EIT_SCHEDULE_BASIC_BEGIN=140,t.MMT_SI_TABLE_MH_EIT_SCHEDULE_BASIC_END=147,t.MMT_SI_TABLE_MH_EIT_SCHEDULE_EXTENDED_BEGIN=148,t.MMT_SI_TABLE_MH_EIT_SCHEDULE_EXTENDED_END=155,t.MMT_SI_TABLE_MH_AIT=156,t.MMT_SI_TABLE_MH_SDTT=158,t.MMT_SI_TABLE_MH_BIT=157,t.MMT_SI_TABLE_MH_SDT_ACTUAL=159,t.MMT_SI_TABLE_MH_SDT_OTHER=160,t.MMT_SI_TABLE_MH_TOT=161,t.MMT_SI_TABLE_MH_CDT=162,t.MMT_SI_TABLE_DDMT=163,t.MMT_SI_TABLE_DAMT=164,t.MMT_SI_TABLE_EMT=166,t.MMT_ASSET_TYPE_HEV1=(0,r.fourCC)("hev1"),t.MMT_ASSET_TYPE_MP4A=(0,r.fourCC)("mp4a"),t.MMT_ASSET_TYPE_TIMED_TEXT=(0,r.fourCC)("stpp"),t.MMT_ASSET_TYPE_APPLICATION=(0,r.fourCC)("aapp"),t.MH_CDT_DATA_TYPE_LOGO_DATA=1,t.MH_CDT_LOGO_TYPE_LARGE=7,t.MH_CDT_LOGO_TYPE_SMALL=6,t.MH_CDT_LOGO_TYPE_2K=5},function(e,t,i){"use strict";var a,n=i(0),r=function(){function e(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return e.prototype.reset=function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0},e.prototype.addBytes=function(e){0===this._firstCheckpoint?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=e,this._totalBytes+=e):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=e,this._totalBytes+=e):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=e,this._totalBytes+=e,this._lastCheckpoint=this._now())},Object.defineProperty(e.prototype,"currentKBps",{get:function(){this.addBytes(0);var e=(this._now()-this._lastCheckpoint)/1e3;return 0==e&&(e=1),this._intervalBytes/e/1024},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastSecondKBps",{get:function(){return this.addBytes(0),0!==this._lastSecondBytes?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"averageKBps",{get:function(){var e=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/e/1024},enumerable:!1,configurable:!0}),e}(),o=i(2),s=i(5),_=i(3),d=(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),c=function(e){function t(t,i){var a=e.call(this,"fetch-stream-loader")||this;return a.TAG="FetchStreamLoader",a._seekHandler=t,a._config=i,a._needStash=!0,a._requestAbort=!1,a._abortController=null,a._contentLength=null,a._receivedLength=0,a}return d(t,e),t.isSupported=function(){try{var e=s.a.msedge&&s.a.version.minor>=15048,t=!s.a.msedge||e;return self.fetch&&self.ReadableStream&&t}catch(e){return!1}},t.prototype.destroy=function(){this.isWorking()&&this.abort(),e.prototype.destroy.call(this)},t.prototype.open=function(e,t){var i=this;this._dataSource=e,this._range=t;var a=e.url;this._config.reuseRedirectedURL&&null!=e.redirectedURL&&(a=e.redirectedURL);var n=this._seekHandler.getConfig(a,t),r=new self.Headers;if("object"==typeof n.headers){var s=n.headers;for(var d in s)s.hasOwnProperty(d)&&r.append(d,s[d])}var c={method:"GET",headers:r,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if("object"==typeof this._config.headers)for(var d in this._config.headers)r.append(d,this._config.headers[d]);!1===e.cors&&(c.mode="same-origin"),e.withCredentials&&(c.credentials="include"),e.referrerPolicy&&(c.referrerPolicy=e.referrerPolicy),self.AbortController&&(this._abortController=new self.AbortController,c.signal=this._abortController.signal),this._status=o.c.kConnecting,self.fetch(n.url,c).then((function(e){if(i._requestAbort)return i._status=o.c.kIdle,void e.body.cancel();if(e.ok&&e.status>=200&&e.status<=299){if(e.url!==n.url&&i._onURLRedirect){var t=i._seekHandler.removeURLParameters(e.url);i._onURLRedirect(t)}var a=e.headers.get("Content-Length");return null!=a&&(i._contentLength=parseInt(a),0!==i._contentLength&&i._onContentLengthKnown&&i._onContentLengthKnown(i._contentLength)),i._pump.call(i,e.body.getReader())}if(i._status=o.c.kError,!i._onError)throw new _.d("FetchStreamLoader: Http code invalid, "+e.status+" "+e.statusText);i._onError(o.b.HTTP_STATUS_CODE_INVALID,{code:e.status,msg:e.statusText})})).catch((function(e){if(!i._abortController||!i._abortController.signal.aborted){if(i._status=o.c.kError,!i._onError)throw e;i._onError(o.b.EXCEPTION,{code:-1,msg:e.message})}}))},t.prototype.abort=function(){if(this._requestAbort=!0,(this._status!==o.c.kBuffering||!s.a.chrome)&&this._abortController)try{this._abortController.abort()}catch(e){}},t.prototype._pump=function(e){var t=this;return e.read().then((function(i){if(i.done)if(null!==t._contentLength&&t._receivedLength<t._contentLength){t._status=o.c.kError;var a=o.b.EARLY_EOF,n={code:-1,msg:"Fetch stream meet Early-EOF"};if(!t._onError)throw new _.d(n.msg);t._onError(a,n)}else t._status=o.c.kComplete,t._onComplete&&t._onComplete(t._range.from,t._range.from+t._receivedLength-1);else{if(t._abortController&&t._abortController.signal.aborted)return void(t._status=o.c.kComplete);if(!0===t._requestAbort)return t._status=o.c.kComplete,e.cancel();t._status=o.c.kBuffering;var r=i.value.buffer,s=t._range.from+t._receivedLength;t._receivedLength+=r.byteLength,t._onDataArrival&&t._onDataArrival(r,s,t._receivedLength),t._pump(e)}})).catch((function(e){if(t._abortController&&t._abortController.signal.aborted)t._status=o.c.kComplete;else if(11!==e.code||!s.a.msedge){t._status=o.c.kError;var i=0,a=null;if(19!==e.code&&"network error"!==e.message||!(null===t._contentLength||null!==t._contentLength&&t._receivedLength<t._contentLength)?(i=o.b.EXCEPTION,a={code:e.code,msg:e.message}):(i=o.b.EARLY_EOF,a={code:e.code,msg:"Fetch stream meet Early-EOF"}),!t._onError)throw new _.d(a.msg);t._onError(i,a)}}))},t}(o.a),u=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}(),l=function(e){function t(t,i){var a=e.call(this,"xhr-moz-chunked-loader")||this;return a.TAG="MozChunkedLoader",a._seekHandler=t,a._config=i,a._needStash=!0,a._xhr=null,a._requestAbort=!1,a._contentLength=null,a._receivedLength=0,a}return u(t,e),t.isSupported=function(){try{var e=new XMLHttpRequest;return e.open("GET","https://example.com",!0),e.responseType="moz-chunked-arraybuffer","moz-chunked-arraybuffer"===e.responseType}catch(e){return n.a.w("MozChunkedLoader",e.message),!1}},t.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),e.prototype.destroy.call(this)},t.prototype.open=function(e,t){this._dataSource=e,this._range=t;var i=e.url;this._config.reuseRedirectedURL&&null!=e.redirectedURL&&(i=e.redirectedURL);var a=this._seekHandler.getConfig(i,t);this._requestURL=a.url;var n=this._xhr=new XMLHttpRequest;if(n.open("GET",a.url,!0),n.responseType="moz-chunked-arraybuffer",n.onreadystatechange=this._onReadyStateChange.bind(this),n.onprogress=this._onProgress.bind(this),n.onloadend=this._onLoadEnd.bind(this),n.onerror=this._onXhrError.bind(this),e.withCredentials&&(n.withCredentials=!0),"object"==typeof a.headers){var r=a.headers;for(var s in r)r.hasOwnProperty(s)&&n.setRequestHeader(s,r[s])}if("object"==typeof this._config.headers){r=this._config.headers;for(var s in r)r.hasOwnProperty(s)&&n.setRequestHeader(s,r[s])}this._status=o.c.kConnecting,n.send()},t.prototype.abort=function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=o.c.kComplete},t.prototype._onReadyStateChange=function(e){var t=e.target;if(2===t.readyState){if(null!=t.responseURL&&t.responseURL!==this._requestURL&&this._onURLRedirect){var i=this._seekHandler.removeURLParameters(t.responseURL);this._onURLRedirect(i)}if(0!==t.status&&(t.status<200||t.status>299)){if(this._status=o.c.kError,!this._onError)throw new _.d("MozChunkedLoader: Http code invalid, "+t.status+" "+t.statusText);this._onError(o.b.HTTP_STATUS_CODE_INVALID,{code:t.status,msg:t.statusText})}else this._status=o.c.kBuffering}},t.prototype._onProgress=function(e){if(this._status!==o.c.kError){null===this._contentLength&&null!==e.total&&0!==e.total&&(this._contentLength=e.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var t=e.target.response,i=this._range.from+this._receivedLength;this._receivedLength+=t.byteLength,this._onDataArrival&&this._onDataArrival(t,i,this._receivedLength)}},t.prototype._onLoadEnd=function(e){!0!==this._requestAbort?this._status!==o.c.kError&&(this._status=o.c.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)):this._requestAbort=!1},t.prototype._onXhrError=function(e){this._status=o.c.kError;var t=0,i=null;if(this._contentLength&&e.loaded<this._contentLength?(t=o.b.EARLY_EOF,i={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(t=o.b.EXCEPTION,i={code:-1,msg:e.constructor.name+" "+e.type}),!this._onError)throw new _.d(i.msg);this._onError(t,i)},t}(o.a),h=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}(),f=(function(e){function t(t,i){var a=e.call(this,"xhr-msstream-loader")||this;return a.TAG="MSStreamLoader",a._seekHandler=t,a._config=i,a._needStash=!0,a._xhr=null,a._reader=null,a._totalRange=null,a._currentRange=null,a._currentRequestURL=null,a._currentRedirectedURL=null,a._contentLength=null,a._receivedLength=0,a._bufferLimit=16777216,a._lastTimeBufferSize=0,a._isReconnecting=!1,a}h(t,e),t.isSupported=function(){try{if(void 0===self.MSStream||void 0===self.MSStreamReader)return!1;var e=new XMLHttpRequest;return e.open("GET","https://example.com",!0),e.responseType="ms-stream","ms-stream"===e.responseType}catch(e){return n.a.w("MSStreamLoader",e.message),!1}},t.prototype.destroy=function(){this.isWorking()&&this.abort(),this._reader&&(this._reader.onprogress=null,this._reader.onload=null,this._reader.onerror=null,this._reader=null),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr=null),e.prototype.destroy.call(this)},t.prototype.open=function(e,t){this._internalOpen(e,t,!1)},t.prototype._internalOpen=function(e,t,i){this._dataSource=e,i?this._currentRange=t:this._totalRange=t;var a=e.url;this._config.reuseRedirectedURL&&(null!=this._currentRedirectedURL?a=this._currentRedirectedURL:null!=e.redirectedURL&&(a=e.redirectedURL));var n=this._seekHandler.getConfig(a,t);this._currentRequestURL=n.url;var r=this._reader=new self.MSStreamReader;r.onprogress=this._msrOnProgress.bind(this),r.onload=this._msrOnLoad.bind(this),r.onerror=this._msrOnError.bind(this);var s=this._xhr=new XMLHttpRequest;if(s.open("GET",n.url,!0),s.responseType="ms-stream",s.onreadystatechange=this._xhrOnReadyStateChange.bind(this),s.onerror=this._xhrOnError.bind(this),e.withCredentials&&(s.withCredentials=!0),"object"==typeof n.headers){var _=n.headers;for(var d in _)_.hasOwnProperty(d)&&s.setRequestHeader(d,_[d])}if("object"==typeof this._config.headers){_=this._config.headers;for(var d in _)_.hasOwnProperty(d)&&s.setRequestHeader(d,_[d])}this._isReconnecting?this._isReconnecting=!1:this._status=o.c.kConnecting,s.send()},t.prototype.abort=function(){this._internalAbort(),this._status=o.c.kComplete},t.prototype._internalAbort=function(){this._reader&&(1===this._reader.readyState&&this._reader.abort(),this._reader.onprogress=null,this._reader.onload=null,this._reader.onerror=null,this._reader=null),this._xhr&&(this._xhr.abort(),this._xhr.onreadystatechange=null,this._xhr=null)},t.prototype._xhrOnReadyStateChange=function(e){var t=e.target;if(2===t.readyState)if(t.status>=200&&t.status<=299){if(this._status=o.c.kBuffering,null!=t.responseURL){var i=this._seekHandler.removeURLParameters(t.responseURL);t.responseURL!==this._currentRequestURL&&i!==this._currentRedirectedURL&&(this._currentRedirectedURL=i,this._onURLRedirect&&this._onURLRedirect(i))}var a=t.getResponseHeader("Content-Length");if(null!=a&&null==this._contentLength){var n=parseInt(a);n>0&&(this._contentLength=n,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength))}}else{if(this._status=o.c.kError,!this._onError)throw new _.d("MSStreamLoader: Http code invalid, "+t.status+" "+t.statusText);this._onError(o.b.HTTP_STATUS_CODE_INVALID,{code:t.status,msg:t.statusText})}else if(3===t.readyState&&t.status>=200&&t.status<=299){this._status=o.c.kBuffering;var r=t.response;this._reader.readAsArrayBuffer(r)}},t.prototype._xhrOnError=function(e){this._status=o.c.kError;var t=o.b.EXCEPTION,i={code:-1,msg:e.constructor.name+" "+e.type};if(!this._onError)throw new _.d(i.msg);this._onError(t,i)},t.prototype._msrOnProgress=function(e){var t=e.target.result;if(null!=t){var i=t.slice(this._lastTimeBufferSize);this._lastTimeBufferSize=t.byteLength;var a=this._totalRange.from+this._receivedLength;this._receivedLength+=i.byteLength,this._onDataArrival&&this._onDataArrival(i,a,this._receivedLength),t.byteLength>=this._bufferLimit&&(n.a.v(this.TAG,"MSStream buffer exceeded max size near ".concat(a+i.byteLength,", reconnecting...")),this._doReconnectIfNeeded())}else this._doReconnectIfNeeded()},t.prototype._doReconnectIfNeeded=function(){if(null==this._contentLength||this._receivedLength<this._contentLength){this._isReconnecting=!0,this._lastTimeBufferSize=0,this._internalAbort();var e={from:this._totalRange.from+this._receivedLength,to:-1};this._internalOpen(this._dataSource,e,!0)}},t.prototype._msrOnLoad=function(e){this._status=o.c.kComplete,this._onComplete&&this._onComplete(this._totalRange.from,this._totalRange.from+this._receivedLength-1)},t.prototype._msrOnError=function(e){this._status=o.c.kError;var t=0,i=null;if(this._contentLength&&this._receivedLength<this._contentLength?(t=o.b.EARLY_EOF,i={code:-1,msg:"MSStream meet Early-Eof"}):(t=o.b.EARLY_EOF,i={code:-1,msg:e.constructor.name+" "+e.type}),!this._onError)throw new _.d(i.msg);this._onError(t,i)}}(o.a),function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}()),p=function(e){function t(t,i){var a=e.call(this,"xhr-range-loader")||this;return a.TAG="RangeLoader",a._seekHandler=t,a._config=i,a._needStash=!1,a._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],a._currentChunkSizeKB=384,a._currentSpeedNormalized=0,a._zeroSpeedChunkCount=0,a._xhr=null,a._speedSampler=new r,a._requestAbort=!1,a._waitForTotalLength=!1,a._totalLengthReceived=!1,a._currentRequestURL=null,a._currentRedirectedURL=null,a._currentRequestRange=null,a._totalLength=null,a._contentLength=null,a._receivedLength=0,a._lastTimeLoaded=0,a}return f(t,e),t.isSupported=function(){try{var e=new XMLHttpRequest;return e.open("GET","https://example.com",!0),e.responseType="arraybuffer","arraybuffer"===e.responseType}catch(e){return n.a.w("RangeLoader",e.message),!1}},t.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),e.prototype.destroy.call(this)},Object.defineProperty(t.prototype,"currentSpeed",{get:function(){return this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),t.prototype.open=function(e,t){this._dataSource=e,this._range=t,this._status=o.c.kConnecting;var i=!1;null!=this._dataSource.filesize&&0!==this._dataSource.filesize&&(i=!0,this._totalLength=this._dataSource.filesize),this._totalLengthReceived||i?this._openSubRange():(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1}))},t.prototype._openSubRange=function(){var e=1024*this._currentChunkSizeKB,t=this._range.from+this._receivedLength,i=t+e;null!=this._contentLength&&i-this._range.from>=this._contentLength&&(i=this._range.from+this._contentLength-1),this._currentRequestRange={from:t,to:i},this._internalOpen(this._dataSource,this._currentRequestRange)},t.prototype._internalOpen=function(e,t){this._lastTimeLoaded=0;var i=e.url;this._config.reuseRedirectedURL&&(null!=this._currentRedirectedURL?i=this._currentRedirectedURL:null!=e.redirectedURL&&(i=e.redirectedURL));var a=this._seekHandler.getConfig(i,t);this._currentRequestURL=a.url;var n=this._xhr=new XMLHttpRequest;if(n.open("GET",a.url,!0),n.responseType="arraybuffer",n.onreadystatechange=this._onReadyStateChange.bind(this),n.onprogress=this._onProgress.bind(this),n.onload=this._onLoad.bind(this),n.onerror=this._onXhrError.bind(this),e.withCredentials&&(n.withCredentials=!0),"object"==typeof a.headers){var r=a.headers;for(var o in r)r.hasOwnProperty(o)&&n.setRequestHeader(o,r[o])}if("object"==typeof this._config.headers){r=this._config.headers;for(var o in r)r.hasOwnProperty(o)&&n.setRequestHeader(o,r[o])}n.send()},t.prototype.abort=function(){this._requestAbort=!0,this._internalAbort(),this._status=o.c.kComplete},t.prototype._internalAbort=function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)},t.prototype._onReadyStateChange=function(e){var t=e.target;if(2===t.readyState){if(null!=t.responseURL){var i=this._seekHandler.removeURLParameters(t.responseURL);t.responseURL!==this._currentRequestURL&&i!==this._currentRedirectedURL&&(this._currentRedirectedURL=i,this._onURLRedirect&&this._onURLRedirect(i))}if(t.status>=200&&t.status<=299){if(this._waitForTotalLength)return;this._status=o.c.kBuffering}else{if(this._status=o.c.kError,!this._onError)throw new _.d("RangeLoader: Http code invalid, "+t.status+" "+t.statusText);this._onError(o.b.HTTP_STATUS_CODE_INVALID,{code:t.status,msg:t.statusText})}}},t.prototype._onProgress=function(e){if(this._status!==o.c.kError){if(null===this._contentLength){var t=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,t=!0;var i=e.total;this._internalAbort(),null!=i&0!==i&&(this._totalLength=i)}if(-1===this._range.to?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,t)return void this._openSubRange();this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var a=e.loaded-this._lastTimeLoaded;this._lastTimeLoaded=e.loaded,this._speedSampler.addBytes(a)}},t.prototype._normalizeSpeed=function(e){var t=this._chunkSizeKBList,i=t.length-1,a=0,n=0,r=i;if(e<t[0])return t[0];for(;n<=r;){if((a=n+Math.floor((r-n)/2))===i||e>=t[a]&&e<t[a+1])return t[a];t[a]<e?n=a+1:r=a-1}},t.prototype._onLoad=function(e){if(this._status!==o.c.kError)if(this._waitForTotalLength)this._waitForTotalLength=!1;else{this._lastTimeLoaded=0;var t=this._speedSampler.lastSecondKBps;if(0===t&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(t=this._speedSampler.currentKBps)),0!==t){var i=this._normalizeSpeed(t);this._currentSpeedNormalized!==i&&(this._currentSpeedNormalized=i,this._currentChunkSizeKB=i)}var a=e.target.response,n=this._range.from+this._receivedLength;this._receivedLength+=a.byteLength;var r=!1;null!=this._contentLength&&this._receivedLength<this._contentLength?this._openSubRange():r=!0,this._onDataArrival&&this._onDataArrival(a,n,this._receivedLength),r&&(this._status=o.c.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}},t.prototype._onXhrError=function(e){this._status=o.c.kError;var t=0,i=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(t=o.b.EARLY_EOF,i={code:-1,msg:"RangeLoader meet Early-Eof"}):(t=o.b.EXCEPTION,i={code:-1,msg:e.constructor.name+" "+e.type}),!this._onError)throw new _.d(i.msg);this._onError(t,i)},t}(o.a),m=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}(),g=function(e){function t(){var t=e.call(this,"websocket-loader")||this;return t.TAG="WebSocketLoader",t._needStash=!0,t._ws=null,t._requestAbort=!1,t._receivedLength=0,t}return m(t,e),t.isSupported=function(){try{return void 0!==self.WebSocket}catch(e){return!1}},t.prototype.destroy=function(){this._ws&&this.abort(),e.prototype.destroy.call(this)},t.prototype.open=function(e){try{var t=this._ws=new self.WebSocket(e.url);t.binaryType="arraybuffer",t.onopen=this._onWebSocketOpen.bind(this),t.onclose=this._onWebSocketClose.bind(this),t.onmessage=this._onWebSocketMessage.bind(this),t.onerror=this._onWebSocketError.bind(this),this._status=o.c.kConnecting}catch(e){this._status=o.c.kError;var i={code:e.code,msg:e.message};if(!this._onError)throw new _.d(i.msg);this._onError(o.b.EXCEPTION,i)}},t.prototype.abort=function(){var e=this._ws;!e||0!==e.readyState&&1!==e.readyState||(this._requestAbort=!0,e.close()),this._ws=null,this._status=o.c.kComplete},t.prototype._onWebSocketOpen=function(e){this._status=o.c.kBuffering},t.prototype._onWebSocketClose=function(e){!0!==this._requestAbort?(this._status=o.c.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)):this._requestAbort=!1},t.prototype._onWebSocketMessage=function(e){var t=this;if(e.data instanceof ArrayBuffer)this._dispatchArrayBuffer(e.data);else if(e.data instanceof Blob){var i=new FileReader;i.onload=function(){t._dispatchArrayBuffer(i.result)},i.readAsArrayBuffer(e.data)}else{this._status=o.c.kError;var a={code:-1,msg:"Unsupported WebSocket message type: "+e.data.constructor.name};if(!this._onError)throw new _.d(a.msg);this._onError(o.b.EXCEPTION,a)}},t.prototype._dispatchArrayBuffer=function(e){var t=e,i=this._receivedLength;this._receivedLength+=t.byteLength,this._onDataArrival&&this._onDataArrival(t,i,this._receivedLength)},t.prototype._onWebSocketError=function(e){this._status=o.c.kError;var t={code:e.code,msg:e.message};if(!this._onError)throw new _.d(t.msg);this._onError(o.b.EXCEPTION,t)},t}(o.a),v=function(){function e(e){this._zeroStart=e||!1}return e.prototype.getConfig=function(e,t){var i={};if(0!==t.from||-1!==t.to){var a=void 0;a=-1!==t.to?"bytes=".concat(t.from.toString(),"-").concat(t.to.toString()):"bytes=".concat(t.from.toString(),"-"),i.Range=a}else this._zeroStart&&(i.Range="bytes=0-");return{url:e,headers:i}},e.prototype.removeURLParameters=function(e){return e},e}(),E=function(){function e(e,t){this._startName=e,this._endName=t}return e.prototype.getConfig=function(e,t){var i=e;if(0!==t.from||-1!==t.to){var a=!0;-1===i.indexOf("?")&&(i+="?",a=!1),a&&(i+="&"),i+="".concat(this._startName,"=").concat(t.from.toString()),-1!==t.to&&(i+="&".concat(this._endName,"=").concat(t.to.toString()))}return{url:i,headers:{}}},e.prototype.removeURLParameters=function(e){var t=e.split("?")[0],i=void 0,a=e.indexOf("?");-1!==a&&(i=e.substring(a+1));var n="";if(null!=i&&i.length>0)for(var r=i.split("&"),o=0;o<r.length;o++){var s=r[o].split("="),_=o>0;s[0]!==this._startName&&s[0]!==this._endName&&(_&&(n+="&"),n+=r[o])}return 0===n.length?t:t+"?"+n},e}(),y=function(){function e(e,t,i,a){this.TAG="IOController",this._config=t,this._extraData=i,this._context=a,this._stashInitialSize=65536,null!=t.stashInitialSize&&t.stashInitialSize>0&&(this._stashInitialSize=t.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=Math.max(this._stashSize,3145728),this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,!1===t.enableStashBuffer&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=e,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(e.url),this._refTotalLength=e.filesize?e.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new r,this._speedNormalizeList=[32,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return e.prototype.destroy=function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null},e.prototype.isWorking=function(){return this._loader&&this._loader.isWorking()&&!this._paused},e.prototype.isPaused=function(){return this._paused},Object.defineProperty(e.prototype,"status",{get:function(){return this._loader.status},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"extraData",{get:function(){return this._extraData},set:function(e){this._extraData=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(e){this._onDataArrival=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onSeeked",{get:function(){return this._onSeeked},set:function(e){this._onSeeked=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onError",{get:function(){return this._onError},set:function(e){this._onError=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onComplete",{get:function(){return this._onComplete},set:function(e){this._onComplete=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onRedirect",{get:function(){return this._onRedirect},set:function(e){this._onRedirect=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onRecoveredEarlyEof",{get:function(){return this._onRecoveredEarlyEof},set:function(e){this._onRecoveredEarlyEof=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentURL",{get:function(){return this._dataSource.url},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasRedirect",{get:function(){return null!=this._redirectedURL||null!=this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentRedirectedURL",{get:function(){return this._redirectedURL||this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentSpeed",{get:function(){return this._loaderClass===p?this._loader.currentSpeed:this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"loaderType",{get:function(){return this._loader.type},enumerable:!1,configurable:!0}),e.prototype._selectSeekHandler=function(){var e=this._config;if("range"===e.seekType)this._seekHandler=new v(this._config.rangeLoadZeroStart);else if("param"===e.seekType){var t=e.seekParamStart||"bstart",i=e.seekParamEnd||"bend";this._seekHandler=new E(t,i)}else{if("custom"!==e.seekType)throw new _.b("Invalid seekType in config: ".concat(e.seekType));if("function"!=typeof e.customSeekHandler)throw new _.b("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new e.customSeekHandler}},e.prototype._selectLoader=function(){if(null!=this._config.customLoader)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=g;else if(c.isSupported())this._loaderClass=c;else if(l.isSupported())this._loaderClass=l;else{if(!p.isSupported())throw new _.d("Your browser doesn't support xhr with arraybuffer responseType!");this._loaderClass=p}},e.prototype._createLoader=function(){this._loader=new this._loaderClass(this._seekHandler,this._config,this._context),!1===this._loader.needStashBuffer&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)},e.prototype.open=function(e){this._currentRange={from:0,to:-1},e&&(this._currentRange.from=e),this._speedSampler.reset(),e||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))},e.prototype.abort=function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)},e.prototype.pause=function(){this.isWorking()&&(this._loader.abort(),0!==this._stashUsed?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)},e.prototype.resume=function(){if(this._paused){this._paused=!1;var e=this._resumeFrom;this._resumeFrom=0,this._internalSeek(e,!0)}},e.prototype.seek=function(e){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(e,!0)},e.prototype._internalSeek=function(e,t){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(t),this._loader.destroy(),this._loader=null;var i={from:e,to:-1};this._currentRange={from:i.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,i),this._onSeeked&&this._onSeeked()},e.prototype.updateUrl=function(e){if(!e||"string"!=typeof e||0===e.length)throw new _.b("Url must be a non-empty string!");this._dataSource.url=e},e.prototype._expandBuffer=function(e){for(var t=this._stashSize;t+1048576<e;)t*=2;if((t+=1048576)!==this._bufferSize){var i=new ArrayBuffer(t);if(this._stashUsed>0){var a=new Uint8Array(this._stashBuffer,0,this._stashUsed);new Uint8Array(i,0,t).set(a,0)}this._stashBuffer=i,this._bufferSize=t}},e.prototype._normalizeSpeed=function(e){var t=this._speedNormalizeList,i=t.length-1,a=0,n=0,r=i;if(e<t[0])return t[0];for(;n<=r;){if((a=n+Math.floor((r-n)/2))===i||e>=t[a]&&e<t[a+1])return t[a];t[a]<e?n=a+1:r=a-1}},e.prototype._adjustStashSize=function(e){var t=0;(t=this._config.isLive?e/8:e<512?e:e>=512&&e<=1024?Math.floor(1.5*e):2*e)>8192&&(t=8192);var i=1024*t+1048576;this._bufferSize<i&&this._expandBuffer(i),this._stashSize=1024*t},e.prototype._dispatchChunks=function(e,t){return this._currentRange.to=t+e.byteLength-1,this._onDataArrival(e,t)},e.prototype._onURLRedirect=function(e){this._redirectedURL=e,this._onRedirect&&this._onRedirect(e)},e.prototype._onContentLengthKnown=function(e){e&&this._fullRequestFlag&&(this._totalLength=e,this._fullRequestFlag=!1)},Object.defineProperty(e.prototype,"totalLength",{get:function(){return this._totalLength},enumerable:!1,configurable:!0}),e.prototype._onLoaderChunkArrival=function(e,t,i){if(!this._onDataArrival)throw new _.a("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(e.byteLength);var a=this._speedSampler.lastSecondKBps;if(0!==a){var n=this._normalizeSpeed(a);this._speedNormalized!==n&&(this._speedNormalized=n,this._adjustStashSize(n))}if(this._enableStash)if(0===this._stashUsed&&0===this._stashByteStart&&(this._stashByteStart=t),this._stashUsed+e.byteLength<=this._stashSize){(s=new Uint8Array(this._stashBuffer,0,this._stashSize)).set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength}else{s=new Uint8Array(this._stashBuffer,0,this._bufferSize);if(this._stashUsed>0){var r=this._stashBuffer.slice(0,this._stashUsed);if((d=this._dispatchChunks(r,this._stashByteStart))<r.byteLength){if(d>0){c=new Uint8Array(r,d);s.set(c,0),this._stashUsed=c.byteLength,this._stashByteStart+=d}}else this._stashUsed=0,this._stashByteStart+=d;this._stashUsed+e.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+e.byteLength),s=new Uint8Array(this._stashBuffer,0,this._bufferSize)),s.set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength}else{if((d=this._dispatchChunks(e,t))<e.byteLength)(o=e.byteLength-d)>this._bufferSize&&(this._expandBuffer(o),s=new Uint8Array(this._stashBuffer,0,this._bufferSize)),s.set(new Uint8Array(e,d),0),this._stashUsed+=o,this._stashByteStart=t+d}}else if(0===this._stashUsed){var o;if((d=this._dispatchChunks(e,t))<e.byteLength)(o=e.byteLength-d)>this._bufferSize&&this._expandBuffer(o),(s=new Uint8Array(this._stashBuffer,0,this._bufferSize)).set(new Uint8Array(e,d),0),this._stashUsed+=o,this._stashByteStart=t+d}else{var s,d;if(this._stashUsed+e.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+e.byteLength),(s=new Uint8Array(this._stashBuffer,0,this._bufferSize)).set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength,(d=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart))<this._stashUsed&&d>0){var c=new Uint8Array(this._stashBuffer,d);s.set(c,0)}this._stashUsed-=d,this._stashByteStart+=d}}},e.prototype._flushStashBuffer=function(e){if(this._stashUsed>0){var t=this._stashBuffer.slice(0,this._stashUsed),i=this._dispatchChunks(t,this._stashByteStart),a=t.byteLength-i;if(i<t.byteLength){if(!e){if(i>0){var r=new Uint8Array(this._stashBuffer,0,this._bufferSize),o=new Uint8Array(t,i);r.set(o,0),this._stashUsed=o.byteLength,this._stashByteStart+=i}return 0}n.a.w(this.TAG,"".concat(a," bytes unconsumed data remain when flush buffer, dropped"))}return this._stashUsed=0,this._stashByteStart=0,a}return 0},e.prototype._onLoaderComplete=function(e,t){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)},e.prototype._onLoaderError=function(e,t){switch(n.a.e(this.TAG,"Loader error, code = ".concat(t.code,", msg = ").concat(t.msg)),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,e=o.b.UNRECOVERABLE_EARLY_EOF),e){case o.b.EARLY_EOF:if(!this._config.isLive&&this._totalLength){var i=this._currentRange.to+1;return void(i<this._totalLength&&(n.a.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(i,!1)))}e=o.b.UNRECOVERABLE_EARLY_EOF;break;case o.b.UNRECOVERABLE_EARLY_EOF:case o.b.CONNECTING_TIMEOUT:case o.b.HTTP_STATUS_CODE_INVALID:case o.b.EXCEPTION:}if(!this._onError)throw new _.d("IOException: "+t.msg);this._onError(e,t)},e}();t.a=y},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MMTTLVReader=t.CID_HEADER_TYPE_COMPRESSED=t.CID_HEADER_TYPE_IPV6_UDP_FULL=t.TLV_PACKET_TYPE_NULL=t.TLV_PACKET_TYPE_SI=t.TLV_PACKET_TYPE_COMPRESSED=t.TLV_PACKET_TYPE_IPV6=t.TLV_SYNC_BYTE=void 0,t.createMMTTLVReader=function(){return new _};var a=i(34),n=i(11),r=i(26),o=i(37),s=i(25);t.TLV_SYNC_BYTE=127,t.TLV_PACKET_TYPE_IPV6=2,t.TLV_PACKET_TYPE_COMPRESSED=3,t.TLV_PACKET_TYPE_SI=254,t.TLV_PACKET_TYPE_NULL=255,t.CID_HEADER_TYPE_IPV6_UDP_FULL=96,t.CID_HEADER_TYPE_COMPRESSED=97;var _=function(){function e(){this.bytes_=0,this.buffer=new Uint8Array(0),this.eventTarget=new o.CustomEventTarget,this.mmtpReader=new n.MMTPReader(this.eventTarget)}return Object.defineProperty(e.prototype,"bytes",{get:function(){return this.bytes_},enumerable:!1,configurable:!0}),e.prototype.onSI=function(e){var t,i=(0,a.readTLVSI)(e);null!=i&&("TLV-NIT[actual]"!==i.tableId&&"TLV-NIT[other]"!==i.tableId||null===(t=this.eventTarget)||void 0===t||t.dispatchEvent("nit",{table:i}))},e.prototype.addEventListener=function(e,t){var i;null===(i=this.eventTarget)||void 0===i||i.addEventListener(e,t)},e.prototype.removeEventListener=function(e,t){var i;null===(i=this.eventTarget)||void 0===i||i.removeEventListener(e,t)},e.prototype.close=function(){delete this.eventTarget},e.prototype.reset=function(){this.buffer=new Uint8Array(0),this.mmtpReader.reset(),this.bytes_=0},e.prototype.processNTP=function(e,t){var i,a;if((null===(i=this.eventTarget)||void 0===i?void 0:i.getListenerCount("ntp"))&&!(t.length<r.TLV_HEADER_SIZE+40)){var n=t[r.TLV_HEADER_SIZE+4]<<8|t[r.TLV_HEADER_SIZE+5],o=t[r.TLV_HEADER_SIZE+6];if(!(n+r.TLV_HEADER_SIZE+40>t.length)&&17===o){var _=t[r.TLV_HEADER_SIZE+40+4]<<8|t[r.TLV_HEADER_SIZE+40+5];if(!(_<8||_+r.TLV_HEADER_SIZE+40>t.length)){var d=(0,s.readNTPPacket)(t.subarray(r.TLV_HEADER_SIZE+40+8,r.TLV_HEADER_SIZE+40+_));null!=d&&(null===(a=this.eventTarget)||void 0===a||a.dispatchEvent("ntp",{offset:e,ntp:d}))}}}},e.prototype.push=function(e){if(0!==e.length){var i=new Uint8Array(this.buffer.length+e.length);i.set(this.buffer);var a=this.bytes_-this.buffer.length;for(this.bytes_+=e.length,i.set(e,this.buffer.length),this.buffer=i;0!==this.buffer.length;){var n=d(this.buffer),o=n[0],s=n[1];if(0===o)break;if(this.buffer=this.buffer.subarray(o),null!=s){var _=s[1];if(_===t.TLV_PACKET_TYPE_SI&&this.onSI(s),_===t.TLV_PACKET_TYPE_IPV6&&this.processNTP(a+s.byteOffset,s),_===t.TLV_PACKET_TYPE_COMPRESSED){if(s.length<r.TLV_HEADER_SIZE+4)continue;s[r.TLV_HEADER_SIZE],s[r.TLV_HEADER_SIZE+1],s[r.TLV_HEADER_SIZE+1];var c=s[r.TLV_HEADER_SIZE+2];if(c===t.CID_HEADER_TYPE_IPV6_UDP_FULL){if(s.length<r.TLV_HEADER_SIZE+3+38+4)continue;this.mmtpReader.push(s,r.TLV_HEADER_SIZE+3+38+4)}else c===t.CID_HEADER_TYPE_COMPRESSED&&this.mmtpReader.push(s,r.TLV_HEADER_SIZE+3)}}}}},e}();function d(e){var i=e.indexOf(t.TLV_SYNC_BYTE);if(-1===i)return[e.length,void 0];if(e.length<i+r.TLV_HEADER_SIZE)return[i,void 0];var a=e[i+1];if(a!==t.TLV_PACKET_TYPE_IPV6&&a!==t.TLV_PACKET_TYPE_COMPRESSED&&a!==t.TLV_PACKET_TYPE_SI&&a!==t.TLV_PACKET_TYPE_NULL)return a===t.TLV_SYNC_BYTE?[i+1,void 0]:[i+2,void 0];var n=e[i+2]<<8|e[i+3];return e.length<i+r.TLV_HEADER_SIZE+n?[i,void 0]:[i+r.TLV_HEADER_SIZE+n,e.subarray(i,i+r.TLV_HEADER_SIZE+n)]}t.MMTTLVReader=_},function(e,t,i){"use strict";var a=i(9),n=i.n(a),r=i(0),o=i(5),s=i(10);function _(e,t,i){var a=e;if(t+i<a.length){for(;i--;)if(128!=(192&a[++t]))return!1;return!0}return!1}var d,c=function(e){for(var t=[],i=e,a=0,n=e.length;a<n;)if(i[a]<128)t.push(String.fromCharCode(i[a])),++a;else{if(i[a]<192);else if(i[a]<224){if(_(i,a,1))if((r=(31&i[a])<<6|63&i[a+1])>=128){t.push(String.fromCharCode(65535&r)),a+=2;continue}}else if(i[a]<240){if(_(i,a,2))if((r=(15&i[a])<<12|(63&i[a+1])<<6|63&i[a+2])>=2048&&55296!=(63488&r)){t.push(String.fromCharCode(65535&r)),a+=3;continue}}else if(i[a]<248){var r;if(_(i,a,3))if((r=(7&i[a])<<18|(63&i[a+1])<<12|(63&i[a+2])<<6|63&i[a+3])>65536&&r<1114112){r-=65536,t.push(String.fromCharCode(r>>>10|55296)),t.push(String.fromCharCode(1023&r|56320)),a+=4;continue}}t.push(String.fromCharCode(65533)),++a}return t.join("")},u=i(3),l=(d=new ArrayBuffer(2),new DataView(d).setInt16(0,256,!0),256===new Int16Array(d)[0]),h=function(){function e(){}return e.parseScriptData=function(t,i,a){var n={};try{var o=e.parseValue(t,i,a),s=e.parseValue(t,i+o.size,a-o.size);n[o.data]=s.data}catch(e){r.a.e("AMF",e.toString())}return n},e.parseObject=function(t,i,a){if(a<3)throw new u.a("Data not enough when parse ScriptDataObject");var n=e.parseString(t,i,a),r=e.parseValue(t,i+n.size,a-n.size),o=r.objectEnd;return{data:{name:n.data,value:r.data},size:n.size+r.size,objectEnd:o}},e.parseVariable=function(t,i,a){return e.parseObject(t,i,a)},e.parseString=function(e,t,i){if(i<2)throw new u.a("Data not enough when parse String");var a=new DataView(e,t,i).getUint16(0,!l);return{data:a>0?c(new Uint8Array(e,t+2,a)):"",size:2+a}},e.parseLongString=function(e,t,i){if(i<4)throw new u.a("Data not enough when parse LongString");var a=new DataView(e,t,i).getUint32(0,!l);return{data:a>0?c(new Uint8Array(e,t+4,a)):"",size:4+a}},e.parseDate=function(e,t,i){if(i<10)throw new u.a("Data size invalid when parse Date");var a=new DataView(e,t,i),n=a.getFloat64(0,!l),r=a.getInt16(8,!l);return{data:new Date(n+=60*r*1e3),size:10}},e.parseValue=function(t,i,a){if(a<1)throw new u.a("Data not enough when parse Value");var n,o=new DataView(t,i,a),s=1,_=o.getUint8(0),d=!1;try{switch(_){case 0:n=o.getFloat64(1,!l),s+=8;break;case 1:n=!!o.getUint8(1),s+=1;break;case 2:var c=e.parseString(t,i+1,a-1);n=c.data,s+=c.size;break;case 3:n={};var h=0;for(9==(16777215&o.getUint32(a-4,!l))&&(h=3);s<a-4;){var f=e.parseObject(t,i+s,a-s-h);if(f.objectEnd)break;n[f.data.name]=f.data.value,s+=f.size}if(s<=a-3)9===(16777215&o.getUint32(s-1,!l))&&(s+=3);break;case 8:n={},s+=4;h=0;for(9==(16777215&o.getUint32(a-4,!l))&&(h=3);s<a-8;){var p=e.parseVariable(t,i+s,a-s-h);if(p.objectEnd)break;n[p.data.name]=p.data.value,s+=p.size}if(s<=a-3)9===(16777215&o.getUint32(s-1,!l))&&(s+=3);break;case 9:n=void 0,s=1,d=!0;break;case 10:n=[];var m=o.getUint32(1,!l);s+=4;for(var g=0;g<m;g++){var v=e.parseValue(t,i+s,a-s);n.push(v.data),s+=v.size}break;case 11:var E=e.parseDate(t,i+1,a-1);n=E.data,s+=E.size;break;case 12:var y=e.parseString(t,i+1,a-1);n=y.data,s+=y.size;break;default:s=a,r.a.w("AMF","Unsupported AMF value type "+_)}}catch(e){r.a.e("AMF",e.toString())}return{data:n,size:s,objectEnd:d}},e}(),f=function(){function e(e){this.TAG="ExpGolomb",this._buffer=e,this._buffer_index=0,this._total_bytes=e.byteLength,this._total_bits=8*e.byteLength,this._current_word=0,this._current_word_bits_left=0}return e.prototype.destroy=function(){this._buffer=null},e.prototype._fillCurrentWord=function(){var e=this._total_bytes-this._buffer_index;if(e<=0)throw new u.a("ExpGolomb: _fillCurrentWord() but no bytes available");var t=Math.min(4,e),i=new Uint8Array(4);i.set(this._buffer.subarray(this._buffer_index,this._buffer_index+t)),this._current_word=new DataView(i.buffer).getUint32(0,!1),this._buffer_index+=t,this._current_word_bits_left=8*t},e.prototype.readBits=function(e){if(e>32)throw new u.b("ExpGolomb: readBits() bits exceeded max 32bits!");if(e<=this._current_word_bits_left){var t=this._current_word>>>32-e;return this._current_word<<=e,this._current_word_bits_left-=e,t}var i=this._current_word_bits_left?this._current_word:0;i>>>=32-this._current_word_bits_left;var a=e-this._current_word_bits_left;this._fillCurrentWord();var n=Math.min(a,this._current_word_bits_left),r=this._current_word>>>32-n;return this._current_word<<=n,this._current_word_bits_left-=n,i=i<<n|r},e.prototype.readBool=function(){return 1===this.readBits(1)},e.prototype.readByte=function(){return this.readBits(8)},e.prototype._skipLeadingZero=function(){var e;for(e=0;e<this._current_word_bits_left;e++)if(0!=(this._current_word&2147483648>>>e))return this._current_word<<=e,this._current_word_bits_left-=e,e;return this._fillCurrentWord(),e+this._skipLeadingZero()},e.prototype.readUEG=function(){var e=this._skipLeadingZero();return this.readBits(e+1)-1},e.prototype.readSEG=function(){var e=this.readUEG();return 1&e?e+1>>>1:-1*(e>>>1)},e}(),p=function(){function e(){}return e._ebsp2rbsp=function(e){for(var t=e,i=t.byteLength,a=new Uint8Array(i),n=0,r=0;r<i;r++)r>=2&&3===t[r]&&0===t[r-1]&&0===t[r-2]||(a[n]=t[r],n++);return new Uint8Array(a.buffer,0,n)},e.parseSPS=function(t){for(var i=t.subarray(1,4),a="avc1.",n=0;n<3;n++){var r=i[n].toString(16);r.length<2&&(r="0"+r),a+=r}var o=e._ebsp2rbsp(t),s=new f(o);s.readByte();var _=s.readByte();s.readByte();var d=s.readByte();s.readUEG();var c=e.getProfileString(_),u=e.getLevelString(d),l=1,h=420,p=8,m=8;if((100===_||110===_||122===_||244===_||44===_||83===_||86===_||118===_||128===_||138===_||144===_)&&(3===(l=s.readUEG())&&s.readBits(1),l<=3&&(h=[0,420,422,444][l]),p=s.readUEG()+8,m=s.readUEG()+8,s.readBits(1),s.readBool()))for(var g=3!==l?8:12,v=0;v<g;v++)s.readBool()&&(v<6?e._skipScalingList(s,16):e._skipScalingList(s,64));s.readUEG();var E=s.readUEG();if(0===E)s.readUEG();else if(1===E){s.readBits(1),s.readSEG(),s.readSEG();var y=s.readUEG();for(v=0;v<y;v++)s.readSEG()}var T=s.readUEG();s.readBits(1);var S=s.readUEG(),A=s.readUEG(),R=s.readBits(1);0===R&&s.readBits(1),s.readBits(1);var b=0,I=0,M=0,O=0;s.readBool()&&(b=s.readUEG(),I=s.readUEG(),M=s.readUEG(),O=s.readUEG());var C=1,D=1,L=0,P=!0,k=0,N=0;if(s.readBool()){if(s.readBool()){var w=s.readByte();w>0&&w<16?(C=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][w-1],D=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][w-1]):255===w&&(C=s.readByte()<<8|s.readByte(),D=s.readByte()<<8|s.readByte())}if(s.readBool()&&s.readBool(),s.readBool()&&(s.readBits(4),s.readBool()&&s.readBits(24)),s.readBool()&&(s.readUEG(),s.readUEG()),s.readBool()){var U=s.readBits(32),B=s.readBits(32);P=s.readBool(),L=(k=B)/(N=2*U)}}var x=1;1===C&&1===D||(x=C/D);var V=0,G=0;0===l?(V=1,G=2-R):(V=3===l?1:2,G=(1===l?2:1)*(2-R));var F=16*(S+1),H=16*(A+1)*(2-R);F-=(b+I)*V,H-=(M+O)*G;var Y=Math.ceil(F*x);return s.destroy(),s=null,{codec_mimetype:a,profile_idc:_,level_idc:d,profile_string:c,level_string:u,chroma_format_idc:l,bit_depth:p,bit_depth_luma:p,bit_depth_chroma:m,ref_frames:T,chroma_format:h,chroma_format_string:e.getChromaFormatString(h),frame_rate:{fixed:P,fps:L,fps_den:N,fps_num:k},sar_ratio:{width:C,height:D},codec_size:{width:F,height:H},present_size:{width:Y,height:H}}},e._skipScalingList=function(e,t){for(var i=8,a=8,n=0;n<t;n++)0!==a&&(a=(i+e.readSEG()+256)%256),i=0===a?i:a},e.getProfileString=function(e){switch(e){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}},e.getLevelString=function(e){return(e/10).toFixed(1)},e.getChromaFormatString=function(e){switch(e){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}},e}(),m=i(6),g=function(){function e(){}return e._ebsp2rbsp=function(e){for(var t=e,i=t.byteLength,a=new Uint8Array(i),n=0,r=0;r<i;r++)r>=2&&3===t[r]&&0===t[r-1]&&0===t[r-2]||(a[n]=t[r],n++);return new Uint8Array(a.buffer,0,n)},e.parseVPS=function(t){var i=e._ebsp2rbsp(t),a=new f(i);a.readByte(),a.readByte();a.readBits(4);a.readBits(2);a.readBits(6);return{num_temporal_layers:a.readBits(3)+1,temporal_id_nested:a.readBool()}},e.parseSPS=function(t){var i=e._ebsp2rbsp(t),a=new f(i);a.readByte(),a.readByte();for(var n=0,r=0,o=0,s=0,_=(a.readBits(4),a.readBits(3)),d=(a.readBool(),a.readBits(2)),c=a.readBool(),u=a.readBits(5),l=a.readByte(),h=a.readByte(),p=a.readByte(),m=a.readByte(),g=a.readByte(),v=a.readByte(),E=a.readByte(),y=a.readByte(),T=a.readByte(),S=a.readByte(),A=a.readByte(),R=[],b=[],I=0;I<_;I++)R.push(a.readBool()),b.push(a.readBool());if(_>0)for(I=_;I<8;I++)a.readBits(2);for(I=0;I<_;I++)R[I]&&(a.readByte(),a.readByte(),a.readByte(),a.readByte(),a.readByte(),a.readByte(),a.readByte(),a.readByte(),a.readByte(),a.readByte(),a.readByte()),b[I]&&a.readByte();a.readUEG();var M=a.readUEG();3==M&&a.readBits(1);var O=a.readUEG(),C=a.readUEG();a.readBool()&&(n+=a.readUEG(),r+=a.readUEG(),o+=a.readUEG(),s+=a.readUEG());var D=a.readUEG(),L=a.readUEG(),P=a.readUEG();for(I=a.readBool()?0:_;I<=_;I++)a.readUEG(),a.readUEG(),a.readUEG();a.readUEG(),a.readUEG(),a.readUEG(),a.readUEG(),a.readUEG(),a.readUEG();if(a.readBool()&&a.readBool())for(var k=0;k<4;k++)for(var N=0;N<(3===k?2:6);N++){if(a.readBool()){var w=Math.min(64,1<<4+(k<<1));k>1&&a.readSEG();for(I=0;I<w;I++)a.readSEG()}else a.readUEG()}a.readBool(),a.readBool();a.readBool()&&(a.readByte(),a.readUEG(),a.readUEG(),a.readBool());var U=a.readUEG(),B=0;for(I=0;I<U;I++){var x=!1;if(0!==I&&(x=a.readBool()),x){I===U&&a.readUEG(),a.readBool(),a.readUEG();for(var V=0,G=0;G<=B;G++){var F=a.readBool(),H=!1;F||(H=a.readBool()),(F||H)&&V++}B=V}else{var Y=a.readUEG(),j=a.readUEG();B=Y+j;for(G=0;G<Y;G++)a.readUEG(),a.readBool();for(G=0;G<j;G++)a.readUEG(),a.readBool()}}if(a.readBool()){var q=a.readUEG();for(I=0;I<q;I++){for(G=0;G<P+4;G++)a.readBits(1);a.readBits(1)}}var z=0,K=1,W=1,X=!1,Q=1,Z=1,J=(a.readBool(),a.readBool(),2),$=2,ee=2;if(a.readBool()){if(a.readBool()){var te=a.readByte();te>0&&te<=16?(K=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][te-1],W=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][te-1]):255===te&&(K=a.readBits(16),W=a.readBits(16))}if(a.readBool()&&a.readBool(),a.readBool())a.readBits(3),a.readBool(),a.readBool()&&(J=a.readByte(),$=a.readByte(),ee=a.readByte());a.readBool()&&(a.readUEG(),a.readUEG());a.readBool(),a.readBool(),a.readBool();if(a.readBool()&&(a.readUEG(),a.readUEG(),a.readUEG(),a.readUEG()),a.readBool())if(Q=a.readBits(32),Z=a.readBits(32),a.readBool()&&a.readUEG(),a.readBool()){var ie=!1,ae=!1,ne=!1;if(ie=a.readBool(),ae=a.readBool(),ie||ae){(ne=a.readBool())&&(a.readByte(),a.readBits(5),a.readBool(),a.readBits(5));a.readBits(4),a.readBits(4);ne&&a.readBits(4),a.readBits(5),a.readBits(5),a.readBits(5)}for(I=0;I<=_;I++){var re=a.readBool();X=re;var oe=!0,se=1;re||(oe=a.readBool());var _e=!1;if(oe?a.readUEG():_e=a.readBool(),_e||(se=a.readUEG()+1),ie){for(G=0;G<se;G++)a.readUEG(),a.readUEG(),ne&&(a.readUEG(),a.readUEG());a.readBool()}if(ae){for(G=0;G<se;G++)a.readUEG(),a.readUEG(),ne&&(a.readUEG(),a.readUEG());a.readBool()}}}if(a.readBool()){a.readBool(),a.readBool(),a.readBool();z=a.readUEG();a.readUEG(),a.readUEG(),a.readUEG(),a.readUEG()}}a.readBool();var de="hvc1.".concat(u,".1.L").concat(A,".B0"),ce=O-(n+r)*(1===M||2===M?2:1),ue=C-(o+s)*(1===M?2:1),le=1;return 1!==K&&1!==W&&(le=K/W),a.destroy(),a=null,{codec_mimetype:de,profile_string:e.getProfileString(u),level_string:e.getLevelString(A),profile_idc:u,bit_depth:D+8,ref_frames:1,chroma_format:M,chroma_format_string:e.getChromaFormatString(M),general_level_idc:A,general_profile_space:d,general_tier_flag:c,general_profile_idc:u,general_profile_compatibility_flags_1:l,general_profile_compatibility_flags_2:h,general_profile_compatibility_flags_3:p,general_profile_compatibility_flags_4:m,general_constraint_indicator_flags_1:g,general_constraint_indicator_flags_2:v,general_constraint_indicator_flags_3:E,general_constraint_indicator_flags_4:y,general_constraint_indicator_flags_5:T,general_constraint_indicator_flags_6:S,min_spatial_segmentation_idc:z,constant_frame_rate:0,chroma_format_idc:M,bit_depth_luma_minus8:D,bit_depth_chroma_minus8:L,colour_primaries:J,transfer_characteristics:$,matrix_coeffs:ee,frame_rate:{fixed:X,fps:Z/Q,fps_den:Q,fps_num:Z},sar_ratio:{width:K,height:W},codec_size:{width:ce,height:ue},present_size:{width:ce*le,height:ue}}},e.parsePPS=function(t){var i=e._ebsp2rbsp(t),a=new f(i);a.readByte(),a.readByte();a.readUEG(),a.readUEG(),a.readBool(),a.readBool(),a.readBits(3),a.readBool(),a.readBool(),a.readUEG(),a.readUEG(),a.readSEG(),a.readBool(),a.readBool();if(a.readBool())a.readUEG();a.readSEG(),a.readSEG(),a.readBool(),a.readBool(),a.readBool(),a.readBool();var n=a.readBool(),r=a.readBool(),o=1;return r&&n?o=0:r?o=3:n&&(o=2),{parallelismType:o}},e.getChromaFormatString=function(e){switch(e){case 0:return"4:0:0";case 1:return"4:2:0";case 2:return"4:2:2";case 3:return"4:4:4";default:return"Unknown"}},e.getProfileString=function(e){switch(e){case 1:return"Main";case 2:return"Main10";case 3:return"MainSP";case 4:return"Rext";case 9:return"SCC";default:return"Unknown"}},e.getLevelString=function(e){return(e/30).toFixed(1)},e}();function v(e){return e.byteOffset%2==0&&e.byteLength%2==0}function E(e){return e.byteOffset%4==0&&e.byteLength%4==0}function y(e,t){for(var i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}var T=function(e,t){return e.byteLength===t.byteLength&&(E(e)&&E(t)?function(e,t){return y(new Uint32Array(e.buffer,e.byteOffset,e.byteLength/4),new Uint32Array(t.buffer,t.byteOffset,t.byteLength/4))}(e,t):v(e)&&v(t)?function(e,t){return y(new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2),new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2))}(e,t):function(e,t){return y(e,t)}(e,t))},S=function(){return(S=Object.assign||function(e){for(var t,i=1,a=arguments.length;i<a;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},A=function(){function e(){}return e.parseOBUs=function(t,i){for(var a=0;a<t.byteLength;){var n=a,r=(t[a],(120&t[a])>>3),o=0!=(4&t[a]),s=0!=(2&t[a]);t[a];a+=1;o&&(a+=1);var _=Number.POSITIVE_INFINITY;if(s){_=0;for(var d=0;;d++){var c=t[a++];if(_|=(127&c)<<7*d,0==(128&c))break}}console.log(r),1===r?i=S(S({},e.parseSeuqneceHeader(t.subarray(a,a+_))),{sequence_header_data:t.subarray(n,a+_)}):(3==r&&i||6==r&&i)&&(i=e.parseOBUFrameHeader(t.subarray(a,a+_),0,0,i)),a+=_}return i},e.parseSeuqneceHeader=function(t){var i=new f(t),a=i.readBits(3),n=(i.readBool(),i.readBool()),r=!0,o=0,s=1,_=void 0,d=[];if(n)d.push({operating_point_idc:0,level:i.readBits(5),tier:0});else{if(i.readBool()){var c=i.readBits(32),u=i.readBits(32),l=i.readBool();if(l){for(var h=0;;){if(0!==i.readBits(1))break;h+=1}h>=32?4294967295:(1<<h)-1+i.readBits(h)}if((o=u)/(s=c),r=l,i.readBool()){i.readBits(5);i.readBits(32);_=i.readBits(5);i.readBits(5)}}for(var p=i.readBool(),m=i.readBits(5),g=0;g<=m;g++){var v=i.readBits(12),E=i.readBits(5),y=E>7?i.readBits(1):0;if(d.push({operating_point_idc:v,level:E,tier:y}),p)if(i.readBool())i.readBits(4)}}var T=d[0],S=T.level,A=T.tier,R=i.readBits(4),b=i.readBits(4),I=i.readBits(R+1)+1,M=i.readBits(b+1)+1,O=!1;n||(O=i.readBool());if(O)i.readBits(4),i.readBits(4);i.readBool(),i.readBool(),i.readBool();var C=!1,D=2,L=2,P=0;if(!n){if(i.readBool(),i.readBool(),i.readBool(),i.readBool(),C=i.readBool())i.readBool(),i.readBool();if(D=i.readBool()?2:i.readBits(1))L=i.readBool()?2:i.readBits(1);else L=2;if(C)P=i.readBits(3)+1;else P=0}var k=i.readBool(),N=(i.readBool(),i.readBool(),i.readBool()),w=8;2===a&&N?w=i.readBool()?12:10:w=N?10:8;var U=!1;1!==a&&(U=i.readBool());if(i.readBool())i.readBits(8),i.readBits(8),i.readBits(8);var B=1,x=1;if(U){i.readBits(1),B=1,x=1}else{if(i.readBits(1),0==a)B=1,x=1;else if(1==a)B=0,x=0;else{if(12==w)if(i.readBits(1))i.readBits(1);else;else B=1,x=0}if(B&&x)i.readBits(2);i.readBits(1)}i.readBool();i.destroy(),i=null;return{codec_mimetype:"av01.".concat(a,".").concat(e.getLevelString(S,A),".").concat(w.toString(10).padStart(2,"0")),level:S,tier:A,level_string:e.getLevelString(S,A),profile_idc:a,profile_string:"".concat(a),bit_depth:w,ref_frames:1,chroma_format:e.getChromaFormat(U,B,x),chroma_format_string:e.getChromaFormatString(U,B,x),sequence_header:{frame_id_numbers_present_flag:O,additional_frame_id_length_minus_1:void 0,delta_frame_id_length_minus_2:void 0,reduced_still_picture_header:n,decoder_model_info_present_flag:!1,operating_points:d,buffer_removal_time_length_minus_1:_,equal_picture_interval:r,seq_force_screen_content_tools:D,seq_force_integer_mv:L,enable_order_hint:C,order_hint_bits:P,enable_superres:k,frame_width_bit:R+1,frame_height_bit:b+1,max_frame_width:I,max_frame_height:M},keyframe:void 0,frame_rate:{fixed:r,fps:o/s,fps_den:s,fps_num:o}}},e.parseOBUFrameHeader=function(t,i,a,n){var r=n.sequence_header,o=new f(t),s=(r.max_frame_width,r.max_frame_height,0);r.frame_id_numbers_present_flag&&(s=r.additional_frame_id_length_minus_1+r.delta_frame_id_length_minus_2+3);var _=0,d=!0,c=!0,u=!1;if(!r.reduced_still_picture_header){if(o.readBool())return n;d=2===(_=o.readBits(2))||0===_,(c=o.readBool())&&r.decoder_model_info_present_flag&&r.equal_picture_interval,c?o.readBool():0!==_,u=!!(3===_||0===_&&c)||o.readBool()}n.keyframe=d;o.readBool();var l=r.seq_force_screen_content_tools;2===r.seq_force_screen_content_tools&&(l=o.readBits(1));l&&(r.seq_force_integer_mv,2==r.seq_force_integer_mv&&o.readBits(1));r.frame_id_numbers_present_flag&&o.readBits(s);var h=!1;h=3==_||!r.reduced_still_picture_header&&o.readBool();o.readBits(r.order_hint_bits);if((d||u||o.readBits(3),r.decoder_model_info_present_flag)&&o.readBool())for(var p=0;p<=r.operating_points_cnt_minus_1;p++)if(r.operating_points[p].decoder_model_present_for_this_op[p]){var m=r.operating_points[p].operating_point_idc;(0===m||m>>i&1&&m>>a+8&1)&&o.readBits(r.buffer_removal_time_length_minus_1+1)}var g=255;if(3===_||0==_&&c||(g=o.readBits(8)),(d||255!==g)&&u&&r.enable_order_hint)for(var v=0;v<8;v++)o.readBits(r.order_hint_bits);if(d){var E=e.frameSizeAndRenderSize(o,h,r);n.codec_size={width:E.FrameWidth,height:E.FrameHeight},n.present_size={width:E.RenderWidth,height:E.RenderHeight},n.sar_ratio={width:E.RenderWidth/E.FrameWidth,height:E.RenderHeight/E.FrameHeight}}return o.destroy(),o=null,n},e.frameSizeAndRenderSize=function(e,t,i){var a=i.max_frame_width,n=i.max_frame_height;t&&(a=e.readBits(i.frame_width_bit)+1,n=e.readBits(i.frame_height_bit)+1);var r=!1;i.enable_superres&&(r=e.readBool());var o=8;r&&(o=e.readBits(3)+9);var s=a;a=Math.floor((8*s+o/2)/o);var _=s,d=n;if(e.readBool()){var c=e.readBits(16)+1,u=e.readBits(16)+1;_=e.readBits(c)+1,d=e.readBits(u)+1}return{UpscaledWidth:s,FrameWidth:a,FrameHeight:n,RenderWidth:_,RenderHeight:d}},e.getLevelString=function(e,t){return"".concat(e.toString(10).padStart(2,"0")).concat(0===t?"M":"H")},e.getChromaFormat=function(e,t,i){return e?0:0===t&&0===i?3:1===t&&0===i?2:1===t&&1===i?1:Number.NaN},e.getChromaFormatString=function(e,t,i){return e?"4:0:0":0===t&&0===i?"4:4:4":1===t&&0===i?"4:2:2":1===t&&1===i?"4:2:0":"Unknown"},e}();var R,b=function(){function e(e,t){this.TAG="FLVDemuxer",this._config=t,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=e.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=e.hasAudioTrack,this._hasVideo=e.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new s.a,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=function(){var e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),256===new Int16Array(e)[0]}()}return e.prototype.destroy=function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null},e.probe=function(e){var t=new Uint8Array(e);if(t.byteLength<9)return{needMoreData:!0};var i={match:!1};if(70!==t[0]||76!==t[1]||86!==t[2]||1!==t[3])return i;var a,n,r=(4&t[4])>>>2!=0,o=0!=(1&t[4]),s=(a=t)[n=5]<<24|a[n+1]<<16|a[n+2]<<8|a[n+3];return s<9?i:{match:!0,consumed:s,dataOffset:s,hasAudioTrack:r,hasVideoTrack:o}},e.prototype.bindDataSource=function(e){return e.onDataArrival=this.parseChunks.bind(this),this},Object.defineProperty(e.prototype,"onTrackMetadata",{get:function(){return this._onTrackMetadata},set:function(e){this._onTrackMetadata=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onMediaInfo",{get:function(){return this._onMediaInfo},set:function(e){this._onMediaInfo=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onMetaDataArrived",{get:function(){return this._onMetaDataArrived},set:function(e){this._onMetaDataArrived=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onScriptDataArrived",{get:function(){return this._onScriptDataArrived},set:function(e){this._onScriptDataArrived=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onError",{get:function(){return this._onError},set:function(e){this._onError=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onDataAvailable",{get:function(){return this._onDataAvailable},set:function(e){this._onDataAvailable=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timestampBase",{get:function(){return this._timestampBase},set:function(e){this._timestampBase=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"overridedDuration",{get:function(){return this._duration},set:function(e){this._durationOverrided=!0,this._duration=e,this._mediaInfo.duration=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"overridedHasAudio",{set:function(e){this._hasAudioFlagOverrided=!0,this._hasAudio=e,this._mediaInfo.hasAudio=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"overridedHasVideo",{set:function(e){this._hasVideoFlagOverrided=!0,this._hasVideo=e,this._mediaInfo.hasVideo=e},enumerable:!1,configurable:!0}),e.prototype.resetMediaInfo=function(){this._mediaInfo=new s.a},e.prototype._isInitialMetadataDispatched=function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!(this._hasAudio||!this._hasVideo)&&this._videoInitialMetadataDispatched},e.prototype.parseChunks=function(t,i){if(!(this._onError&&this._onMediaInfo&&this._onTrackMetadata&&this._onDataAvailable))throw new u.a("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var a=0,n=this._littleEndian;if(0===i){if(!(t.byteLength>13))return 0;a=e.probe(t).dataOffset}this._firstParse&&(this._firstParse=!1,i+a!==this._dataOffset&&r.a.w(this.TAG,"First time parsing but chunk byteStart invalid!"),0!==(o=new DataView(t,a)).getUint32(0,!n)&&r.a.w(this.TAG,"PrevTagSize0 !== 0 !!!"),a+=4);for(;a<t.byteLength;){this._dispatch=!0;var o=new DataView(t,a);if(a+11+4>t.byteLength)break;var s=o.getUint8(0),_=16777215&o.getUint32(0,!n);if(a+11+_+4>t.byteLength)break;if(8===s||9===s||18===s){var d=o.getUint8(4),c=o.getUint8(5),l=o.getUint8(6)|c<<8|d<<16|o.getUint8(7)<<24;0!==(16777215&o.getUint32(7,!n))&&r.a.w(this.TAG,"Meet tag which has StreamID != 0!");var h=a+11;switch(s){case 8:this._parseAudioData(t,h,_,l);break;case 9:this._parseVideoData(t,h,_,l,i+a);break;case 18:this._parseScriptData(t,h,_)}var f=o.getUint32(11+_,!n);f!==11+_&&r.a.w(this.TAG,"Invalid PrevTagSize ".concat(f)),a+=11+_+4}else r.a.w(this.TAG,"Unsupported tag type ".concat(s,", skipped")),a+=11+_+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),a},e.prototype._parseScriptData=function(e,t,i){var a=h.parseScriptData(e,t,i);if(a.hasOwnProperty("onMetaData")){if(null==a.onMetaData||"object"!=typeof a.onMetaData)return void r.a.w(this.TAG,"Invalid onMetaData structure!");this._metadata&&r.a.w(this.TAG,"Found another onMetaData tag!"),this._metadata=a;var n=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},n)),"boolean"==typeof n.hasAudio&&!1===this._hasAudioFlagOverrided&&(this._hasAudio=n.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),"boolean"==typeof n.hasVideo&&!1===this._hasVideoFlagOverrided&&(this._hasVideo=n.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),"number"==typeof n.audiodatarate&&(this._mediaInfo.audioDataRate=n.audiodatarate),"number"==typeof n.videodatarate&&(this._mediaInfo.videoDataRate=n.videodatarate),"number"==typeof n.width&&(this._mediaInfo.width=n.width),"number"==typeof n.height&&(this._mediaInfo.height=n.height),"number"==typeof n.duration){if(!this._durationOverrided){var o=Math.floor(n.duration*this._timescale);this._duration=o,this._mediaInfo.duration=o}}else this._mediaInfo.duration=0;if("number"==typeof n.framerate){var s=Math.floor(1e3*n.framerate);if(s>0){var _=s/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=_,this._referenceFrameRate.fps_num=s,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=_}}if("object"==typeof n.keyframes){this._mediaInfo.hasKeyframesIndex=!0;var d=n.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(d),n.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=n,r.a.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(a).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},a))},e.prototype._parseKeyframesIndex=function(e){for(var t=[],i=[],a=1;a<e.times.length;a++){var n=this._timestampBase+Math.floor(1e3*e.times[a]);t.push(n),i.push(e.filepositions[a])}return{times:t,filepositions:i}},e.prototype._parseAudioData=function(e,t,i,a){if(i<=1)r.a.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");else if(!0!==this._hasAudioFlagOverrided||!1!==this._hasAudio){this._littleEndian;var n=new DataView(e,t,i).getUint8(0),o=n>>>4;if(9!==o)if(2===o||10===o){var s=0,_=(12&n)>>>2;if(_>=0&&_<=4){s=this._flvSoundRateTable[_];var d=1&n,c=this._audioMetadata,u=this._audioTrack;if(c||(!1===this._hasAudio&&!1===this._hasAudioFlagOverrided&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),(c=this._audioMetadata={}).type="audio",c.id=u.id,c.timescale=this._timescale,c.duration=this._duration,c.audioSampleRate=s,c.channelCount=0===d?1:2),10===o){var l=this._parseAACAudioData(e,t+1,i-1);if(null==l)return;if(0===l.packetType){if(c.config){if(T(l.data.config,c.config))return;r.a.w(this.TAG,"AudioSpecificConfig has been changed, re-generate initialization segment")}var h=l.data;c.audioSampleRate=h.samplingRate,c.channelCount=h.channelCount,c.codec=h.codec,c.originalCodec=h.originalCodec,c.config=h.config,c.refSampleDuration=1024/c.audioSampleRate*c.timescale,r.a.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",c),(g=this._mediaInfo).audioCodec=c.originalCodec,g.audioSampleRate=c.audioSampleRate,g.audioChannelCount=c.channelCount,g.hasVideo?null!=g.videoCodec&&(g.mimeType='video/x-flv; codecs="'+g.videoCodec+","+g.audioCodec+'"'):g.mimeType='video/x-flv; codecs="'+g.audioCodec+'"',g.isComplete()&&this._onMediaInfo(g)}else if(1===l.packetType){var f=this._timestampBase+a,p={unit:l.data,length:l.data.byteLength,dts:f,pts:f};u.samples.push(p),u.length+=l.data.length}else r.a.e(this.TAG,"Flv: Unsupported AAC data type ".concat(l.packetType))}else if(2===o){if(!c.codec){var g;if(null==(h=this._parseMP3AudioData(e,t+1,i-1,!0)))return;c.audioSampleRate=h.samplingRate,c.channelCount=h.channelCount,c.codec=h.codec,c.originalCodec=h.originalCodec,c.refSampleDuration=1152/c.audioSampleRate*c.timescale,r.a.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",c),(g=this._mediaInfo).audioCodec=c.codec,g.audioSampleRate=c.audioSampleRate,g.audioChannelCount=c.channelCount,g.audioDataRate=h.bitRate,g.hasVideo?null!=g.videoCodec&&(g.mimeType='video/x-flv; codecs="'+g.videoCodec+","+g.audioCodec+'"'):g.mimeType='video/x-flv; codecs="'+g.audioCodec+'"',g.isComplete()&&this._onMediaInfo(g)}var v=this._parseMP3AudioData(e,t+1,i-1,!1);if(null==v)return;f=this._timestampBase+a;var E={unit:v,length:v.byteLength,dts:f,pts:f};u.samples.push(E),u.length+=v.length}}else this._onError(m.a.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+_)}else this._onError(m.a.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+o);else{if(i<=5)return void r.a.w(this.TAG,"Flv: Invalid audio packet, missing AudioFourCC in Ehnanced FLV payload!");var y=15&n,S=String.fromCharCode.apply(String,new Uint8Array(e,t,i).slice(1,5));switch(S){case"Opus":this._parseOpusAudioPacket(e,t+5,i-5,a,y);break;case"fLaC":this._parseFlacAudioPacket(e,t+5,i-5,a,y);break;default:this._onError(m.a.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec: "+S)}}}},e.prototype._parseAACAudioData=function(e,t,i){if(!(i<=1)){var a={},n=new Uint8Array(e,t,i);return a.packetType=n[0],0===n[0]?a.data=this._parseAACAudioSpecificConfig(e,t+1,i-1):a.data=n.subarray(1),a}r.a.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!")},e.prototype._parseAACAudioSpecificConfig=function(e,t,i){var a,n,r=new Uint8Array(e,t,i),o=null,s=0,_=null;if(s=a=r[0]>>>3,(n=(7&r[0])<<1|r[1]>>>7)<0||n>=this._mpegSamplingRates.length)this._onError(m.a.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");else{var d=this._mpegSamplingRates[n],c=(120&r[1])>>>3;if(!(c<0||c>=8)){5===s&&(_=(7&r[1])<<1|r[2]>>>7,(124&r[2])>>>2);var u=self.navigator.userAgent.toLowerCase();return-1!==u.indexOf("firefox")?n>=6?(s=5,o=new Array(4),_=n-3):(s=2,o=new Array(2),_=n):-1!==u.indexOf("android")?(s=2,o=new Array(2),_=n):(s=5,_=n,o=new Array(4),n>=6?_=n-3:1===c&&(s=2,o=new Array(2),_=n)),o[0]=s<<3,o[0]|=(15&n)>>>1,o[1]=(15&n)<<7,o[1]|=(15&c)<<3,5===s&&(o[1]|=(15&_)>>>1,o[2]=(1&_)<<7,o[2]|=8,o[3]=0),{config:o,samplingRate:d,channelCount:c,codec:"mp4a.40."+s,originalCodec:"mp4a.40."+a}}this._onError(m.a.FORMAT_ERROR,"Flv: AAC invalid channel configuration")}},e.prototype._parseMP3AudioData=function(e,t,i,a){if(!(i<4)){this._littleEndian;var n=new Uint8Array(e,t,i),o=null;if(a){if(255!==n[0])return;var s=n[1]>>>3&3,_=(6&n[1])>>1,d=(240&n[2])>>>4,c=(12&n[2])>>>2,u=3!==(n[3]>>>6&3)?2:1,l=0,h=0;switch(s){case 0:l=this._mpegAudioV25SampleRateTable[c];break;case 2:l=this._mpegAudioV20SampleRateTable[c];break;case 3:l=this._mpegAudioV10SampleRateTable[c]}switch(_){case 1:34,d<this._mpegAudioL3BitRateTable.length&&(h=this._mpegAudioL3BitRateTable[d]);break;case 2:33,d<this._mpegAudioL2BitRateTable.length&&(h=this._mpegAudioL2BitRateTable[d]);break;case 3:32,d<this._mpegAudioL1BitRateTable.length&&(h=this._mpegAudioL1BitRateTable[d])}o={bitRate:h,samplingRate:l,channelCount:u,codec:"mp3",originalCodec:"mp3"}}else o=n;return o}r.a.w(this.TAG,"Flv: Invalid MP3 packet, header missing!")},e.prototype._parseOpusAudioPacket=function(e,t,i,a,n){if(0===n)this._parseOpusSequenceHeader(e,t,i);else if(1===n)this._parseOpusAudioData(e,t,i,a);else if(2!==n)return void this._onError(m.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(n))},e.prototype._parseOpusSequenceHeader=function(e,t,i){if(i<=16)r.a.w(this.TAG,"Flv: Invalid OpusSequenceHeader, lack of data!");else{var a=this._audioMetadata,n=this._audioTrack;a||(!1===this._hasAudio&&!1===this._hasAudioFlagOverrided&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),(a=this._audioMetadata={}).type="audio",a.id=n.id,a.timescale=this._timescale,a.duration=this._duration);var o=new DataView(e,t,i);o.setUint8(8,0);var s=o.getUint8(9);o.setUint16(10,o.getUint16(10,!0),!1);var _=o.getUint32(12,!0);o.setUint32(12,o.getUint32(12,!0),!1);var d={config:new Uint8Array(e,t+8,i-8),channelCount:s,samplingFrequence:_,codec:"opus",originalCodec:"opus"};if(a.config){if(T(d.config,a.config))return;r.a.w(this.TAG,"OpusSequenceHeader has been changed, re-generate initialization segment")}a.audioSampleRate=d.samplingFrequence,a.channelCount=d.channelCount,a.codec=d.codec,a.originalCodec=d.originalCodec,a.config=d.config,a.refSampleDuration=20,r.a.v(this.TAG,"Parsed OpusSequenceHeader"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",a);var c=this._mediaInfo;c.audioCodec=a.originalCodec,c.audioSampleRate=a.audioSampleRate,c.audioChannelCount=a.channelCount,c.hasVideo?null!=c.videoCodec&&(c.mimeType='video/x-flv; codecs="'+c.videoCodec+","+c.audioCodec+'"'):c.mimeType='video/x-flv; codecs="'+c.audioCodec+'"',c.isComplete()&&this._onMediaInfo(c)}},e.prototype._parseOpusAudioData=function(e,t,i,a){var n=this._audioTrack,r=new Uint8Array(e,t,i),o=this._timestampBase+a,s={unit:r,length:r.byteLength,dts:o,pts:o};n.samples.push(s),n.length+=r.length},e.prototype._parseFlacAudioPacket=function(e,t,i,a,n){if(0===n)this._parseFlacSequenceHeader(e,t,i);else if(1===n)this._parseFlacAudioData(e,t,i,a);else if(2!==n)return void this._onError(m.a.FORMAT_ERROR,"Flv: Invalid Flac audio packet type ".concat(n))},e.prototype._parseFlacSequenceHeader=function(e,t,i){var a=this._audioMetadata,n=this._audioTrack;a||(!1===this._hasAudio&&!1===this._hasAudioFlagOverrided&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),(a=this._audioMetadata={}).type="audio",a.id=n.id,a.timescale=this._timescale,a.duration=this._duration);var o=new Uint8Array(e,t+4,i-4),s=new f(o),_=s.readBits(16),d=s.readBits(16),c=d===_?d:null;s.readBits(24),s.readBits(24);var u=s.readBits(20),l=s.readBits(3)+1,h=s.readBits(5)+1;s.destroy();var p=new Uint8Array(o.byteLength+4);p.set(o,4),p[0]=128,p[1]=o.byteLength>>>16&255,p[2]=o.byteLength>>>8&255,p[3]=o.byteLength>>>0&255;var m={config:p,channelCount:l,samplingFrequence:u,sampleSize:h,codec:"flac",originalCodec:"flac"};if(a.config){if(T(m.config,a.config))return;r.a.w(this.TAG,"FlacSequenceHeader has been changed, re-generate initialization segment")}a.audioSampleRate=m.samplingFrequence,a.channelCount=m.channelCount,a.sampleSize=m.sampleSize,a.codec=m.codec,a.originalCodec=m.originalCodec,a.config=m.config,a.refSampleDuration=null!=c?1e3*c/m.samplingFrequence:null,r.a.v(this.TAG,"Parsed FlacSequenceHeader"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",a);var g=this._mediaInfo;g.audioCodec=a.originalCodec,g.audioSampleRate=a.audioSampleRate,g.audioChannelCount=a.channelCount,g.hasVideo?null!=g.videoCodec&&(g.mimeType='video/x-flv; codecs="'+g.videoCodec+","+g.audioCodec+'"'):g.mimeType='video/x-flv; codecs="'+g.audioCodec+'"',g.isComplete()&&this._onMediaInfo(g)},e.prototype._parseFlacAudioData=function(e,t,i,a){var n=this._audioTrack,r=new Uint8Array(e,t,i),o=this._timestampBase+a,s={unit:r,length:r.byteLength,dts:o,pts:o};n.samples.push(s),n.length+=r.length},e.prototype._parseVideoData=function(e,t,i,a,n){if(i<=1)r.a.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");else if(!0!==this._hasVideoFlagOverrided||!1!==this._hasVideo){var o=new Uint8Array(e,t,i)[0],s=(112&o)>>>4;if(0!=(128&o)){var _=15&o,d=String.fromCharCode.apply(String,new Uint8Array(e,t,i).slice(1,5));if("hvc1"===d)this._parseEnhancedHEVCVideoPacket(e,t+5,i-5,a,n,s,_);else{if("av01"!==d)return void this._onError(m.a.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: ".concat(d));this._parseEnhancedAV1VideoPacket(e,t+5,i-5,a,n,s,_)}}else{var c=15&o;if(7===c)this._parseAVCVideoPacket(e,t+1,i-1,a,n,s);else{if(12!==c)return void this._onError(m.a.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: ".concat(c));this._parseHEVCVideoPacket(e,t+1,i-1,a,n,s)}}}},e.prototype._parseAVCVideoPacket=function(e,t,i,a,n,o){if(i<4)r.a.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");else{var s=this._littleEndian,_=new DataView(e,t,i),d=_.getUint8(0),c=(16777215&_.getUint32(0,!s))<<8>>8;if(0===d)this._parseAVCDecoderConfigurationRecord(e,t+4,i-4);else if(1===d)this._parseAVCVideoData(e,t+4,i-4,a,n,o,c);else if(2!==d)return void this._onError(m.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(d))}},e.prototype._parseHEVCVideoPacket=function(e,t,i,a,n,o){if(i<4)r.a.w(this.TAG,"Flv: Invalid HEVC packet, missing HEVCPacketType or/and CompositionTime");else{var s=this._littleEndian,_=new DataView(e,t,i),d=_.getUint8(0),c=(16777215&_.getUint32(0,!s))<<8>>8;if(0===d)this._parseHEVCDecoderConfigurationRecord(e,t+4,i-4);else if(1===d)this._parseHEVCVideoData(e,t+4,i-4,a,n,o,c);else if(2!==d)return void this._onError(m.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(d))}},e.prototype._parseEnhancedHEVCVideoPacket=function(e,t,i,a,n,r,o){var s=this._littleEndian,_=new DataView(e,t,i);if(0===o)this._parseHEVCDecoderConfigurationRecord(e,t,i);else if(1===o){var d=(4294967040&_.getUint32(0,!s))>>8;this._parseHEVCVideoData(e,t+3,i-3,a,n,r,d)}else if(3===o)this._parseHEVCVideoData(e,t,i,a,n,r,0);else if(2!==o)return void this._onError(m.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(o))},e.prototype._parseEnhancedAV1VideoPacket=function(e,t,i,a,n,r,o){this._littleEndian,new DataView(e,t,i);if(0===o)this._parseAV1CodecConfigurationRecord(e,t,i);else if(1===o)this._parseAV1VideoData(e,t,i,a,n,r,0);else{if(5===o)return void this._onError(m.a.FORMAT_ERROR,"Flv: Not Supported MP2T AV1 video packet type ".concat(o));if(2!==o)return void this._onError(m.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(o))}},e.prototype._parseAVCDecoderConfigurationRecord=function(e,t,i){if(i<7)r.a.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");else{var a=this._videoMetadata,n=this._videoTrack,o=this._littleEndian,s=new DataView(e,t,i);if(a){if(void 0!==a.avcc){var _=new Uint8Array(e,t,i);if(T(_,a.avcc))return;r.a.w(this.TAG,"AVCDecoderConfigurationRecord has been changed, re-generate initialization segment")}}else!1===this._hasVideo&&!1===this._hasVideoFlagOverrided&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(a=this._videoMetadata={}).type="video",a.id=n.id,a.timescale=this._timescale,a.duration=this._duration;var d=s.getUint8(0),c=s.getUint8(1);s.getUint8(2),s.getUint8(3);if(1===d&&0!==c)if(this._naluLengthSize=1+(3&s.getUint8(4)),3===this._naluLengthSize||4===this._naluLengthSize){var u=31&s.getUint8(5);if(0!==u){u>1&&r.a.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = ".concat(u));for(var l=6,h=0;h<u;h++){var f=s.getUint16(l,!o);if(l+=2,0!==f){var g=new Uint8Array(e,t+l,f);l+=f;var v=p.parseSPS(g);if(0===h){a.codecWidth=v.codec_size.width,a.codecHeight=v.codec_size.height,a.presentWidth=v.present_size.width,a.presentHeight=v.present_size.height,a.profile=v.profile_string,a.level=v.level_string,a.bitDepth=v.bit_depth,a.chromaFormat=v.chroma_format,a.sarRatio=v.sar_ratio,a.frameRate=v.frame_rate,!1!==v.frame_rate.fixed&&0!==v.frame_rate.fps_num&&0!==v.frame_rate.fps_den||(a.frameRate=this._referenceFrameRate);var E=a.frameRate.fps_den,y=a.frameRate.fps_num;a.refSampleDuration=a.timescale*(E/y);for(var S=g.subarray(1,4),A="avc1.",R=0;R<3;R++){var b=S[R].toString(16);b.length<2&&(b="0"+b),A+=b}a.codec=A;var I=this._mediaInfo;I.width=a.codecWidth,I.height=a.codecHeight,I.fps=a.frameRate.fps,I.profile=a.profile,I.level=a.level,I.refFrames=v.ref_frames,I.chromaFormat=v.chroma_format_string,I.sarNum=a.sarRatio.width,I.sarDen=a.sarRatio.height,I.videoCodec=A,I.hasAudio?null!=I.audioCodec&&(I.mimeType='video/x-flv; codecs="'+I.videoCodec+","+I.audioCodec+'"'):I.mimeType='video/x-flv; codecs="'+I.videoCodec+'"',I.isComplete()&&this._onMediaInfo(I)}}}var M=s.getUint8(l);if(0!==M){M>1&&r.a.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = ".concat(M)),l++;for(h=0;h<M;h++){f=s.getUint16(l,!o);l+=2,0!==f&&(l+=f)}a.avcc=new Uint8Array(i),a.avcc.set(new Uint8Array(e,t,i),0),r.a.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",a)}else this._onError(m.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS")}else this._onError(m.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS")}else this._onError(m.a.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: ".concat(this._naluLengthSize-1));else this._onError(m.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord")}},e.prototype._parseHEVCDecoderConfigurationRecord=function(e,t,i){if(i<22)r.a.w(this.TAG,"Flv: Invalid HEVCDecoderConfigurationRecord, lack of data!");else{var a=this._videoMetadata,n=this._videoTrack,o=this._littleEndian,s=new DataView(e,t,i);if(a){if(void 0!==a.hvcc){var _=new Uint8Array(e,t,i);if(T(_,a.hvcc))return;r.a.w(this.TAG,"HEVCDecoderConfigurationRecord has been changed, re-generate initialization segment")}}else!1===this._hasVideo&&!1===this._hasVideoFlagOverrided&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(a=this._videoMetadata={}).type="video",a.id=n.id,a.timescale=this._timescale,a.duration=this._duration;var d=s.getUint8(0),c=31&s.getUint8(1);if(0!==d&&1!==d||0===c)this._onError(m.a.FORMAT_ERROR,"Flv: Invalid HEVCDecoderConfigurationRecord");else if(this._naluLengthSize=1+(3&s.getUint8(21)),3===this._naluLengthSize||4===this._naluLengthSize){for(var u=s.getUint8(22),l=0,h=23;l<u;l++){var f=63&s.getUint8(h+0),p=s.getUint16(h+1,!o);h+=3;for(var v=0;v<p;v++){var E=s.getUint16(h+0,!o);if(0===v)if(33===f){h+=2;var y=new Uint8Array(e,t+h,E),S=g.parseSPS(y);a.codecWidth=S.codec_size.width,a.codecHeight=S.codec_size.height,a.presentWidth=S.present_size.width,a.presentHeight=S.present_size.height,a.profile=S.profile_string,a.level=S.level_string,a.bitDepth=S.bit_depth,a.chromaFormat=S.chroma_format,a.sarRatio=S.sar_ratio,a.frameRate=S.frame_rate,!1!==S.frame_rate.fixed&&0!==S.frame_rate.fps_num&&0!==S.frame_rate.fps_den||(a.frameRate=this._referenceFrameRate);var A=a.frameRate.fps_den,R=a.frameRate.fps_num;a.refSampleDuration=a.timescale*(A/R),a.codec=S.codec_mimetype;var b=this._mediaInfo;b.width=a.codecWidth,b.height=a.codecHeight,b.fps=a.frameRate.fps,b.profile=a.profile,b.level=a.level,b.refFrames=S.ref_frames,b.chromaFormat=S.chroma_format_string,b.sarNum=a.sarRatio.width,b.sarDen=a.sarRatio.height,b.videoCodec=S.codec_mimetype,b.hasAudio?null!=b.audioCodec&&(b.mimeType='video/x-flv; codecs="'+b.videoCodec+","+b.audioCodec+'"'):b.mimeType='video/x-flv; codecs="'+b.videoCodec+'"',b.isComplete()&&this._onMediaInfo(b),h+=E}else h+=2+E;else h+=2+E}}a.hvcc=new Uint8Array(i),a.hvcc.set(new Uint8Array(e,t,i),0),r.a.v(this.TAG,"Parsed HEVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",a)}else this._onError(m.a.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: ".concat(this._naluLengthSize-1))}},e.prototype._parseAV1CodecConfigurationRecord=function(e,t,i){if(i<4)r.a.w(this.TAG,"Flv: Invalid AV1CodecConfigurationRecord, lack of data!");else{var a=this._videoMetadata,n=this._videoTrack,o=(this._littleEndian,new DataView(e,t,i));a?void 0!==a.av1c&&r.a.w(this.TAG,"Found another AV1CodecConfigurationRecord!"):(!1===this._hasVideo&&!1===this._hasVideoFlagOverrided&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(a=this._videoMetadata={}).type="video",a.id=n.id,a.timescale=this._timescale,a.duration=this._duration);var s=127&o.getUint8(0);o.getUint8(1),o.getUint8(1),o.getUint8(2);if(1===s){var _=A.parseOBUs(new Uint8Array(e,t+4,i-4));if(null!=_){a.profile=_.profile_string,a.level=_.level_string,a.bitDepth=_.bit_depth,a.chromaFormat=_.chroma_format,a.frameRate=_.frame_rate,!1!==_.frame_rate.fixed&&0!==_.frame_rate.fps_num&&0!==_.frame_rate.fps_den||(a.frameRate=this._referenceFrameRate);var d=a.frameRate.fps_den,c=a.frameRate.fps_num;a.refSampleDuration=a.timescale*(d/c),a.codec=_.codec_mimetype,a.extra=_;var u=this._mediaInfo;u.fps=a.frameRate.fps,u.profile=a.profile,u.level=a.level,u.refFrames=_.ref_frames,u.chromaFormat=_.chroma_format_string,u.videoCodec=_.codec_mimetype,u.hasAudio?null!=u.audioCodec&&(u.mimeType='video/x-flv; codecs="'+u.videoCodec+","+u.audioCodec+'"'):u.mimeType='video/x-flv; codecs="'+u.videoCodec+'"',u.isComplete()&&this._onMediaInfo(u),a.av1c=new Uint8Array(i),a.av1c.set(new Uint8Array(e,t,i),0),r.a.v(this.TAG,"Preparing AV1CodecConfigurationRecord")}else this._onError(m.a.FORMAT_ERROR,"Flv: Invalid AV1CodecConfigurationRecord")}else this._onError(m.a.FORMAT_ERROR,"Flv: Invalid AV1CodecConfigurationRecord")}},e.prototype._parseAVCVideoData=function(e,t,i,a,n,o,s){for(var _=this._littleEndian,d=new DataView(e,t,i),c=[],u=0,l=0,h=this._naluLengthSize,f=this._timestampBase+a,p=1===o;l<i;){if(l+4>=i){r.a.w(this.TAG,"Malformed Nalu near timestamp ".concat(f,", offset = ").concat(l,", dataSize = ").concat(i));break}var m=d.getUint32(l,!_);if(3===h&&(m>>>=8),m>i-h)return void r.a.w(this.TAG,"Malformed Nalus near timestamp ".concat(f,", NaluSize > DataSize!"));var g=31&d.getUint8(l+h);5===g&&(p=!0);var v=new Uint8Array(e,t+l,h+m),E={type:g,data:v};c.push(E),u+=v.byteLength,l+=h+m}if(c.length){var y=this._videoTrack,T={units:c,length:u,isKeyframe:p,dts:f,cts:s,pts:f+s};p&&(T.fileposition=n),y.samples.push(T),y.length+=u}},e.prototype._parseHEVCVideoData=function(e,t,i,a,n,o,s){for(var _=this._littleEndian,d=new DataView(e,t,i),c=[],u=0,l=0,h=this._naluLengthSize,f=this._timestampBase+a,p=1===o;l<i;){if(l+4>=i){r.a.w(this.TAG,"Malformed Nalu near timestamp ".concat(f,", offset = ").concat(l,", dataSize = ").concat(i));break}var m=d.getUint32(l,!_);if(3===h&&(m>>>=8),m>i-h)return void r.a.w(this.TAG,"Malformed Nalus near timestamp ".concat(f,", NaluSize > DataSize!"));var g=d.getUint8(l+h)>>1&63;19!==g&&20!==g&&21!==g||(p=!0);var v=new Uint8Array(e,t+l,h+m),E={type:g,data:v};c.push(E),u+=v.byteLength,l+=h+m}if(c.length){var y=this._videoTrack,T={units:c,length:u,isKeyframe:p,dts:f,cts:s,pts:f+s};p&&(T.fileposition=n),y.samples.push(T),y.length+=u}},e.prototype._parseAV1VideoData=function(e,t,i,a,n,o,s){this._littleEndian,new DataView(e,t,i);var _,d=[],c=this._timestampBase+a,u=1===o;if(u){var l=this._videoMetadata,h=A.parseOBUs(new Uint8Array(e,t,i),l.extra);if(null==h)return void this._onError(m.a.FORMAT_ERROR,"Flv: Invalid AV1 VideoData");console.log(h),l.codecWidth=h.codec_size.width,l.codecHeight=h.codec_size.height,l.presentWidth=h.present_size.width,l.presentHeight=h.present_size.height,l.sarRatio=h.sar_ratio;var f=this._mediaInfo;f.width=l.codecWidth,f.height=l.codecHeight,f.sarNum=l.sarRatio.width,f.sarDen=l.sarRatio.height,r.a.v(this.TAG,"Parsed AV1DecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",l)}if(_=i,d.push({unitType:0,data:new Uint8Array(e,t+0,i)}),d.length){var p=this._videoTrack,g={units:d,length:_,isKeyframe:u,dts:c,cts:s,pts:c+s};u&&(g.fileposition=n),p.samples.push(g),p.length+=_}},e}(),I=function(){function e(){}return e.prototype.destroy=function(){this.onError=null,this.onMediaInfo=null,this.onMetaDataArrived=null,this.onTrackMetadata=null,this.onDataAvailable=null,this.onTimedID3Metadata=null,this.onSynchronousKLVMetadata=null,this.onAsynchronousKLVMetadata=null,this.onSMPTE2038Metadata=null,this.onSCTE35Metadata=null,this.onPESPrivateData=null,this.onPESPrivateDataDescriptor=null,this.onSystemClock=null,this.onAudioTracksMetadata=null},e.prototype.insertDiscontinuity=function(){},e.prototype.switchAudioTrack=function(e){},e}(),M=function(){this.program_pmt_pid={}};!function(e){e[e.kMPEG1Audio=3]="kMPEG1Audio",e[e.kMPEG2Audio=4]="kMPEG2Audio",e[e.kPESPrivateData=6]="kPESPrivateData",e[e.kADTSAAC=15]="kADTSAAC",e[e.kLOASAAC=17]="kLOASAAC",e[e.kAC3=129]="kAC3",e[e.kEAC3=135]="kEAC3",e[e.kMetadata=21]="kMetadata",e[e.kSCTE35=134]="kSCTE35",e[e.kH264=27]="kH264",e[e.kH265=36]="kH265"}(R||(R={}));var O,C=function(){this.pid_stream_type={},this.common_pids={h264:void 0,h265:void 0,av1:void 0,adts_aac:void 0,loas_aac:void 0,opus:void 0,ac3:void 0,eac3:void 0,mp3:void 0},this.pes_private_data_pids={},this.timed_id3_pids={},this.synchronous_klv_pids={},this.asynchronous_klv_pids={},this.scte_35_pids={},this.smpte2038_pids={}},D=function(){},L=function(){},P=function(){this.slices=[],this.total_length=0,this.expected_length=0,this.file_position=0};!function(e){e[e.kUnspecified=0]="kUnspecified",e[e.kSliceNonIDR=1]="kSliceNonIDR",e[e.kSliceDPA=2]="kSliceDPA",e[e.kSliceDPB=3]="kSliceDPB",e[e.kSliceDPC=4]="kSliceDPC",e[e.kSliceIDR=5]="kSliceIDR",e[e.kSliceSEI=6]="kSliceSEI",e[e.kSliceSPS=7]="kSliceSPS",e[e.kSlicePPS=8]="kSlicePPS",e[e.kSliceAUD=9]="kSliceAUD",e[e.kEndOfSequence=10]="kEndOfSequence",e[e.kEndOfStream=11]="kEndOfStream",e[e.kFiller=12]="kFiller",e[e.kSPSExt=13]="kSPSExt",e[e.kReserved0=14]="kReserved0"}(O||(O={}));var k,N,w=function(){},U=function(e){var t=e.data.byteLength;this.type=e.type,this.data=new Uint8Array(4+t),new DataView(this.data.buffer).setUint32(0,t),this.data.set(e.data,4)},B=function(){function e(e){this.TAG="H264AnnexBParser",this.current_startcode_offset_=0,this.eof_flag_=!1,this.data_=e,this.current_startcode_offset_=this.findNextStartCodeOffset(0),this.eof_flag_&&r.a.e(this.TAG,"Could not find H264 startcode until payload end!")}return e.prototype.findNextStartCodeOffset=function(e){for(var t=e,i=this.data_;;){if(t+3>=i.byteLength)return this.eof_flag_=!0,i.byteLength;var a=i[t+0]<<24|i[t+1]<<16|i[t+2]<<8|i[t+3],n=i[t+0]<<16|i[t+1]<<8|i[t+2];if(1===a||1===n)return t;t++}},e.prototype.readNextNaluPayload=function(){for(var e=this.data_,t=null;null==t&&!this.eof_flag_;){var i=this.current_startcode_offset_,a=31&e[i+=1===(e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3])?4:3],n=(128&e[i])>>>7,r=this.findNextStartCodeOffset(i);if(this.current_startcode_offset_=r,!(a>=O.kReserved0)&&0===n){var o=e.subarray(i,r);(t=new w).type=a,t.data=o}}return t},e}(),x=function(){function e(e,t,i){var a=8+e.byteLength+1+2+t.byteLength,n=!1;66!==e[3]&&77!==e[3]&&88!==e[3]&&(n=!0,a+=4);var r=this.data=new Uint8Array(a);r[0]=1,r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=255,r[5]=225;var o=e.byteLength;r[6]=o>>>8,r[7]=255&o;var s=8;r.set(e,8),r[s+=o]=1;var _=t.byteLength;r[s+1]=_>>>8,r[s+2]=255&_,r.set(t,s+3),s+=3+_,n&&(r[s]=252|i.chroma_format_idc,r[s+1]=248|i.bit_depth_luma-8,r[s+2]=248|i.bit_depth_chroma-8,r[s+3]=0,s+=4)}return e.prototype.getData=function(){return this.data},e}();!function(e){e[e.kNull=0]="kNull",e[e.kAACMain=1]="kAACMain",e[e.kAAC_LC=2]="kAAC_LC",e[e.kAAC_SSR=3]="kAAC_SSR",e[e.kAAC_LTP=4]="kAAC_LTP",e[e.kAAC_SBR=5]="kAAC_SBR",e[e.kAAC_Scalable=6]="kAAC_Scalable",e[e.kLayer1=32]="kLayer1",e[e.kLayer2=33]="kLayer2",e[e.kLayer3=34]="kLayer3"}(k||(k={})),function(e){e[e.k96000Hz=0]="k96000Hz",e[e.k88200Hz=1]="k88200Hz",e[e.k64000Hz=2]="k64000Hz",e[e.k48000Hz=3]="k48000Hz",e[e.k44100Hz=4]="k44100Hz",e[e.k32000Hz=5]="k32000Hz",e[e.k24000Hz=6]="k24000Hz",e[e.k22050Hz=7]="k22050Hz",e[e.k16000Hz=8]="k16000Hz",e[e.k12000Hz=9]="k12000Hz",e[e.k11025Hz=10]="k11025Hz",e[e.k8000Hz=11]="k8000Hz",e[e.k7350Hz=12]="k7350Hz"}(N||(N={}));var V,G=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],F=(V=function(e,t){return(V=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}V(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),H=function(){},Y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return F(t,e),t}(H),j=function(){function e(e){this.TAG="AACADTSParser",this.data_=e,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&r.a.e(this.TAG,"Could not found ADTS syncword until payload end")}return e.prototype.findNextSyncwordOffset=function(e){for(var t=e,i=this.data_;;){if(t+7>=i.byteLength)return this.eof_flag_=!0,i.byteLength;if(4095===(i[t+0]<<8|i[t+1])>>>4)return t;t++}},e.prototype.readNextAACFrame=function(){for(var e=this.data_,t=null;null==t&&!this.eof_flag_;){var i=this.current_syncword_offset_,a=(8&e[i+1])>>>3,n=(6&e[i+1])>>>1,r=1&e[i+1],o=(192&e[i+2])>>>6,s=(60&e[i+2])>>>2,_=(1&e[i+2])<<2|(192&e[i+3])>>>6,d=(3&e[i+3])<<11|e[i+4]<<3|(224&e[i+5])>>>5;e[i+6];if(i+d>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var c=1===r?7:9,u=d-c;i+=c;var l=this.findNextSyncwordOffset(i+u);if(this.current_syncword_offset_=l,(0===a||1===a)&&0===n){var h=e.subarray(i,i+u);(t=new H).audio_object_type=o+1,t.sampling_freq_index=s,t.sampling_frequency=G[s],t.channel_config=_,t.data=h}}return t},e.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},e.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},e}(),q=function(){function e(e){this.TAG="AACLOASParser",this.data_=e,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&r.a.e(this.TAG,"Could not found LOAS syncword until payload end")}return e.prototype.findNextSyncwordOffset=function(e){for(var t=e,i=this.data_;;){if(t+1>=i.byteLength)return this.eof_flag_=!0,i.byteLength;if(695===(i[t+0]<<3|i[t+1]>>>5))return t;t++}},e.prototype.readNextAACFrame=function(e){for(var t=this.data_,i=null;null==i&&!this.eof_flag_;){var a=this.current_syncword_offset_,n=(31&t[a+1])<<8|t[a+2];if(a+3+n>=this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}i=K(t.subarray(a+3,a+3+n),e),this.current_syncword_offset_=this.findNextSyncwordOffset(a+3+n)}return i},e.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},e.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},e}();function z(e){for(var t=e.readBits(2),i=0,a=0;a<=t;a++)i<<=8,i|=e.readByte();return i}function K(e,t){var i="readAudioMuxElement",a=new f(e),n=null;if(a.readBool()){if(null==t)return r.a.w(i,"StreamMuxConfig Missing"),void a.destroy();n=t}else{var o=a.readBool();if(o&&a.readBool())return r.a.e(i,"audioMuxVersionA is Not Supported"),void a.destroy();if(o&&z(a),!a.readBool())return r.a.e(i,"allStreamsSameTimeFraming zero is Not Supported"),void a.destroy();if(0!==a.readBits(6))return r.a.e(i,"more than 2 numSubFrames Not Supported"),void a.destroy();if(0!==a.readBits(4))return r.a.e(i,"more than 2 numProgram Not Supported"),void a.destroy();if(0!==a.readBits(3))return r.a.e(i,"more than 2 numLayer Not Supported"),void a.destroy();var s=o?z(a):0,_=a.readBits(5);s-=5;var d=a.readBits(4);s-=4;var c=a.readBits(4);s-=4,a.readBits(3),(s-=3)>0&&a.readBits(s);var u=a.readBits(3);if(0!==u)return r.a.e(i,"frameLengthType = ".concat(u,". Only frameLengthType = 0 Supported")),void a.destroy();a.readByte();var l=a.readBool();if(l)if(o)z(a);else{for(var h=0;;){h<<=8;var p=a.readBool();if(h+=a.readByte(),!p)break}console.log(h)}a.readBool()&&a.readByte(),(n=new Y).audio_object_type=_,n.sampling_freq_index=d,n.sampling_frequency=G[n.sampling_freq_index],n.channel_config=c,n.other_data_present=l}for(var m=0;;){var g=a.readByte();if(m+=g,255!==g)break}for(var v=new Uint8Array(m),E=0;E<m;E++)v[E]=a.readByte();var y=new Y;return y.audio_object_type=n.audio_object_type,y.sampling_freq_index=n.sampling_freq_index,y.sampling_frequency=G[n.sampling_freq_index],y.channel_config=n.channel_config,y.other_data_present=n.other_data_present,y.data=v,y}var W,X=function(e){var t=null,i=e.audio_object_type,a=e.audio_object_type,n=e.sampling_freq_index,r=e.channel_config,o=0,s=navigator.userAgent.toLowerCase();-1!==s.indexOf("firefox")?n>=6?(a=5,t=new Array(4),o=n-3):(a=2,t=new Array(2),o=n):-1!==s.indexOf("android")?(a=2,t=new Array(2),o=n):(a=5,o=n,t=new Array(4),n>=6?o=n-3:1===r&&(a=2,t=new Array(2),o=n)),t[0]=a<<3,t[0]|=(15&n)>>>1,t[1]=(15&n)<<7,t[1]|=(15&r)<<3,5===a&&(t[1]|=(15&o)>>>1,t[2]=(1&o)<<7,t[2]|=8,t[3]=0),this.config=t,this.sampling_rate=G[n],this.channel_count=r,this.codec_mimetype="mp4a.40."+a,this.original_codec_mimetype="mp4a.40."+i},Q=function(){},Z=function(){};!function(e){e[e.kSpliceNull=0]="kSpliceNull",e[e.kSpliceSchedule=4]="kSpliceSchedule",e[e.kSpliceInsert=5]="kSpliceInsert",e[e.kTimeSignal=6]="kTimeSignal",e[e.kBandwidthReservation=7]="kBandwidthReservation",e[e.kPrivateCommand=255]="kPrivateCommand"}(W||(W={}));var J,$=function(e){var t=e.readBool();return t?(e.readBits(6),{time_specified_flag:t,pts_time:4*e.readBits(31)+e.readBits(2)}):(e.readBits(7),{time_specified_flag:t})},ee=function(e){var t=e.readBool();return e.readBits(6),{auto_return:t,duration:4*e.readBits(31)+e.readBits(2)}},te=function(e,t){var i=t.readBits(8);return e?{component_tag:i}:{component_tag:i,splice_time:$(t)}},ie=function(e){return{component_tag:e.readBits(8),utc_splice_time:e.readBits(32)}},ae=function(e){var t=e.readBits(32),i=e.readBool();e.readBits(7);var a={splice_event_id:t,splice_event_cancel_indicator:i};if(i)return a;if(a.out_of_network_indicator=e.readBool(),a.program_splice_flag=e.readBool(),a.duration_flag=e.readBool(),e.readBits(5),a.program_splice_flag)a.utc_splice_time=e.readBits(32);else{a.component_count=e.readBits(8),a.components=[];for(var n=0;n<a.component_count;n++)a.components.push(ie(e))}return a.duration_flag&&(a.break_duration=ee(e)),a.unique_program_id=e.readBits(16),a.avail_num=e.readBits(8),a.avails_expected=e.readBits(8),a},ne=function(e,t,i,a){return{descriptor_tag:e,descriptor_length:t,identifier:i,provider_avail_id:a.readBits(32)}},re=function(e,t,i,a){var n=a.readBits(8),r=a.readBits(3);a.readBits(5);for(var o="",s=0;s<r;s++)o+=String.fromCharCode(a.readBits(8));return{descriptor_tag:e,descriptor_length:t,identifier:i,preroll:n,dtmf_count:r,DTMF_char:o}},oe=function(e){var t=e.readBits(8);return e.readBits(7),{component_tag:t,pts_offset:4*e.readBits(31)+e.readBits(2)}},se=function(e,t,i,a){var n=a.readBits(32),r=a.readBool();a.readBits(7);var o={descriptor_tag:e,descriptor_length:t,identifier:i,segmentation_event_id:n,segmentation_event_cancel_indicator:r};if(r)return o;if(o.program_segmentation_flag=a.readBool(),o.segmentation_duration_flag=a.readBool(),o.delivery_not_restricted_flag=a.readBool(),o.delivery_not_restricted_flag?a.readBits(5):(o.web_delivery_allowed_flag=a.readBool(),o.no_regional_blackout_flag=a.readBool(),o.archive_allowed_flag=a.readBool(),o.device_restrictions=a.readBits(2)),!o.program_segmentation_flag){o.component_count=a.readBits(8),o.components=[];for(var s=0;s<o.component_count;s++)o.components.push(oe(a))}o.segmentation_duration_flag&&(o.segmentation_duration=a.readBits(40)),o.segmentation_upid_type=a.readBits(8),o.segmentation_upid_length=a.readBits(8);var _=new Uint8Array(o.segmentation_upid_length);for(s=0;s<o.segmentation_upid_length;s++)_[s]=a.readBits(8);return o.segmentation_upid=_.buffer,o.segmentation_type_id=a.readBits(8),o.segment_num=a.readBits(8),o.segments_expected=a.readBits(8),52!==o.segmentation_type_id&&54!==o.segmentation_type_id&&56!==o.segmentation_type_id&&58!==o.segmentation_type_id||(o.sub_segment_num=a.readBits(8),o.sub_segments_expected=a.readBits(8)),o},_e=function(e,t,i,a){return{descriptor_tag:e,descriptor_length:t,identifier:i,TAI_seconds:a.readBits(48),TAI_ns:a.readBits(32),UTC_offset:a.readBits(16)}},de=function(e){return{component_tag:e.readBits(8),ISO_code:String.fromCharCode(e.readBits(8),e.readBits(8),e.readBits(8)),Bit_Stream_Mode:e.readBits(3),Num_Channels:e.readBits(4),Full_Srvc_Audio:e.readBool()}},ce=function(e,t,i,a){for(var n=a.readBits(4),r=[],o=0;o<n;o++)r.push(de(a));return{descriptor_tag:e,descriptor_length:t,identifier:i,audio_count:n,components:r}},ue=function(e){var t=new f(e),i=t.readBits(8),a=t.readBool(),n=t.readBool();t.readBits(2);var r=t.readBits(12),o=t.readBits(8),s=t.readBool(),_=t.readBits(6),d=4*t.readBits(31)+t.readBits(2),c=t.readBits(8),u=t.readBits(12),l=t.readBits(12),h=t.readBits(8),p=null;h===W.kSpliceNull?p={}:h===W.kSpliceSchedule?p=function(e){for(var t=e.readBits(8),i=[],a=0;a<t;a++)i.push(ae(e));return{splice_count:t,events:i}}(t):h===W.kSpliceInsert?p=function(e){var t=e.readBits(32),i=e.readBool();e.readBits(7);var a={splice_event_id:t,splice_event_cancel_indicator:i};if(i)return a;if(a.out_of_network_indicator=e.readBool(),a.program_splice_flag=e.readBool(),a.duration_flag=e.readBool(),a.splice_immediate_flag=e.readBool(),e.readBits(4),a.program_splice_flag&&!a.splice_immediate_flag&&(a.splice_time=$(e)),!a.program_splice_flag){a.component_count=e.readBits(8),a.components=[];for(var n=0;n<a.component_count;n++)a.components.push(te(a.splice_immediate_flag,e))}return a.duration_flag&&(a.break_duration=ee(e)),a.unique_program_id=e.readBits(16),a.avail_num=e.readBits(8),a.avails_expected=e.readBits(8),a}(t):h===W.kTimeSignal?p=function(e){return{splice_time:$(e)}}(t):h===W.kBandwidthReservation?p={}:h===W.kPrivateCommand?p=function(e,t){for(var i=String.fromCharCode(t.readBits(8),t.readBits(8),t.readBits(8),t.readBits(8)),a=new Uint8Array(e-4),n=0;n<e-4;n++)a[n]=t.readBits(8);return{identifier:i,private_data:a.buffer}}(l,t):t.readBits(8*l);for(var m=[],g=t.readBits(16),v=0;v<g;){var E=t.readBits(8),y=t.readBits(8),T=String.fromCharCode(t.readBits(8),t.readBits(8),t.readBits(8),t.readBits(8));0===E?m.push(ne(E,y,T,t)):1===E?m.push(re(E,y,T,t)):2===E?m.push(se(E,y,T,t)):3===E?m.push(_e(E,y,T,t)):4===E?m.push(ce(E,y,T,t)):t.readBits(8*(y-4)),v+=2+y}var S={table_id:i,section_syntax_indicator:a,private_indicator:n,section_length:r,protocol_version:o,encrypted_packet:s,encryption_algorithm:_,pts_adjustment:d,cw_index:c,tier:u,splice_command_length:l,splice_command_type:h,splice_command:p,descriptor_loop_length:g,splice_descriptors:m,E_CRC32:s?t.readBits(32):void 0,CRC32:t.readBits(32)};if(h===W.kSpliceInsert){var A=p;if(A.splice_event_cancel_indicator)return{splice_command_type:h,detail:S,data:e};if(A.program_splice_flag&&!A.splice_immediate_flag){var R=A.duration_flag?A.break_duration.auto_return:void 0,b=A.duration_flag?A.break_duration.duration/90:void 0;return A.splice_time.time_specified_flag?{splice_command_type:h,pts:(d+A.splice_time.pts_time)%Math.pow(2,33),auto_return:R,duraiton:b,detail:S,data:e}:{splice_command_type:h,auto_return:R,duraiton:b,detail:S,data:e}}return{splice_command_type:h,auto_return:R=A.duration_flag?A.break_duration.auto_return:void 0,duraiton:b=A.duration_flag?A.break_duration.duration/90:void 0,detail:S,data:e}}if(h===W.kTimeSignal){var I=p;return I.splice_time.time_specified_flag?{splice_command_type:h,pts:(d+I.splice_time.pts_time)%Math.pow(2,33),detail:S,data:e}:{splice_command_type:h,detail:S,data:e}}return{splice_command_type:h,detail:S,data:e}};!function(e){e[e.kSliceIDR_W_RADL=19]="kSliceIDR_W_RADL",e[e.kSliceIDR_N_LP=20]="kSliceIDR_N_LP",e[e.kSliceCRA_NUT=21]="kSliceCRA_NUT",e[e.kSliceVPS=32]="kSliceVPS",e[e.kSliceSPS=33]="kSliceSPS",e[e.kSlicePPS=34]="kSlicePPS",e[e.kSliceAUD=35]="kSliceAUD"}(J||(J={}));var le=function(){},he=function(e){if(e instanceof Uint8Array)return this.type=e[4]>>1&63,void(this.data=e);var t=e.data.byteLength;this.type=e.type,this.data=new Uint8Array(4+t),new DataView(this.data.buffer).setUint32(0,t),this.data.set(e.data,4)},fe=function(){function e(e){this.TAG="H265AnnexBParser",this.current_startcode_offset_=0,this.eof_flag_=!1,this.data_=e,this.current_startcode_offset_=this.findNextStartCodeOffset(0),this.eof_flag_&&r.a.e(this.TAG,"Could not find H265 startcode until payload end!")}return e.prototype.findNextStartCodeOffset=function(e){for(var t=e,i=this.data_;;){if(t+3>=i.byteLength)return this.eof_flag_=!0,i.byteLength;var a=i[t+0]<<24|i[t+1]<<16|i[t+2]<<8|i[t+3],n=i[t+0]<<16|i[t+1]<<8|i[t+2];if(1===a||1===n)return t;t++}},e.prototype.readNextNaluPayload=function(){for(var e=this.data_,t=null;null==t&&!this.eof_flag_;){var i=this.current_startcode_offset_,a=e[i+=1===(e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3])?4:3]>>1&63,n=(128&e[i])>>>7,r=this.findNextStartCodeOffset(i);if(this.current_startcode_offset_=r,0===n){var o=e.subarray(i,r);(t=new le).type=a,t.data=o}}return t},e}(),pe=function(){function e(e,t,i,a){var n=23+(5+e.byteLength)+(5+t.byteLength)+(5+i.byteLength),r=this.data=new Uint8Array(n);r[0]=1,r[1]=(3&a.general_profile_space)<<6|(a.general_tier_flag?1:0)<<5|31&a.general_profile_idc,r[2]=a.general_profile_compatibility_flags_1,r[3]=a.general_profile_compatibility_flags_2,r[4]=a.general_profile_compatibility_flags_3,r[5]=a.general_profile_compatibility_flags_4,r[6]=a.general_constraint_indicator_flags_1,r[7]=a.general_constraint_indicator_flags_2,r[8]=a.general_constraint_indicator_flags_3,r[9]=a.general_constraint_indicator_flags_4,r[10]=a.general_constraint_indicator_flags_5,r[11]=a.general_constraint_indicator_flags_6,r[12]=a.general_level_idc,r[13]=240|(3840&a.min_spatial_segmentation_idc)>>8,r[14]=255&a.min_spatial_segmentation_idc,r[15]=252|3&a.parallelismType,r[16]=252|3&a.chroma_format_idc,r[17]=248|7&a.bit_depth_luma_minus8,r[18]=248|7&a.bit_depth_chroma_minus8,r[19]=0,r[20]=0,r[21]=(3&a.constant_frame_rate)<<6|(7&a.num_temporal_layers)<<3|(a.temporal_id_nested?1:0)<<2|3,r[22]=3,r[23]=128|J.kSliceVPS,r[24]=0,r[25]=1,r[26]=(65280&e.byteLength)>>8,r[27]=(255&e.byteLength)>>0,r.set(e,28),r[23+(5+e.byteLength)+0]=128|J.kSliceSPS,r[23+(5+e.byteLength)+1]=0,r[23+(5+e.byteLength)+2]=1,r[23+(5+e.byteLength)+3]=(65280&t.byteLength)>>8,r[23+(5+e.byteLength)+4]=(255&t.byteLength)>>0,r.set(t,23+(5+e.byteLength)+5),r[23+(5+e.byteLength+5+t.byteLength)+0]=128|J.kSlicePPS,r[23+(5+e.byteLength+5+t.byteLength)+1]=0,r[23+(5+e.byteLength+5+t.byteLength)+2]=1,r[23+(5+e.byteLength+5+t.byteLength)+3]=(65280&i.byteLength)>>8,r[23+(5+e.byteLength+5+t.byteLength)+4]=(255&i.byteLength)>>0,r.set(i,23+(5+e.byteLength+5+t.byteLength)+5)}return e.prototype.getData=function(){return this.data},e}(),me=function(){},ge=function(){},ve=function(){},Ee=[[64,64,80,80,96,96,112,112,128,128,160,160,192,192,224,224,256,256,320,320,384,384,448,448,512,512,640,640,768,768,896,896,1024,1024,1152,1152,1280,1280],[69,70,87,88,104,105,121,122,139,140,174,175,208,209,243,244,278,279,348,349,417,418,487,488,557,558,696,697,835,836,975,976,1114,1115,1253,1254,1393,1394],[96,96,120,120,144,144,168,168,192,192,240,240,288,288,336,336,384,384,480,480,576,576,672,672,768,768,960,960,1152,1152,1344,1344,1536,1536,1728,1728,1920,1920]],ye=function(){function e(e){this.TAG="AC3Parser",this.data_=e,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&r.a.e(this.TAG,"Could not found AC3 syncword until payload end")}return e.prototype.findNextSyncwordOffset=function(e){for(var t=e,i=this.data_;;){if(t+7>=i.byteLength)return this.eof_flag_=!0,i.byteLength;if(2935===(i[t+0]<<8|i[t+1]<<0))return t;t++}},e.prototype.readNextAC3Frame=function(){for(var e=this.data_,t=null;null==t&&!this.eof_flag_;){var i=this.current_syncword_offset_,a=e[i+4]>>6,n=[48e3,44200,33e3][a],r=63&e[i+4],o=2*Ee[a][r];if(isNaN(o)||i+o>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var s=this.findNextSyncwordOffset(i+o);this.current_syncword_offset_=s;var _=e[i+5]>>3,d=7&e[i+5],c=e[i+6]>>5,u=0;0!=(1&c)&&1!==c&&(u+=2),0!=(4&c)&&(u+=2),2===c&&(u+=2);var l=(e[i+6]<<8|e[i+7]<<0)>>12-u&1,h=[2,1,2,3,3,4,4,5][c]+l;(t=new ve).sampling_frequency=n,t.channel_count=h,t.channel_mode=c,t.bit_stream_identification=_,t.low_frequency_effects_channel_on=l,t.bit_stream_mode=d,t.frame_size_code=r,t.data=e.subarray(i,i+o)}return t},e.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},e.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},e}(),Te=function(e){var t;t=[e.sampling_rate_code<<6|e.bit_stream_identification<<1|e.bit_stream_mode>>2,(3&e.bit_stream_mode)<<6|e.channel_mode<<3|e.low_frequency_effects_channel_on<<2|e.frame_size_code>>4,e.frame_size_code<<4&224],this.config=t,this.sampling_rate=e.sampling_frequency,this.bit_stream_identification=e.bit_stream_identification,this.bit_stream_mode=e.bit_stream_mode,this.low_frequency_effects_channel_on=e.low_frequency_effects_channel_on,this.channel_count=e.channel_count,this.channel_mode=e.channel_mode,this.codec_mimetype="ac-3",this.original_codec_mimetype="ac-3"},Se=function(){},Ae=function(){function e(e){this.TAG="EAC3Parser",this.data_=e,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&r.a.e(this.TAG,"Could not found AC3 syncword until payload end")}return e.prototype.findNextSyncwordOffset=function(e){for(var t=e,i=this.data_;;){if(t+7>=i.byteLength)return this.eof_flag_=!0,i.byteLength;if(2935===(i[t+0]<<8|i[t+1]<<0))return t;t++}},e.prototype.readNextEAC3Frame=function(){for(var e=this.data_,t=null;null==t&&!this.eof_flag_;){var i=this.current_syncword_offset_,a=new f(e.subarray(i+2)),n=(a.readBits(2),a.readBits(3),a.readBits(11)+1<<1),r=a.readBits(2),o=null,s=null;3===r?(o=[24e3,22060,16e3][r=a.readBits(2)],s=3):(o=[48e3,44100,32e3][r],s=a.readBits(2));var _=a.readBits(3),d=a.readBits(1),c=a.readBits(5);if(i+n>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var u=this.findNextSyncwordOffset(i+n);this.current_syncword_offset_=u;var l=[2,1,2,3,3,4,4,5][_]+d;a.destroy(),(t=new Se).sampling_frequency=o,t.channel_count=l,t.channel_mode=_,t.bit_stream_identification=c,t.low_frequency_effects_channel_on=d,t.frame_size=n,t.num_blks=[1,2,3,6][s],t.data=e.subarray(i,i+n)}return t},e.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},e.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},e}(),Re=function(e){var t,i=Math.floor(e.frame_size*e.sampling_frequency/(16*e.num_blks));t=[255&i,248&i,e.sampling_rate_code<<6|e.bit_stream_identification<<1|0,0|e.channel_mode<<1|e.low_frequency_effects_channel_on<<0,0],this.config=t,this.sampling_rate=e.sampling_frequency,this.bit_stream_identification=e.bit_stream_identification,this.num_blks=e.num_blks,this.low_frequency_effects_channel_on=e.low_frequency_effects_channel_on,this.channel_count=e.channel_count,this.channel_mode=e.channel_mode,this.codec_mimetype="ec-3",this.original_codec_mimetype="ec-3"},be=function(){},Ie=function(){function e(e){this.TAG="AV1OBUInMpegTsParser",this.current_startcode_offset_=0,this.eof_flag_=!1,this.data_=e,this.current_startcode_offset_=this.findNextStartCodeOffset(0),this.eof_flag_&&r.a.e(this.TAG,"Could not find AV1 startcode until payload end!")}return e._ebsp2rbsp=function(e){for(var t=e,i=t.byteLength,a=new Uint8Array(i),n=0,r=0;r<i;r++)r>=2&&3===t[r]&&0===t[r-1]&&0===t[r-2]||(a[n]=t[r],n++);return new Uint8Array(a.buffer,0,n)},e.prototype.findNextStartCodeOffset=function(e){for(var t=e,i=this.data_;;){if(t+2>=i.byteLength)return this.eof_flag_=!0,i.byteLength;if(1===(i[t+0]<<16|i[t+1]<<8|i[t+2]))return t;t++}},e.prototype.readNextOBUPayload=function(){for(var t=this.data_,i=null;null==i&&!this.eof_flag_;){var a=this.current_startcode_offset_+3,n=this.findNextStartCodeOffset(a);this.current_startcode_offset_=n,i=e._ebsp2rbsp(t.subarray(a,n))}return i},e}(),Me=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}(),Oe=function(){return(Oe=Object.assign||function(e){for(var t,i=1,a=arguments.length;i<a;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},Ce=function(e){function t(t,i){var a=e.call(this)||this;return a.TAG="TSDemuxer",a.first_parse_=!0,a.media_info_=new s.a,a.timescale_=90,a.duration_=0,a.current_pmt_pid_=-1,a.program_pmt_map_={},a.pes_slice_queues_={},a.section_slice_queues_={},a.video_metadata_={vps:void 0,sps:void 0,pps:void 0,av1c:void 0,details:void 0},a.audio_metadata_={codec:void 0,audio_object_type:void 0,sampling_freq_index:void 0,sampling_frequency:void 0,channel_config:void 0},a.last_pcr_base_=NaN,a.timestamp_offset_=0,a.audio_last_sample_pts_=void 0,a.aac_last_incomplete_data_=null,a.has_video_=!1,a.has_audio_=!1,a.video_init_segment_dispatched_=!1,a.audio_init_segment_dispatched_=!1,a.video_metadata_changed_=!1,a.loas_previous_frame=null,a.video_track_={type:"video",id:1,sequenceNumber:0,samples:[],length:0},a.audio_track_={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},a.ts_packet_size_=t.ts_packet_size,a.sync_offset_=t.sync_offset,a.config_=i,a}return Me(t,e),t.prototype.destroy=function(){this.media_info_=null,this.pes_slice_queues_=null,this.section_slice_queues_=null,this.video_metadata_=null,this.audio_metadata_=null,this.aac_last_incomplete_data_=null,this.video_track_=null,this.audio_track_=null,e.prototype.destroy.call(this)},t.probe=function(e){var t=new Uint8Array(e),i=-1,a=188;if(t.byteLength<=3*a)return{needMoreData:!0};for(;-1===i;){for(var n=Math.min(1e3,t.byteLength-3*a),o=0;o<n;){if(71===t[o]&&71===t[o+a]&&71===t[o+2*a]){i=o;break}o++}if(-1===i)if(188===a)a=192;else{if(192!==a)break;a=204}}return-1===i?{match:!1}:(192===a&&i>=4?(r.a.v("TSDemuxer","ts_packet_size = 192, m2ts mode"),i-=4):204===a&&r.a.v("TSDemuxer","ts_packet_size = 204, RS encoded MPEG2-TS stream"),{match:!0,consumed:0,ts_packet_size:a,sync_offset:i})},t.prototype.bindDataSource=function(e){return e.onDataArrival=this.parseChunks.bind(this),this},t.prototype.resetMediaInfo=function(){this.media_info_=new s.a},t.prototype.parseChunks=function(e,t){if(!(this.onError&&this.onMediaInfo&&this.onTrackMetadata&&this.onDataAvailable))throw new u.a("onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var i=0;for(this.first_parse_&&(this.first_parse_=!1,i=this.sync_offset_);i+this.ts_packet_size_<=e.byteLength;){var a=t+i;192===this.ts_packet_size_&&(i+=4);var n=new Uint8Array(e,i,188),o=n[0];if(71!==o){r.a.e(this.TAG,"sync_byte = ".concat(o,", not 0x47"));break}var s=(64&n[1])>>>6,_=(n[1],(31&n[1])<<8|n[2]),d=(48&n[3])>>>4,c=15&n[3],l=!(!this.pmt_||this.pmt_.pcr_pid!==_),h={},f=4;if(2==d||3==d){var p=n[4];if(p>0&&(l||3==d))if(h.discontinuity_indicator=(128&n[5])>>>7,h.random_access_indicator=(64&n[5])>>>6,h.elementary_stream_priority_indicator=(32&n[5])>>>5,(16&n[5])>>>4){var m=300*this.getPcrBase(n)+((1&n[10])<<8|n[11]);this.last_pcr_=m}if(2==d||5+p===188){i+=188,204===this.ts_packet_size_&&(i+=16);continue}f=5+p}if(1==d||3==d)if(0===_||_===this.current_pmt_pid_||null!=this.pmt_&&this.pmt_.pid_stream_type[_]===R.kSCTE35){var g=188-f;this.handleSectionSlice(e,i+f,g,{pid:_,file_position:a,payload_unit_start_indicator:s,continuity_conunter:c,random_access_indicator:h.random_access_indicator})}else if(null!=this.pmt_&&null!=this.pmt_.pid_stream_type[_]){g=188-f;var v=this.pmt_.pid_stream_type[_];_!==this.pmt_.common_pids.h264&&_!==this.pmt_.common_pids.h265&&_!==this.pmt_.common_pids.av1&&_!==this.pmt_.common_pids.adts_aac&&_!==this.pmt_.common_pids.loas_aac&&_!==this.pmt_.common_pids.ac3&&_!==this.pmt_.common_pids.eac3&&_!==this.pmt_.common_pids.opus&&_!==this.pmt_.common_pids.mp3&&!0!==this.pmt_.pes_private_data_pids[_]&&!0!==this.pmt_.timed_id3_pids[_]&&!0!==this.pmt_.synchronous_klv_pids[_]&&!0!==this.pmt_.asynchronous_klv_pids[_]||this.handlePESSlice(e,i+f,g,{pid:_,stream_type:v,file_position:a,payload_unit_start_indicator:s,continuity_conunter:c,random_access_indicator:h.random_access_indicator})}i+=188,204===this.ts_packet_size_&&(i+=16)}return this.dispatchAudioVideoMediaSegment(),i},t.prototype.handleSectionSlice=function(e,t,i,a){var n=new Uint8Array(e,t,i),r=this.section_slice_queues_[a.pid];if(a.payload_unit_start_indicator){var o=n[0];if(null!=r&&0!==r.total_length){var s=new Uint8Array(e,t+1,Math.min(i,o));r.slices.push(s),r.total_length+=s.byteLength,r.total_length===r.expected_length?this.emitSectionSlices(r,a):this.clearSlices(r,a)}for(var _=1+o;_<n.byteLength;){if(255===n[_+0])break;var d=(15&n[_+1])<<8|n[_+2];this.section_slice_queues_[a.pid]=new P,(r=this.section_slice_queues_[a.pid]).expected_length=d+3,r.file_position=a.file_position,r.random_access_indicator=a.random_access_indicator;s=new Uint8Array(e,t+_,Math.min(i-_,r.expected_length-r.total_length));r.slices.push(s),r.total_length+=s.byteLength,r.total_length===r.expected_length?this.emitSectionSlices(r,a):r.total_length>=r.expected_length&&this.clearSlices(r,a),_+=s.byteLength}}else if(null!=r&&0!==r.total_length){s=new Uint8Array(e,t,Math.min(i,r.expected_length-r.total_length));r.slices.push(s),r.total_length+=s.byteLength,r.total_length===r.expected_length?this.emitSectionSlices(r,a):r.total_length>=r.expected_length&&this.clearSlices(r,a)}},t.prototype.handlePESSlice=function(e,t,i,a){var n=new Uint8Array(e,t,i),o=n[0]<<16|n[1]<<8|n[2],s=(n[3],n[4]<<8|n[5]);if(a.payload_unit_start_indicator){if(1!==o)return void r.a.e(this.TAG,"handlePESSlice: packet_start_code_prefix should be 1 but with value ".concat(o));var _=this.pes_slice_queues_[a.pid];_&&(0===_.expected_length||_.expected_length===_.total_length?this.emitPESSlices(_,a):this.clearSlices(_,a)),this.pes_slice_queues_[a.pid]=new P,this.pes_slice_queues_[a.pid].file_position=a.file_position,this.pes_slice_queues_[a.pid].random_access_indicator=a.random_access_indicator}if(null!=this.pes_slice_queues_[a.pid]){var d=this.pes_slice_queues_[a.pid];d.slices.push(n),a.payload_unit_start_indicator&&(d.expected_length=0===s?0:s+6),d.total_length+=n.byteLength,d.expected_length>0&&d.expected_length===d.total_length?this.emitPESSlices(d,a):d.expected_length>0&&d.expected_length<d.total_length&&this.clearSlices(d,a)}},t.prototype.emitSectionSlices=function(e,t){for(var i=new Uint8Array(e.total_length),a=0,n=0;a<e.slices.length;a++){var r=e.slices[a];i.set(r,n),n+=r.byteLength}e.slices=[],e.expected_length=-1,e.total_length=0;var o=new L;o.pid=t.pid,o.data=i,o.file_position=e.file_position,o.random_access_indicator=e.random_access_indicator,this.parseSection(o)},t.prototype.emitPESSlices=function(e,t){for(var i=new Uint8Array(e.total_length),a=0,n=0;a<e.slices.length;a++){var r=e.slices[a];i.set(r,n),n+=r.byteLength}e.slices=[],e.expected_length=-1,e.total_length=0;var o=new D;o.pid=t.pid,o.data=i,o.stream_type=t.stream_type,o.file_position=e.file_position,o.random_access_indicator=e.random_access_indicator,this.parsePES(o)},t.prototype.clearSlices=function(e,t){e.slices=[],e.expected_length=-1,e.total_length=0},t.prototype.parseSection=function(e){var t=e.data,i=e.pid;0===i?this.parsePAT(t):i===this.current_pmt_pid_?this.parsePMT(t):null!=this.pmt_&&this.pmt_.scte_35_pids[i]&&this.parseSCTE35(t)},t.prototype.parsePES=function(e){var t=e.data,i=t[0]<<16|t[1]<<8|t[2],a=t[3],n=t[4]<<8|t[5];if(1===i){if(188!==a&&190!==a&&191!==a&&240!==a&&241!==a&&255!==a&&242!==a&&248!==a){t[6];var o=(192&t[7])>>>6,s=t[8],_=void 0,d=void 0;2!==o&&3!==o||(_=this.getTimestamp(t,9),d=3===o?this.getTimestamp(t,14):_);var c=9+s,u=void 0;if(0!==n){if(n<3+s)return void r.a.v(this.TAG,"Malformed PES: PES_packet_length < 3 + PES_header_data_length");u=n-3-s}else u=t.byteLength-c;var l=t.subarray(c,c+u);switch(e.stream_type){case R.kMPEG1Audio:case R.kMPEG2Audio:this.parseMP3Payload(l,_);break;case R.kPESPrivateData:this.pmt_.common_pids.av1===e.pid?this.parseAV1Payload(l,_,d,e.file_position,e.random_access_indicator):this.pmt_.common_pids.opus===e.pid?this.parseOpusPayload(l,_):this.pmt_.common_pids.ac3===e.pid?this.parseAC3Payload(l,_):this.pmt_.common_pids.eac3===e.pid?this.parseEAC3Payload(l,_):this.pmt_.asynchronous_klv_pids[e.pid]?this.parseAsynchronousKLVMetadataPayload(l,e.pid,a):this.pmt_.smpte2038_pids[e.pid]?this.parseSMPTE2038MetadataPayload(l,_,d,e.pid,a):this.parsePESPrivateDataPayload(l,_,d,e.pid,a);break;case R.kADTSAAC:this.parseADTSAACPayload(l,_);break;case R.kLOASAAC:this.parseLOASAACPayload(l,_);break;case R.kAC3:this.parseAC3Payload(l,_);break;case R.kEAC3:this.parseEAC3Payload(l,_);break;case R.kMetadata:this.pmt_.timed_id3_pids[e.pid]?this.parseTimedID3MetadataPayload(l,_,d,e.pid,a):this.pmt_.synchronous_klv_pids[e.pid]&&this.parseSynchronousKLVMetadataPayload(l,_,d,e.pid,a);break;case R.kH264:this.parseH264Payload(l,_,d,e.file_position,e.random_access_indicator);break;case R.kH265:this.parseH265Payload(l,_,d,e.file_position,e.random_access_indicator)}}else if((188===a||191===a||240===a||241===a||255===a||242===a||248===a)&&e.stream_type===R.kPESPrivateData){c=6,u=void 0;u=0!==n?n:t.byteLength-c;l=t.subarray(c,c+u);this.parsePESPrivateDataPayload(l,void 0,void 0,e.pid,a)}}else r.a.e(this.TAG,"parsePES: packet_start_code_prefix should be 1 but with value ".concat(i))},t.prototype.parsePAT=function(e){var t=e[0];if(0===t){var i=(15&e[1])<<8|e[2],a=(e[3],e[4],(62&e[5])>>>1),n=1&e[5],o=e[6],s=(e[7],null);if(1===n&&0===o)(s=new M).version_number=a;else if(null==(s=this.pat_))return;for(var _=i-5-4,d=-1,c=-1,u=8;u<8+_;u+=4){var l=e[u]<<8|e[u+1],h=(31&e[u+2])<<8|e[u+3];0===l?s.network_pid=h:(s.program_pmt_pid[l]=h,-1===d&&(d=l),-1===c&&(c=h))}1===n&&0===o&&(null==this.pat_&&r.a.v(this.TAG,"Parsed first PAT: ".concat(JSON.stringify(s))),this.pat_=s,this.current_program_=d,this.current_pmt_pid_=c)}else r.a.e(this.TAG,"parsePAT: table_id ".concat(t," is not corresponded to PAT!"))},t.prototype.parsePMT=function(e){var t=e[0];if(2===t){var i=(15&e[1])<<8|e[2],a=e[3]<<8|e[4],n=(62&e[5])>>>1,o=1&e[5],s=e[6],_=(e[7],null);if(1===o&&0===s)(_=new C).program_number=a,_.version_number=n,this.program_pmt_map_[a]=_;else if(null==(_=this.program_pmt_map_[a]))return;_.pcr_pid=(31&e[8])<<8|e[9];for(var d=(15&e[10])<<8|e[11],c=12+d,u=i-9-d-4,l=c;l<c+u;){var h=e[l],f=(31&e[l+1])<<8|e[l+2],p=(15&e[l+3])<<8|e[l+4];_.pid_stream_type[f]=h;var m=_.common_pids.h264||_.common_pids.h265,g=_.common_pids.adts_aac||_.common_pids.loas_aac||_.common_pids.ac3||_.common_pids.eac3||_.common_pids.opus||_.common_pids.mp3;if(h!==R.kH264||m)if(h!==R.kH265||m)if(h!==R.kADTSAAC||g)if(h!==R.kLOASAAC||g)if(h!==R.kAC3||g)if(h!==R.kEAC3||g)if(h!==R.kMPEG1Audio&&h!==R.kMPEG2Audio||g)if(h===R.kPESPrivateData){if(_.pes_private_data_pids[f]=!0,p>0){for(var v=l+5;v<l+5+p;){var E=e[v+0],y=e[v+1];if(5===E){var T=String.fromCharCode.apply(String,Array.from(e.subarray(v+2,v+2+y)));"VANC"===T?_.smpte2038_pids[f]=!0:"AV01"===T?_.common_pids.av1=f:"Opus"===T?_.common_pids.opus=f:"KLVA"===T&&(_.asynchronous_klv_pids[f]=!0)}else if(127===E){if(f===_.common_pids.opus){var S=null;if(128===e[v+2]&&(S=e[v+3]),null==S){r.a.e(this.TAG,"Not Supported Opus channel count.");continue}var A={codec:"opus",channel_count:0==(15&S)?2:15&S,channel_config_code:S,sample_rate:48e3},b={codec:"opus",meta:A};(0==this.audio_init_segment_dispatched_||this.detectAudioMetadataChange(b))&&(this.audio_metadata_=A,this.dispatchAudioMediaSegment(!0),this.dispatchAudioInitSegment(b))}}else 128===E&&f===_.common_pids.av1&&(this.video_metadata_.av1c=e.subarray(v+2,v+2+y));v+=2+y}var I=e.subarray(l+5,l+5+p);this.dispatchPESPrivateDataDescriptor(f,h,I)}}else if(h===R.kMetadata){if(p>0)for(v=l+5;v<l+5+p;){E=e[v+0];var M=e[v+1];if(38===E){var O=e[v+2]<<8|e[v+3]<<0,D=null;65535===O&&(D=String.fromCharCode.apply(String,Array.from(e.subarray(v+4,v+4+4))));var L=null;if(255===e[v+4+(65535===O?4:0)]){var P=4+(65535===O?4:0)+1;L=String.fromCharCode.apply(String,Array.from(e.subarray(v+P,v+P+4)))}"ID3 "===D&&"ID3 "===L?_.timed_id3_pids[f]=!0:"KLVA"===L&&(_.synchronous_klv_pids[f]=!0)}v+=2+M}}else h===R.kSCTE35&&(_.scte_35_pids[f]=!0);else _.common_pids.mp3=f;else _.common_pids.eac3=f;else _.common_pids.ac3=f;else _.common_pids.loas_aac=f;else _.common_pids.adts_aac=f;else _.common_pids.h265=f;else _.common_pids.h264=f;l+=5+p}a===this.current_program_&&(null==this.pmt_&&r.a.v(this.TAG,"Parsed first PMT: ".concat(JSON.stringify(_))),this.pmt_=_,(_.common_pids.h264||_.common_pids.h265||_.common_pids.av1)&&(this.has_video_=!0),(_.common_pids.adts_aac||_.common_pids.loas_aac||_.common_pids.ac3||_.common_pids.opus||_.common_pids.mp3)&&(this.has_audio_=!0))}else r.a.e(this.TAG,"parsePMT: table_id ".concat(t," is not corresponded to PMT!"))},t.prototype.parseSCTE35=function(e){var t=ue(e);if(null!=t.pts){var i=Math.floor(t.pts/this.timescale_);t.pts=i}else t.nearest_pts=this.getNearestTimestampMilliseconds();this.onSCTE35Metadata&&this.onSCTE35Metadata(t)},t.prototype.parseAV1Payload=function(e,t,i,a,n){for(var r=new Ie(e),o=null,s=[],_=0,d=!1,c=null;null!=(o=r.readNextOBUPayload());){if((c=A.parseOBUs(o,this.video_metadata_.details))&&!0===c.keyframe)if(this.video_init_segment_dispatched_){if(!0===this.detectVideoMetadataChange(null,c)){var u;this.video_metadata_changed_=!0,this.dispatchVideoMediaSegment(!0),(u=new Uint8Array(new ArrayBuffer(this.video_metadata_.av1c.byteLength+c.sequence_header_data.byteLength))).set(this.video_metadata_.av1c,0),u.set(c.sequence_header_data,this.video_metadata_.av1c.byteLength),c.av1c=u,this.dispatchVideoInitSegment()}}else(u=new Uint8Array(new ArrayBuffer(this.video_metadata_.av1c.byteLength+c.sequence_header_data.byteLength))).set(this.video_metadata_.av1c,0),u.set(c.sequence_header_data,this.video_metadata_.av1c.byteLength),c.av1c=u,this.video_metadata_.details=c,this.dispatchVideoInitSegment();this.video_metadata_.details=c,d||(d=c.keyframe),s.push({data:o}),_+=o.byteLength}var l=Math.floor(t/this.timescale_),h=Math.floor(i/this.timescale_);if(s.length){var f=this.video_track_,p={units:s,length:_,isKeyframe:d,dts:h,pts:l,cts:l-h,file_position:a};f.samples.push(p),f.length+=_}},t.prototype.parseH264Payload=function(e,t,i,a,n){for(var o=new B(e),s=null,_=[],d=0,c=!1;null!=(s=o.readNextNaluPayload());){var u=new U(s);if(u.type===O.kSliceSPS){var l=p.parseSPS(s.data);this.video_init_segment_dispatched_?!0===this.detectVideoMetadataChange(u,l)&&(r.a.v(this.TAG,"H264: Critical h264 metadata has been changed, attempt to re-generate InitSegment"),this.video_metadata_changed_=!0,this.video_metadata_={vps:void 0,sps:u,pps:void 0,av1c:void 0,details:l}):(this.video_metadata_.sps=u,this.video_metadata_.details=l)}else u.type===O.kSlicePPS?this.video_init_segment_dispatched_&&!this.video_metadata_changed_||(this.video_metadata_.pps=u,this.video_metadata_.sps&&this.video_metadata_.pps&&(this.video_metadata_changed_&&this.dispatchVideoMediaSegment(!0),this.dispatchVideoInitSegment())):(u.type===O.kSliceIDR||u.type===O.kSliceNonIDR&&1===n)&&(c=!0);this.video_init_segment_dispatched_&&(_.push(u),d+=u.data.byteLength)}var h=Math.floor(t/this.timescale_),f=Math.floor(i/this.timescale_);if(_.length){var m=this.video_track_,g={units:_,length:d,isKeyframe:c,dts:f,pts:h,cts:h-f,file_position:a};m.samples.push(g),m.length+=d}},t.prototype.parseH265Payload=function(e,t,i,a,n){for(var o=new fe(e),s=null,_=[],d=0,c=!1;null!=(s=o.readNextNaluPayload());){var u=new he(s);if(u.type===J.kSliceVPS){if(!this.video_init_segment_dispatched_){var l=g.parseVPS(s.data);this.video_metadata_.vps=u,this.video_metadata_.details=Oe(Oe({},this.video_metadata_.details),l)}}else if(u.type===J.kSliceSPS){l=g.parseSPS(s.data);this.video_init_segment_dispatched_?!0===this.detectVideoMetadataChange(u,l)&&(r.a.v(this.TAG,"H265: Critical h265 metadata has been changed, attempt to re-generate InitSegment"),this.video_metadata_changed_=!0,this.video_metadata_={vps:void 0,sps:u,pps:void 0,av1c:void 0,details:l}):(this.video_metadata_.sps=u,this.video_metadata_.details=Oe(Oe({},this.video_metadata_.details),l))}else if(u.type===J.kSlicePPS){if(!this.video_init_segment_dispatched_||this.video_metadata_changed_){l=g.parsePPS(s.data);this.video_metadata_.pps=u,this.video_metadata_.details=Oe(Oe({},this.video_metadata_.details),l),this.video_metadata_.vps&&this.video_metadata_.sps&&this.video_metadata_.pps&&(this.video_metadata_changed_&&this.dispatchVideoMediaSegment(!0),this.dispatchVideoInitSegment())}}else u.type!==J.kSliceIDR_W_RADL&&u.type!==J.kSliceIDR_N_LP&&u.type!==J.kSliceCRA_NUT||(c=!0);this.video_init_segment_dispatched_&&(_.push(u),d+=u.data.byteLength)}var h=Math.floor(t/this.timescale_),f=Math.floor(i/this.timescale_);if(_.length){var p=this.video_track_,m={units:_,length:d,isKeyframe:c,dts:f,pts:h,cts:h-f,file_position:a};p.samples.push(m),p.length+=d}},t.prototype.detectVideoMetadataChange=function(e,t){if(t.codec_mimetype!==this.video_metadata_.details.codec_mimetype)return r.a.v(this.TAG,"Video: Codec mimeType changed from "+"".concat(this.video_metadata_.details.codec_mimetype," to ").concat(t.codec_mimetype)),!0;if(t.codec_size.width!==this.video_metadata_.details.codec_size.width||t.codec_size.height!==this.video_metadata_.details.codec_size.height){var i=this.video_metadata_.details.codec_size,a=t.codec_size;return r.a.v(this.TAG,"Video: Coded Resolution changed from "+"".concat(i.width,"x").concat(i.height," to ").concat(a.width,"x").concat(a.height)),!0}return t.present_size.width!==this.video_metadata_.details.present_size.width&&(r.a.v(this.TAG,"Video: Present resolution width changed from "+"".concat(this.video_metadata_.details.present_size.width," to ").concat(t.present_size.width)),!0)},t.prototype.isInitSegmentDispatched=function(){return this.has_video_&&this.has_audio_?this.video_init_segment_dispatched_&&this.audio_init_segment_dispatched_:this.has_video_&&!this.has_audio_?this.video_init_segment_dispatched_:!(this.has_video_||!this.has_audio_)&&this.audio_init_segment_dispatched_},t.prototype.dispatchVideoInitSegment=function(){var e=this.video_metadata_.details,t={type:"video"};t.id=this.video_track_.id,t.timescale=1e3,t.duration=this.duration_,t.codecWidth=e.codec_size.width,t.codecHeight=e.codec_size.height,t.presentWidth=e.present_size.width,t.presentHeight=e.present_size.height,t.profile=e.profile_string,t.level=e.level_string,t.bitDepth=e.bit_depth,t.chromaFormat=e.chroma_format,t.sarRatio=e.sar_ratio,t.frameRate=e.frame_rate;var i=t.frameRate.fps_den,a=t.frameRate.fps_num;if(t.refSampleDuration=i/a*1e3,t.codec=e.codec_mimetype,this.video_metadata_.av1c)t.av1c=this.video_metadata_.av1c,0==this.video_init_segment_dispatched_&&r.a.v(this.TAG,"Generated first AV1 for mimeType: ".concat(t.codec));else if(this.video_metadata_.vps){var n=this.video_metadata_.vps.data.subarray(4),o=this.video_metadata_.sps.data.subarray(4),s=this.video_metadata_.pps.data.subarray(4),_=new pe(n,o,s,e);t.hvcc=_.getData(),0==this.video_init_segment_dispatched_&&r.a.v(this.TAG,"Generated first HEVCDecoderConfigurationRecord for mimeType: ".concat(t.codec))}else{o=this.video_metadata_.sps.data.subarray(4),s=this.video_metadata_.pps.data.subarray(4);var d=new x(o,s,e);t.avcc=d.getData(),0==this.video_init_segment_dispatched_&&r.a.v(this.TAG,"Generated first AVCDecoderConfigurationRecord for mimeType: ".concat(t.codec))}this.onTrackMetadata("video",t),this.video_init_segment_dispatched_=!0,this.video_metadata_changed_=!1;var c=this.media_info_;c.hasVideo=!0,c.width=t.codecWidth,c.height=t.codecHeight,c.fps=t.frameRate.fps,c.profile=t.profile,c.level=t.level,c.refFrames=e.ref_frames,c.chromaFormat=e.chroma_format_string,c.sarNum=t.sarRatio.width,c.sarDen=t.sarRatio.height,c.videoCodec=t.codec,c.hasAudio&&c.audioCodec?c.mimeType='video/mp2t; codecs="'.concat(c.videoCodec,",").concat(c.audioCodec,'"'):c.mimeType='video/mp2t; codecs="'.concat(c.videoCodec,'"'),c.isComplete()&&this.onMediaInfo(c)},t.prototype.dispatchVideoMediaSegment=function(e){void 0===e&&(e=!1),this.isInitSegmentDispatched()&&(this.video_track_.length||e)&&this.onDataAvailable(null,this.video_track_,e)},t.prototype.dispatchAudioMediaSegment=function(e){void 0===e&&(e=!1),this.isInitSegmentDispatched()&&(this.audio_track_.length||e)&&this.onDataAvailable(this.audio_track_,null,e)},t.prototype.dispatchAudioVideoMediaSegment=function(){this.isInitSegmentDispatched()&&(this.audio_track_.length||this.video_track_.length)&&this.onDataAvailable(this.audio_track_,this.video_track_)},t.prototype.parseADTSAACPayload=function(e,t){if(!this.has_video_||this.video_init_segment_dispatched_){if(this.aac_last_incomplete_data_){var i=new Uint8Array(e.byteLength+this.aac_last_incomplete_data_.byteLength);i.set(this.aac_last_incomplete_data_,0),i.set(e,this.aac_last_incomplete_data_.byteLength),e=i}var a,n;if(null!=t&&(n=t/this.timescale_),"aac"===this.audio_metadata_.codec){if(null==t&&null!=this.audio_last_sample_pts_)a=1024/this.audio_metadata_.sampling_frequency*1e3,n=this.audio_last_sample_pts_+a;else if(null==t)return void r.a.w(this.TAG,"AAC: Unknown pts");if(this.aac_last_incomplete_data_&&this.audio_last_sample_pts_){a=1024/this.audio_metadata_.sampling_frequency*1e3;var o=this.audio_last_sample_pts_+a;Math.abs(o-n)>1&&(r.a.w(this.TAG,"AAC: Detected pts overlapped, "+"expected: ".concat(o,"ms, PES pts: ").concat(n,"ms")),n=o)}}for(var s,_=new j(e),d=null,c=n;null!=(d=_.readNextAACFrame());){a=1024/d.sampling_frequency*1e3;var u={codec:"aac",data:d};(0==this.audio_init_segment_dispatched_||this.detectAudioMetadataChange(u))&&(this.audio_metadata_={codec:"aac",audio_object_type:d.audio_object_type,sampling_freq_index:d.sampling_freq_index,sampling_frequency:d.sampling_frequency,channel_config:d.channel_config},this.dispatchAudioMediaSegment(!0),this.dispatchAudioInitSegment(u)),s=c;var l=Math.floor(c),h={unit:d.data,length:d.data.byteLength,pts:l,dts:l};this.audio_track_.samples.push(h),this.audio_track_.length+=d.data.byteLength,c+=a}_.hasIncompleteData()&&(this.aac_last_incomplete_data_=_.getIncompleteData()),s&&(this.audio_last_sample_pts_=s)}},t.prototype.parseLOASAACPayload=function(e,t){var i;if(!this.has_video_||this.video_init_segment_dispatched_){if(this.aac_last_incomplete_data_){var a=new Uint8Array(e.byteLength+this.aac_last_incomplete_data_.byteLength);a.set(this.aac_last_incomplete_data_,0),a.set(e,this.aac_last_incomplete_data_.byteLength),e=a}var n,o;if(null!=t&&(o=t/this.timescale_),"aac"===this.audio_metadata_.codec){if(null==t&&null!=this.audio_last_sample_pts_)n=1024/this.audio_metadata_.sampling_frequency*1e3,o=this.audio_last_sample_pts_+n;else if(null==t)return void r.a.w(this.TAG,"AAC: Unknown pts");if(this.aac_last_incomplete_data_&&this.audio_last_sample_pts_){n=1024/this.audio_metadata_.sampling_frequency*1e3;var s=this.audio_last_sample_pts_+n;Math.abs(s-o)>1&&(r.a.w(this.TAG,"AAC: Detected pts overlapped, "+"expected: ".concat(s,"ms, PES pts: ").concat(o,"ms")),o=s)}}for(var _,d=new q(e),c=null,u=o;null!=(c=d.readNextAACFrame(null!==(i=this.loas_previous_frame)&&void 0!==i?i:void 0));){this.loas_previous_frame=c,n=1024/c.sampling_frequency*1e3;var l={codec:"aac",data:c};(0==this.audio_init_segment_dispatched_||this.detectAudioMetadataChange(l))&&(this.audio_metadata_={codec:"aac",audio_object_type:c.audio_object_type,sampling_freq_index:c.sampling_freq_index,sampling_frequency:c.sampling_frequency,channel_config:c.channel_config},this.dispatchAudioMediaSegment(!0),this.dispatchAudioInitSegment(l)),_=u;var h=Math.floor(u),f={unit:c.data,length:c.data.byteLength,pts:h,dts:h};this.audio_track_.samples.push(f),this.audio_track_.length+=c.data.byteLength,u+=n}d.hasIncompleteData()&&(this.aac_last_incomplete_data_=d.getIncompleteData()),_&&(this.audio_last_sample_pts_=_)}},t.prototype.parseAC3Payload=function(e,t){if(!this.has_video_||this.video_init_segment_dispatched_){var i,a;if(null!=t&&(a=t/this.timescale_),"ac-3"===this.audio_metadata_.codec)if(null==t&&null!=this.audio_last_sample_pts_)i=1536/this.audio_metadata_.sampling_frequency*1e3,a=this.audio_last_sample_pts_+i;else if(null==t)return void r.a.w(this.TAG,"AC3: Unknown pts");for(var n,o=new ye(e),s=null,_=a;null!=(s=o.readNextAC3Frame());){i=1536/s.sampling_frequency*1e3;var d={codec:"ac-3",data:s};(0==this.audio_init_segment_dispatched_||this.detectAudioMetadataChange(d))&&(this.audio_metadata_={codec:"ac-3",sampling_frequency:s.sampling_frequency,bit_stream_identification:s.bit_stream_identification,bit_stream_mode:s.bit_stream_mode,low_frequency_effects_channel_on:s.low_frequency_effects_channel_on,channel_mode:s.channel_mode},this.dispatchAudioMediaSegment(!0),this.dispatchAudioInitSegment(d)),n=_;var c=Math.floor(_),u={unit:s.data,length:s.data.byteLength,pts:c,dts:c};this.audio_track_.samples.push(u),this.audio_track_.length+=s.data.byteLength,_+=i}n&&(this.audio_last_sample_pts_=n)}},t.prototype.parseEAC3Payload=function(e,t){if(!this.has_video_||this.video_init_segment_dispatched_){var i,a;if(null!=t&&(a=t/this.timescale_),"ec-3"===this.audio_metadata_.codec)if(null==t&&null!=this.audio_last_sample_pts_)i=256*this.audio_metadata_.num_blks/this.audio_metadata_.sampling_frequency*1e3,a=this.audio_last_sample_pts_+i;else if(null==t)return void r.a.w(this.TAG,"EAC3: Unknown pts");for(var n,o=new Ae(e),s=null,_=a;null!=(s=o.readNextEAC3Frame());){i=1536/s.sampling_frequency*1e3;var d={codec:"ec-3",data:s};(0==this.audio_init_segment_dispatched_||this.detectAudioMetadataChange(d))&&(this.audio_metadata_={codec:"ec-3",sampling_frequency:s.sampling_frequency,bit_stream_identification:s.bit_stream_identification,low_frequency_effects_channel_on:s.low_frequency_effects_channel_on,num_blks:s.num_blks,channel_mode:s.channel_mode},this.dispatchAudioMediaSegment(!0),this.dispatchAudioInitSegment(d)),n=_;var c=Math.floor(_),u={unit:s.data,length:s.data.byteLength,pts:c,dts:c};this.audio_track_.samples.push(u),this.audio_track_.length+=s.data.byteLength,_+=i}n&&(this.audio_last_sample_pts_=n)}},t.prototype.parseOpusPayload=function(e,t){if(!this.has_video_||this.video_init_segment_dispatched_){var i,a;if(null!=t&&(a=t/this.timescale_),"opus"===this.audio_metadata_.codec)if(null==t&&null!=this.audio_last_sample_pts_)i=20,a=this.audio_last_sample_pts_+i;else if(null==t)return void r.a.w(this.TAG,"Opus: Unknown pts");for(var n,o=a,s=0;s<e.length;){i=20;for(var _=0!=(16&e[s+1]),d=0!=(8&e[s+1]),c=s+2,u=0;255===e[c];)u+=255,c+=1;u+=e[c],c+=1,c+=_?2:0,c+=d?2:0,n=o;var l=Math.floor(o),h=e.slice(c,c+u),f={unit:h,length:h.byteLength,pts:l,dts:l};this.audio_track_.samples.push(f),this.audio_track_.length+=h.byteLength,o+=i,s=c+u}n&&(this.audio_last_sample_pts_=n)}},t.prototype.parseMP3Payload=function(e,t){if(!this.has_video_||this.video_init_segment_dispatched_){var i=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],a=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],n=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],r=e[1]>>>3&3,o=(6&e[1])>>1,s=(240&e[2])>>>4,_=(12&e[2])>>>2,d=3!==(e[3]>>>6&3)?2:1,c=0,u=34;switch(r){case 0:c=[11025,12e3,8e3,0][_];break;case 2:c=[22050,24e3,16e3,0][_];break;case 3:c=[44100,48e3,32e3,0][_]}switch(o){case 1:u=34,s<n.length&&n[s];break;case 2:u=33,s<a.length&&a[s];break;case 3:u=32,s<i.length&&i[s]}var l=new ge;l.object_type=u,l.sample_rate=c,l.channel_count=d,l.data=e;var h={codec:"mp3",data:l};0==this.audio_init_segment_dispatched_&&(this.audio_metadata_={codec:"mp3",object_type:u,sample_rate:c,channel_count:d},this.dispatchAudioMediaSegment(!0),this.dispatchAudioInitSegment(h));var f={unit:e,length:e.byteLength,pts:t/this.timescale_,dts:t/this.timescale_};this.audio_track_.samples.push(f),this.audio_track_.length+=e.byteLength}},t.prototype.detectAudioMetadataChange=function(e){if(e.codec!==this.audio_metadata_.codec)return r.a.v(this.TAG,"Audio: Audio Codecs changed from "+"".concat(this.audio_metadata_.codec," to ").concat(e.codec)),!0;if("aac"===e.codec&&"aac"===this.audio_metadata_.codec){if((t=e.data).audio_object_type!==this.audio_metadata_.audio_object_type)return r.a.v(this.TAG,"AAC: AudioObjectType changed from "+"".concat(this.audio_metadata_.audio_object_type," to ").concat(t.audio_object_type)),!0;if(t.sampling_freq_index!==this.audio_metadata_.sampling_freq_index)return r.a.v(this.TAG,"AAC: SamplingFrequencyIndex changed from "+"".concat(this.audio_metadata_.sampling_freq_index," to ").concat(t.sampling_freq_index)),!0;if(t.channel_config!==this.audio_metadata_.channel_config)return r.a.v(this.TAG,"AAC: Channel configuration changed from "+"".concat(this.audio_metadata_.channel_config," to ").concat(t.channel_config)),!0}else if("ac-3"===e.codec&&"ac-3"===this.audio_metadata_.codec){var t;if((t=e.data).sampling_frequency!==this.audio_metadata_.sampling_frequency)return r.a.v(this.TAG,"AC3: Sampling Frequency changed from "+"".concat(this.audio_metadata_.sampling_frequency," to ").concat(t.sampling_frequency)),!0;if(t.bit_stream_identification!==this.audio_metadata_.bit_stream_identification)return r.a.v(this.TAG,"AC3: Bit Stream Identification changed from "+"".concat(this.audio_metadata_.bit_stream_identification," to ").concat(t.bit_stream_identification)),!0;if(t.bit_stream_mode!==this.audio_metadata_.bit_stream_mode)return r.a.v(this.TAG,"AC3: BitStream Mode changed from "+"".concat(this.audio_metadata_.bit_stream_mode," to ").concat(t.bit_stream_mode)),!0;if(t.channel_mode!==this.audio_metadata_.channel_mode)return r.a.v(this.TAG,"AC3: Channel Mode changed from "+"".concat(this.audio_metadata_.channel_mode," to ").concat(t.channel_mode)),!0;if(t.low_frequency_effects_channel_on!==this.audio_metadata_.low_frequency_effects_channel_on)return r.a.v(this.TAG,"AC3: Low Frequency Effects Channel On changed from "+"".concat(this.audio_metadata_.low_frequency_effects_channel_on," to ").concat(t.low_frequency_effects_channel_on)),!0}else if("opus"===e.codec&&"opus"===this.audio_metadata_.codec){if((i=e.meta).sample_rate!==this.audio_metadata_.sample_rate)return r.a.v(this.TAG,"Opus: SamplingFrequencyIndex changed from "+"".concat(this.audio_metadata_.sample_rate," to ").concat(i.sample_rate)),!0;if(i.channel_count!==this.audio_metadata_.channel_count)return r.a.v(this.TAG,"Opus: Channel count changed from "+"".concat(this.audio_metadata_.channel_count," to ").concat(i.channel_count)),!0}else if("mp3"===e.codec&&"mp3"===this.audio_metadata_.codec){var i;if((i=e.data).object_type!==this.audio_metadata_.object_type)return r.a.v(this.TAG,"MP3: AudioObjectType changed from "+"".concat(this.audio_metadata_.object_type," to ").concat(i.object_type)),!0;if(i.sample_rate!==this.audio_metadata_.sample_rate)return r.a.v(this.TAG,"MP3: SamplingFrequencyIndex changed from "+"".concat(this.audio_metadata_.sample_rate," to ").concat(i.sample_rate)),!0;if(i.channel_count!==this.audio_metadata_.channel_count)return r.a.v(this.TAG,"MP3: Channel count changed from "+"".concat(this.audio_metadata_.channel_count," to ").concat(i.channel_count)),!0}return!1},t.prototype.dispatchAudioInitSegment=function(e){var t={type:"audio"};if(t.id=this.audio_track_.id,t.timescale=1e3,t.duration=this.duration_,"aac"===this.audio_metadata_.codec){var i="aac"===e.codec?e.data:null,a=new X(i);t.audioSampleRate=a.sampling_rate,t.channelCount=a.channel_count,t.codec=a.codec_mimetype,t.originalCodec=a.original_codec_mimetype,t.config=a.config,t.refSampleDuration=1024/t.audioSampleRate*t.timescale}else if("ac-3"===this.audio_metadata_.codec){var n="ac-3"===e.codec?e.data:null,o=new Te(n);t.audioSampleRate=o.sampling_rate,t.channelCount=o.channel_count,t.codec=o.codec_mimetype,t.originalCodec=o.original_codec_mimetype,t.config=o.config,t.refSampleDuration=1536/t.audioSampleRate*t.timescale}else if("ec-3"===this.audio_metadata_.codec){var s="ec-3"===e.codec?e.data:null,_=new Re(s);t.audioSampleRate=_.sampling_rate,t.channelCount=_.channel_count,t.codec=_.codec_mimetype,t.originalCodec=_.original_codec_mimetype,t.config=_.config,t.refSampleDuration=256*_.num_blks/t.audioSampleRate*t.timescale}else"opus"===this.audio_metadata_.codec?(t.audioSampleRate=this.audio_metadata_.sample_rate,t.channelCount=this.audio_metadata_.channel_count,t.channelConfigCode=this.audio_metadata_.channel_config_code,t.codec="opus",t.originalCodec="opus",t.config=void 0,t.refSampleDuration=20):"mp3"===this.audio_metadata_.codec&&(t.audioSampleRate=this.audio_metadata_.sample_rate,t.channelCount=this.audio_metadata_.channel_count,t.codec="mp3",t.originalCodec="mp3",t.config=void 0);0==this.audio_init_segment_dispatched_&&r.a.v(this.TAG,"Generated first AudioSpecificConfig for mimeType: ".concat(t.codec)),this.onTrackMetadata("audio",t),this.audio_init_segment_dispatched_=!0;var d=this.media_info_;d.hasAudio=!0,d.audioCodec=t.originalCodec,d.audioSampleRate=t.audioSampleRate,d.audioChannelCount=t.channelCount,d.hasVideo&&d.videoCodec?d.mimeType='video/mp2t; codecs="'.concat(d.videoCodec,",").concat(d.audioCodec,'"'):d.mimeType='video/mp2t; codecs="'.concat(d.audioCodec,'"'),d.isComplete()&&this.onMediaInfo(d)},t.prototype.dispatchPESPrivateDataDescriptor=function(e,t,i){var a=new Z;a.pid=e,a.stream_type=t,a.descriptor=i,this.onPESPrivateDataDescriptor&&this.onPESPrivateDataDescriptor(a)},t.prototype.parsePESPrivateDataPayload=function(e,t,i,a,n){var r=new Q;if(r.pid=a,r.stream_id=n,r.len=e.byteLength,r.data=e,null!=t){var o=Math.floor(t/this.timescale_);r.pts=o}else r.nearest_pts=this.getNearestTimestampMilliseconds();if(null!=i){var s=Math.floor(i/this.timescale_);r.dts=s}this.onPESPrivateData&&this.onPESPrivateData(r)},t.prototype.parseTimedID3MetadataPayload=function(e,t,i,a,n){var r=new Q;if(r.pid=a,r.stream_id=n,r.len=e.byteLength,r.data=e,null!=t){var o=Math.floor(t/this.timescale_);r.pts=o}if(null!=i){var s=Math.floor(i/this.timescale_);r.dts=s}this.onTimedID3Metadata&&this.onTimedID3Metadata(r)},t.prototype.parseSynchronousKLVMetadataPayload=function(e,t,i,a,n){var r=new be;if(r.pid=a,r.stream_id=n,r.len=e.byteLength,r.data=e,null!=t){var o=Math.floor(t/this.timescale_);r.pts=o}if(null!=i){var s=Math.floor(i/this.timescale_);r.dts=s}r.access_units=function(e){for(var t=[],i=0;i+5<e.byteLength;){var a=e[i+0],n=e[i+1],r=e[i+2],o=e[i+3]<<8|e[i+4]<<0,s=e.slice(i+5,i+5+o);t.push({service_id:a,sequence_number:n,flags:r,data:s}),i+=5+o}return t}(e),this.onSynchronousKLVMetadata&&this.onSynchronousKLVMetadata(r)},t.prototype.parseAsynchronousKLVMetadataPayload=function(e,t,i){var a=new Q;a.pid=t,a.stream_id=i,a.len=e.byteLength,a.data=e,this.onAsynchronousKLVMetadata&&this.onAsynchronousKLVMetadata(a)},t.prototype.parseSMPTE2038MetadataPayload=function(e,t,i,a,n){var r=new me;if(r.pid=a,r.stream_id=n,r.len=e.byteLength,r.data=e,null!=t){var o=Math.floor(t/this.timescale_);r.pts=o}if(r.nearest_pts=this.getNearestTimestampMilliseconds(),null!=i){var s=Math.floor(i/this.timescale_);r.dts=s}r.ancillaries=function(e){for(var t=new f(e),i=0,a=[];;){if(i+=6,0!==t.readBits(6))break;var n=t.readBool();i+=1;var r=t.readBits(11);i+=11;var o=t.readBits(12);i+=12;var s=255&t.readBits(10);i+=10;var _=255&t.readBits(10);i+=10;var d=255&t.readBits(10);i+=10;for(var c=new Uint8Array(d),u=0;u<d;u++){var l=255&t.readBits(10);i+=10,c[u]=l}t.readBits(10);i+=10;var h="User Defined";65===s?7===_&&(h="SCTE-104"):95===s?220===_?h="ARIB STD-B37 (1SEG)":221===_?h="ARIB STD-B37 (ANALOG)":222===_?h="ARIB STD-B37 (SD)":223===_&&(h="ARIB STD-B37 (HD)"):97===s&&(1===_?h="EIA-708":2===_&&(h="EIA-608")),a.push({yc_indicator:n,line_number:r,horizontal_offset:o,did:s,sdid:_,user_data:c,description:h,information:{}}),t.readBits(8-(i-Math.floor(i/8))%8),i+=(8-(i-Math.floor(i/8)))%8}return t.destroy(),t=null,a}(e),this.onSMPTE2038Metadata&&this.onSMPTE2038Metadata(r)},t.prototype.getNearestTimestampMilliseconds=function(){return null!=this.audio_last_sample_pts_?Math.floor(this.audio_last_sample_pts_):null!=this.last_pcr_?Math.floor(this.last_pcr_/300/this.timescale_):void 0},t.prototype.getPcrBase=function(e){var t=33554432*e[6]+131072*e[7]+512*e[8]+2*e[9]+(128&e[10])/128+this.timestamp_offset_;return t+4294967296<this.last_pcr_base_&&(t+=8589934592,this.timestamp_offset_+=8589934592),this.last_pcr_base_=t,t},t.prototype.getTimestamp=function(e,t){var i=536870912*(14&e[t])+4194304*(255&e[t+1])+16384*(254&e[t+2])+128*(255&e[t+3])+(254&e[t+4])/2+this.timestamp_offset_;return i+4294967296<this.last_pcr_base_&&(i+=8589934592),i},t}(I),De=function(e,t,i){if(i||2===arguments.length)for(var a,n=0,r=t.length;n<r;n++)!a&&n in t||(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))},Le=function(){function e(){}return e.init=function(){for(var t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],hvc1:[],hvcC:[],av01:[],av1C:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[],Opus:[],dOps:[],"ac-3":[],dac3:[],"ec-3":[],dec3:[],fLaC:[],dfLa:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var i=e.constants={};i.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),i.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),i.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),i.STSC=i.STCO=i.STTS,i.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),i.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),i.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),i.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),i.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},e.box=function(e){for(var t=8,i=null,a=Array.prototype.slice.call(arguments,1),n=a.length,r=0;r<n;r++)t+=a[r].byteLength;(i=new Uint8Array(t))[0]=t>>>24&255,i[1]=t>>>16&255,i[2]=t>>>8&255,i[3]=255&t,i.set(e,4);var o=8;for(r=0;r<n;r++)i.set(a[r],o),o+=a[r].byteLength;return i},e.generateInitSegment=function(t){var i=e.box(e.types.ftyp,e.constants.FTYP),a=e.moov(t),n=new Uint8Array(i.byteLength+a.byteLength);return n.set(i,0),n.set(a,i.byteLength),n},e.moov=function(t){var i=e.mvhd(t.timescale,t.duration),a=e.trak(t),n=e.mvex(t);return e.box(e.types.moov,i,a,n)},e.mvhd=function(t,i){return e.box(e.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t,i>>>24&255,i>>>16&255,i>>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))},e.trak=function(t){return e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.tkhd=function(t){var i=t.id,a=t.duration,n=t.presentWidth,r=t.presentHeight;return e.box(e.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,255&i,0,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,255&a,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>>8&255,255&n,0,0,r>>>8&255,255&r,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t),e.hdlr(t),e.minf(t))},e.mdhd=function(t){var i=t.timescale,a=t.duration;return e.box(e.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,255&i,a>>>24&255,a>>>16&255,a>>>8&255,255&a,85,196,0,0]))},e.hdlr=function(t){var i=null;return i="audio"===t.type?e.constants.HDLR_AUDIO:e.constants.HDLR_VIDEO,e.box(e.types.hdlr,i)},e.minf=function(t){var i=null;return i="audio"===t.type?e.box(e.types.smhd,e.constants.SMHD):e.box(e.types.vmhd,e.constants.VMHD),e.box(e.types.minf,i,e.dinf(),e.stbl(t))},e.dinf=function(){return e.box(e.types.dinf,e.box(e.types.dref,e.constants.DREF))},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.constants.STTS),e.box(e.types.stsc,e.constants.STSC),e.box(e.types.stsz,e.constants.STSZ),e.box(e.types.stco,e.constants.STCO))},e.stsd=function(t){return"audio"===t.type?"mp3"===t.codec?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.mp3(t)):"ac-3"===t.codec?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.ac3(t)):"ec-3"===t.codec?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.ec3(t)):"opus"===t.codec?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.Opus(t)):"flac"==t.codec?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.fLaC(t)):e.box(e.types.stsd,e.constants.STSD_PREFIX,e.mp4a(t)):"video"===t.type&&t.codec.startsWith("hvc1")?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.hvc1(t)):"video"===t.type&&t.codec.startsWith("av01")?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.av01(t)):e.box(e.types.stsd,e.constants.STSD_PREFIX,e.avc1(t))},e.mp3=function(t){var i=t.channelCount,a=t.audioSampleRate,n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,i,0,16,0,0,0,0,a>>>8&255,255&a,0,0]);return e.box(e.types[".mp3"],n)},e.mp4a=function(t){var i=t.channelCount,a=t.audioSampleRate,n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,i,0,16,0,0,0,0,a>>>8&255,255&a,0,0]);return e.box(e.types.mp4a,n,e.esds(t))},e.ac3=function(t){var i=t.channelCount,a=t.audioSampleRate,n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,i,0,16,0,0,0,0,a>>>8&255,255&a,0,0]);return e.box(e.types["ac-3"],n,e.box(e.types.dac3,new Uint8Array(t.config)))},e.ec3=function(t){var i=t.channelCount,a=t.audioSampleRate,n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,i,0,16,0,0,0,0,a>>>8&255,255&a,0,0]);return e.box(e.types["ec-3"],n,e.box(e.types.dec3,new Uint8Array(t.config)))},e.esds=function(t){var i=t.config||[],a=i.length,n=new Uint8Array([0,0,0,0,3,23+a,0,1,0,4,15+a,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([a]).concat(i).concat([6,1,2]));return e.box(e.types.esds,n)},e.Opus=function(t){var i=t.channelCount,a=t.audioSampleRate,n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,i,0,16,0,0,0,0,a>>>8&255,255&a,0,0]);return e.box(e.types.Opus,n,e.dOps(t))},e.dOps=function(t){var i=t.channelCount,a=t.channelConfigCode,n=t.audioSampleRate;if(t.config)return e.box(e.types.dOps,t.config);var r=[];switch(a){case 1:case 2:r=[0];break;case 0:r=[255,1,1,0,1];break;case 128:r=[255,2,0,0,1];break;case 3:r=[1,2,1,0,2,1];break;case 4:r=[1,2,2,0,1,2,3];break;case 5:r=[1,3,2,0,4,1,2,3];break;case 6:r=[1,4,2,0,4,1,2,3,5];break;case 7:r=[1,4,2,0,4,1,2,3,5,6];break;case 8:r=[1,5,3,0,6,1,2,3,4,5,7];break;case 130:r=[1,1,2,0,1];break;case 131:r=[1,1,3,0,1,2];break;case 132:r=[1,1,4,0,1,2,3];break;case 133:r=[1,1,5,0,1,2,3,4];break;case 134:r=[1,1,6,0,1,2,3,4,5];break;case 135:r=[1,1,7,0,1,2,3,4,5,6];break;case 136:r=[1,1,8,0,1,2,3,4,5,6,7]}var o=new Uint8Array(De([0,i,0,0,n>>>24&255,n>>>17&255,n>>>8&255,n>>>0&255,0,0],r,!0));return e.box(e.types.dOps,o)},e.fLaC=function(t){var i=t.channelCount,a=Math.min(t.audioSampleRate,65535),n=t.sampleSize,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,i,0,n,0,0,0,0,a>>>8&255,255&a,0,0]);return e.box(e.types.fLaC,r,e.dfLa(t))},e.dfLa=function(t){var i=new Uint8Array(De([0,0,0,0],t.config,!0));return e.box(e.types.dfLa,i)},e.avc1=function(t){var i=t.avcc,a=t.codecWidth,n=t.codecHeight,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,a>>>8&255,255&a,n>>>8&255,255&n,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return e.box(e.types.avc1,r,e.box(e.types.avcC,i))},e.hvc1=function(t){var i=t.hvcc,a=t.codecWidth,n=t.codecHeight,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,a>>>8&255,255&a,n>>>8&255,255&n,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return e.box(e.types.hvc1,r,e.box(e.types.hvcC,i))},e.av01=function(t){var i=t.av1c,a=t.codecWidth||192,n=t.codecHeight||108,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,a>>>8&255,255&a,n>>>8&255,255&n,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return e.box(e.types.av01,r,e.box(e.types.av1C,i))},e.mvex=function(t){return e.box(e.types.mvex,e.trex(t))},e.trex=function(t){var i=t.id,a=new Uint8Array([0,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,255&i,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return e.box(e.types.trex,a)},e.moof=function(t,i){return e.box(e.types.moof,e.mfhd(t.sequenceNumber),e.traf(t,i))},e.mfhd=function(t){var i=new Uint8Array([0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t]);return e.box(e.types.mfhd,i)},e.traf=function(t,i){var a=t.id,n=e.box(e.types.tfhd,new Uint8Array([0,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,255&a])),r=e.box(e.types.tfdt,new Uint8Array([0,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,255&i])),o=e.sdtp(t),s=e.trun(t,o.byteLength+16+16+8+16+8+8);return e.box(e.types.traf,n,r,s,o)},e.sdtp=function(t){for(var i=t.samples||[],a=i.length,n=new Uint8Array(4+a),r=0;r<a;r++){var o=i[r].flags;n[r+4]=o.isLeading<<6|o.dependsOn<<4|o.isDependedOn<<2|o.hasRedundancy}return e.box(e.types.sdtp,n)},e.trun=function(t,i){var a=t.samples||[],n=a.length,r=12+16*n,o=new Uint8Array(r);i+=8+r,o.set([0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,255&n,i>>>24&255,i>>>16&255,i>>>8&255,255&i],0);for(var s=0;s<n;s++){var _=a[s].duration,d=a[s].size,c=a[s].flags,u=a[s].cts;o.set([_>>>24&255,_>>>16&255,_>>>8&255,255&_,d>>>24&255,d>>>16&255,d>>>8&255,255&d,c.isLeading<<2|c.dependsOn,c.isDependedOn<<6|c.hasRedundancy<<4|c.isNonSync,0,0,u>>>24&255,u>>>16&255,u>>>8&255,255&u],12+16*s)}return e.box(e.types.trun,o)},e.mdat=function(t){return e.box(e.types.mdat,t)},e}();Le.init();var Pe=Le,ke=function(){function e(){}return e.getSilentFrame=function(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},e}(),Ne=i(14),we=function(){function e(e){this.TAG="MP4Remuxer",this._config=e,this._isLive=!0===e.isLive,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new Ne.c("audio"),this._videoSegmentInfoList=new Ne.c("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!(!o.a.chrome||!(o.a.version.major<50||50===o.a.version.major&&o.a.version.build<2661)),this._fillSilentAfterSeek=o.a.msedge||o.a.msie,this._mp3UseMpegAudio=!o.a.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return e.prototype.destroy=function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null,this._onSystemClock=null},e.prototype.bindDataSource=function(e){return e.onDataAvailable=this.remux.bind(this),e.onSystemClock=this._onSystemClock.bind(this),e.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this},Object.defineProperty(e.prototype,"onInitSegment",{get:function(){return this._onInitSegment},set:function(e){this._onInitSegment=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onMediaSegment",{get:function(){return this._onMediaSegment},set:function(e){this._onMediaSegment=e},enumerable:!1,configurable:!0}),e.prototype.insertDiscontinuity=function(){this._audioNextDts=this._videoNextDts=void 0},e.prototype.seek=function(e){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()},e.prototype.remux=function(e,t,i){if(void 0===i&&(i=!1),!this._onMediaSegment)throw new u.a("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(e,t),t&&this._remuxVideo(t,i),e&&this._remuxAudio(e,i)},e.prototype._onTrackMetadataReceived=function(e,t){var i=null,a="mp4",n=t.codec;if("audio"===e)this._audioMeta=t,"mp3"===t.codec&&this._mp3UseMpegAudio?(a="mpeg",n="",i=new Uint8Array):i=Pe.generateInitSegment(t);else{if("video"!==e)return;this._videoMeta=t,i=Pe.generateInitSegment(t)}if(!this._onInitSegment)throw new u.a("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(e,{type:e,data:i.buffer,codec:n,container:"".concat(e,"/").concat(a),mediaDuration:t.duration})},Object.defineProperty(e.prototype,"onSystemClock",{get:function(){return this._onSystemClock},set:function(e){this._onSystemClock=e},enumerable:!1,configurable:!0}),e.prototype._onSystemClock=function(e,t){this._dtsBaseInited&&null!=this._onSystemClock&&this._onSystemClock(e-this._dtsBase/1e3,t)},e.prototype._calculateDtsBase=function(e,t){this._dtsBaseInited||(e&&e.samples&&e.samples.length&&(this._audioDtsBase=e.samples[0].dts),t&&t.samples&&t.samples.length&&(this._videoDtsBase=t.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)},e.prototype.getTimestampBase=function(){if(this._dtsBaseInited)return this._dtsBase},e.prototype.flushStashedSamples=function(){var e=this._videoStashedLastSample,t=this._audioStashedLastSample,i={type:"video",id:1,sequenceNumber:0,samples:[],length:0};null!=e&&(i.samples.push(e),i.length=e.length);var a={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};null!=t&&(a.samples.push(t),a.length=t.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(i,!0),this._remuxAudio(a,!0)},e.prototype._remuxAudio=function(e,t){if(null!=this._audioMeta){var i,a=e,n=a.samples,s=void 0,_=-1,d=this._audioMeta.refSampleDuration,c="mp3"===this._audioMeta.codec&&this._mp3UseMpegAudio,u=this._dtsBaseInited&&void 0===this._audioNextDts,l=!1;if((n&&0!==n.length||t&&null!=this._audioStashedLastSample)&&(1!==n.length||t)){var h=0,f=null,p=0;c?(h=0,p=a.length):(h=8,p=8+a.length);var m=null;if(n.length>1&&!t&&(p-=(m=n.pop()).length),null!=this._audioStashedLastSample){var g=this._audioStashedLastSample;this._audioStashedLastSample=null,n.unshift(g),p+=g.length}null!=m&&(this._audioStashedLastSample=m);var v=n[0].dts-this._dtsBase;if(this._audioNextDts)s=v-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())s=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&"mp3"!==this._audioMeta.originalCodec&&(l=!0);else{var E=this._audioSegmentInfoList.getLastSampleBefore(v);if(null!=E){var y=v-(E.originalDts+E.duration);y<=3&&(y=0),s=v-(E.dts+E.duration+y)}else s=0}if(l){var T=v-s,S=this._videoSegmentInfoList.getLastSegmentBefore(v);if(null!=S&&S.beginDts<T){if(k=ke.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount)){var A=S.beginDts,R=T-S.beginDts;r.a.v(this.TAG,"InsertPrefixSilentAudio: dts: ".concat(A,", duration: ").concat(R)),n.unshift({unit:k,dts:A,pts:A}),p+=k.byteLength}}else l=!1}for(var b=[],I=0;I<n.length;I++){var M=(g=n[I]).unit,O=g.dts-this._dtsBase,C=(A=O,!1),D=null,L=0;if(!(O<-.001)){if("mp3"!==this._audioMeta.codec&&null!=d){var P=O;if(this._audioNextDts&&(P=this._audioNextDts),(s=O-P)<=-3*d){r.a.w(this.TAG,"Dropping 1 audio frame (originalDts: ".concat(O," ms ,curRefDts: ").concat(P," ms)  due to dtsCorrection: ").concat(s," ms overlap."));continue}if(s>=3*d&&this._fillAudioTimestampGap&&!o.a.safari){C=!0;var k,N=Math.floor(s/d);r.a.w(this.TAG,"Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.\n"+"originalDts: ".concat(O," ms, curRefDts: ").concat(P," ms, ")+"dtsCorrection: ".concat(Math.round(s)," ms, generate: ").concat(N," frames")),A=Math.floor(P),L=Math.floor(P+d)-A,null==(k=ke.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount))&&(r.a.w(this.TAG,"Unable to generate silent frame for "+"".concat(this._audioMeta.originalCodec," with ").concat(this._audioMeta.channelCount," channels, repeat last frame")),k=M),D=[];for(var w=0;w<N;w++){P+=d;var U=Math.floor(P),B=Math.floor(P+d)-U,x={dts:U,pts:U,cts:0,unit:k,size:k.byteLength,duration:B,originalDts:O,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};D.push(x),p+=x.size}this._audioNextDts=P+d}else A=Math.floor(P),L=Math.floor(P+d)-A,this._audioNextDts=P+d}else{if(A=O-s,I!==n.length-1)L=n[I+1].dts-this._dtsBase-s-A;else if(null!=m)L=m.dts-this._dtsBase-s-A;else L=b.length>=1?b[b.length-1].duration:Math.floor(d);this._audioNextDts=A+L}-1===_&&(_=A),b.push({dts:A,pts:A,cts:0,unit:g.unit,size:g.unit.byteLength,duration:L,originalDts:O,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),C&&b.push.apply(b,D)}}if(0===b.length)return a.samples=[],void(a.length=0);c?f=new Uint8Array(p):((f=new Uint8Array(p))[0]=p>>>24&255,f[1]=p>>>16&255,f[2]=p>>>8&255,f[3]=255&p,f.set(Pe.types.mdat,4));for(I=0;I<b.length;I++){M=b[I].unit;f.set(M,h),h+=M.byteLength}var V=b[b.length-1];i=V.dts+V.duration;var G=new Ne.b;G.beginDts=_,G.endDts=i,G.beginPts=_,G.endPts=i,G.originalBeginDts=b[0].originalDts,G.originalEndDts=V.originalDts+V.duration,G.firstSample=new Ne.d(b[0].dts,b[0].pts,b[0].duration,b[0].originalDts,!1),G.lastSample=new Ne.d(V.dts,V.pts,V.duration,V.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(G),a.samples=b,a.sequenceNumber++;var F=null;F=c?new Uint8Array:Pe.moof(a,_),a.samples=[],a.length=0;var H={type:"audio",data:this._mergeBoxes(F,f).buffer,sampleCount:b.length,info:G};c&&u&&(H.timestampOffset=_),this._onMediaSegment("audio",H)}}},e.prototype._remuxVideo=function(e,t){if(null!=this._videoMeta){var i,a,n=e,r=n.samples,o=void 0,s=-1,_=-1;if(r&&0!==r.length){if(1!==r.length||t){var d=8,c=null,u=8+e.length,l=null;if(r.length>1&&!t&&(u-=(l=r.pop()).length),null!=this._videoStashedLastSample){var h=this._videoStashedLastSample;this._videoStashedLastSample=null,r.unshift(h),u+=h.length}null!=l&&(this._videoStashedLastSample=l);var f=r[0].dts-this._dtsBase;if(this._videoNextDts)o=f-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())o=0;else{var p=this._videoSegmentInfoList.getLastSampleBefore(f);if(null!=p){var m=f-(p.originalDts+p.duration);m<=3&&(m=0),o=f-(p.dts+p.duration+m)}else o=0}for(var g=new Ne.b,v=[],E=0;E<r.length;E++){var y=(h=r[E]).dts-this._dtsBase,T=h.isKeyframe,S=y-o,A=h.cts,R=S+A;-1===s&&(s=S,_=R);var b=0;if(E!==r.length-1)b=r[E+1].dts-this._dtsBase-o-S;else if(null!=l)b=l.dts-this._dtsBase-o-S;else b=v.length>=1?v[v.length-1].duration:Math.floor(this._videoMeta.refSampleDuration);if(T){var I=new Ne.d(S,R,b,h.dts,!0);I.fileposition=h.fileposition,g.appendSyncPoint(I)}v.push({dts:S,pts:R,cts:A,units:h.units,size:h.length,isKeyframe:T,duration:b,originalDts:y,flags:{isLeading:0,dependsOn:T?2:1,isDependedOn:T?1:0,hasRedundancy:0,isNonSync:T?0:1}})}(c=new Uint8Array(u))[0]=u>>>24&255,c[1]=u>>>16&255,c[2]=u>>>8&255,c[3]=255&u,c.set(Pe.types.mdat,4);for(E=0;E<v.length;E++)for(var M=v[E].units;M.length;){var O=M.shift().data;c.set(O,d),d+=O.byteLength}var C=v[v.length-1];if(i=C.dts+C.duration,a=C.pts+C.duration,this._videoNextDts=i,g.beginDts=s,g.endDts=i,g.beginPts=_,g.endPts=a,g.originalBeginDts=v[0].originalDts,g.originalEndDts=C.originalDts+C.duration,g.firstSample=new Ne.d(v[0].dts,v[0].pts,v[0].duration,v[0].originalDts,v[0].isKeyframe),g.lastSample=new Ne.d(C.dts,C.pts,C.duration,C.originalDts,C.isKeyframe),this._isLive||this._videoSegmentInfoList.append(g),n.samples=v,n.sequenceNumber++,this._forceFirstIDR){var D=v[0].flags;D.dependsOn=2,D.isNonSync=0}var L=Pe.moof(n,s);n.samples=[],n.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(L,c).buffer,sampleCount:v.length,info:g})}}else!t||this._videoStashedLastSample}},e.prototype._mergeBoxes=function(e,t){var i=new Uint8Array(e.byteLength+t.byteLength);return i.set(e,0),i.set(t,e.byteLength),i},e}(),Ue=i(17),Be=i(1),xe=(i(2),i(18)),Ve=i(11),Ge=i(15),Fe=i(16),He=i(13),Ye=i(25),je=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}(),qe=function(){return(qe=Object.assign||function(e){for(var t,i=1,a=arguments.length;i<a;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},ze=function(e){function t(t){var i=e.call(this)||this;return i.TAG="MMTTLVDemuxer",i.media_info_=new s.a,i.duration_=0,i.video_metadata_={vps:void 0,sps:void 0,pps:void 0,details:void 0},i.audio_metadata_={codec:void 0,audio_object_type:void 0,sampling_freq_index:void 0,sampling_frequency:void 0,channel_config:void 0},i.has_video_=!1,i.has_audio_=!1,i.video_init_segment_dispatched_=!1,i.audio_init_segment_dispatched_=!1,i.video_metadata_changed_=!1,i.loas_previous_frame=null,i.video_track_={type:"video",id:1,sequenceNumber:0,samples:[],length:0},i.audio_track_={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},i.reader_=new xe.MMTTLVReader,i.video_timestamps_=new Map,i.video_extended_timestamps_=new Map,i.audio_timestamp_desc_=new Map,i.audio_timestamps_=new Map,i.audio_extended_timestamp_desc_=new Map,i.audio_extended_timestamps_=new Map,i.video_mfu_queue_=[],i.video_access_unit_index_=0,i.video_mpu_sequence_number_=0,i.video_units_=[],i.audio_mfu_queue_=[],i.audio_access_unit_index_=0,i.audio_mpu_sequence_number_=0,i.selected_audio_component_tag_=0,i.find_video_rap_=!0,i.find_audio_rap_=!0,i.eventVersion=-1,i.mpt_version_=-1,i.reader_.addEventListener("plt",(function(e){return i.onPLT(e)})),i.reader_.addEventListener("mpt",(function(e){return i.onMPT(e)})),i.reader_.addEventListener("mpu",(function(e){return i.onMPU(e)})),i.reader_.addEventListener("ntp",(function(e){return i.onNTP(e)})),i.reader_.addEventListener("eit",(function(e){if("EIT[p/f]"===e.table.tableId&&0===e.table.sectionNumber&&e.table.currentNextIndicator){if(e.table.versionNumber===i.eventVersion)return;i.eventVersion=e.table.versionNumber;for(var t=0,a=e.table.events[0].descriptors;t<a.length;t++){var n=a[t];"mhShortEvent"===n.tag&&r.a.v(i.TAG,"event: ".concat((new TextDecoder).decode(n.eventName)," ").concat((new TextDecoder).decode(n.text)))}}})),i.config_=t,i}return je(t,e),t.prototype.destroy=function(){this.media_info_=null,this.video_metadata_=null,this.audio_metadata_=null,this.video_track_=null,this.audio_track_=null,e.prototype.destroy.call(this)},t.prototype.bindDataSource=function(e){return e.onDataArrival=this.parseChunks.bind(this),this},t.prototype.resetMediaInfo=function(){this.media_info_=new s.a},t.prototype.parseChunks=function(e,t){if(!(this.onError&&this.onMediaInfo&&this.onTrackMetadata&&this.onDataAvailable))throw new u.a("onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var i=performance.now()+performance.timeOrigin,a=this.system_clock_,n=this.system_clock_offset_;if(this.reader_.push(new Uint8Array(e)),this.dispatchAudioVideoMediaSegment(),null!=this.onSystemClock&&null!=this.system_clock_&&a!==this.system_clock_){var r=0;if(null!=a&&null!=n&&null!=this.system_clock_offset_){var o=this.system_clock_-a,s=this.system_clock_offset_-n;if(o>0&&s>0){var _=s/o;r=(this.reader_.bytes-this.system_clock_offset_)/_}}this.onSystemClock(this.system_clock_+r,i)}return e.byteLength},t.prototype.onPLT=function(e){var t=e.table.packages[0];null!=t&&(this.mpt_packet_id_=t.locationInfo.packetId)},t.prototype.resetVideo=function(){this.find_video_rap_=!0,this.video_mfu_queue_=[],this.video_units_=[]},t.prototype.resetAudio=function(){this.find_audio_rap_=!0,this.audio_mfu_queue_=[]},t.prototype.onMPT=function(e){var t,i,a,n,o,s,_=e.packetId,d=e.table;if(this.mpt_packet_id_===_){var c=this.mpt_version_!==d.version;this.mpt_version_=d.version;for(var u=!1,l=!1,h=-1,f=-1,p=new Set,m=0,g=d.assets;m<g.length;m++){var v=null===(t=(D=g[m]).locations[0])||void 0===t?void 0:t.packetId;if(D.assetType===Fe.MMT_ASSET_TYPE_MP4A){for(var E=!0,y=0,T=D.assetDescriptors;y<T.length;y++){"mhAudioComponent"===(F=T[y]).tag&&((F.streamContent!==He.MH_AUDIO_COMPONENT_STREAM_CONTENT_MPEG4_AAC||F.streamType!==He.STREAM_TYPE_LATM_LOAS)&&(E=!1),F.mainComponentFlag&&(h=v),this.selected_audio_component_tag_===F.componentTag&&(f=v))}E&&p.add(v)}}if(-1===f&&(f=h),c){for(var S=[],A=0,R=d.assets;A<R.length;A++){v=null===(i=(D=R[A]).locations[0])||void 0===i?void 0:i.packetId;if(p.has(v)){for(var b={id:String(S.length)},I=0,M=D.assetDescriptors;I<M.length;I++){if("mhAudioComponent"===(F=M[I]).tag){switch(b.label=(new TextDecoder).decode(F.text),F.samplingRate===He.SAMPLING_RATE_48000&&(b.samplingRate=48e3),b.main=F.mainComponentFlag,F.componentType&He.MH_AUDIO_COMPONENT_TYPE_MASK_SOUND_MODE){case He.MH_AUDIO_COMPONENT_TYPE_STEREO:b.channelLayoutName="stereo";break;case He.MH_AUDIO_COMPONENT_TYPE_5POINT1:b.channelLayoutName="5.1";break;case He.MH_AUDIO_COMPONENT_TYPE_7POINT1:b.channelLayoutName="7.1";break;case He.MH_AUDIO_COMPONENT_TYPE_22POINT2:b.channelLayoutName="22.2"}switch(F.componentType&He.MH_AUDIO_COMPONENT_TYPE_MASK_HANDICAPPED){case He.MH_AUDIO_COMPONENT_TYPE_COMMENTARY_FOR_VISUALLY_IMPAIRED:b.audioDescription="visually";break;case He.MH_AUDIO_COMPONENT_TYPE_FOR_HEARING_IMPAIRED:b.audioDescription="hearing"}b.language=String.fromCharCode(F.iso639LanguageCode>>16&255,F.iso639LanguageCode>>8&255,255&F.iso639LanguageCode),b.groupId=F.simulcastGroupTag.toString(16),b.id=F.componentTag.toString(16)}}S.push(b)}}null===(a=this.onAudioTracksMetadata)||void 0===a||a.call(this,S)}for(var O=0,C=d.assets;O<C.length;O++){var D;v=null===(n=(D=C[O]).locations[0])||void 0===n?void 0:n.packetId;if(l||D.assetType!==Fe.MMT_ASSET_TYPE_HEV1||(null!=this.video_packet_id_&&this.video_packet_id_!==v&&(r.a.v(this.TAG,"video packet id changed 0x".concat(this.video_packet_id_.toString(16)," => 0x").concat(v.toString(16))),this.resetVideo()),this.video_packet_id_=v,this.has_video_=!0,l=!0),!u&&p.has(v)&&v===f&&(null!=this.audio_packet_id_&&this.audio_packet_id_!==v&&(r.a.v(this.TAG,"audio packet id changed 0x".concat(this.audio_packet_id_.toString(16)," => 0x").concat(v.toString(16))),this.resetAudio()),this.audio_packet_id_=v,this.has_audio_=!0,u=!0),p.has(v)){1;for(var L=0,P=D.assetDescriptors;L<P.length;L++){if("mpuTimestamp"===(F=P[L]).tag){this.audio_timestamp_desc_.set(v,F);var k=null!==(o=this.audio_timestamps_.get(v))&&void 0!==o?o:new Map;this.audio_timestamps_.set(v,k);for(var N=0,w=F.timestamps;N<w.length;N++){var U=w[N];k.set(U.mpuSequenceNumber,U)}}else if("mpuExtendedTimestamp"===F.tag){this.audio_extended_timestamp_desc_.set(v,F);k=null!==(s=this.audio_extended_timestamps_.get(v))&&void 0!==s?s:new Map;this.audio_extended_timestamps_.set(v,k);for(var B=0,x=F.timestamps;B<x.length;B++){U=x[B];k.set(U.mpuSequenceNumber,U)}}}}if(l&&v===this.video_packet_id_)for(var V=0,G=D.assetDescriptors;V<G.length;V++){var F;if("mpuTimestamp"===(F=G[V]).tag){this.video_timestamp_desc_=F;for(var H=0,Y=F.timestamps;H<Y.length;H++){U=Y[H];this.video_timestamps_.set(U.mpuSequenceNumber,U)}}else if("mpuExtendedTimestamp"===F.tag){this.video_extended_timestamp_desc_=F;for(var j=0,q=F.timestamps;j<q.length;j++){U=q[j];this.video_extended_timestamps_.set(U.mpuSequenceNumber,U)}}}}}},t.prototype.insertDiscontinuity=function(){this.resetVideo(),this.resetAudio(),this.video_track_={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this.audio_track_={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this.video_init_segment_dispatched_=!1,this.audio_init_segment_dispatched_=!1,this.reader_.reset(),this.system_clock_=void 0,this.system_clock_offset_=null,this.mpt_version_=-1},t.prototype.addVideoSample=function(e,t){var i,a,n=this.video_timestamp_desc_,r=this.video_extended_timestamp_desc_;if(null!=n&&null!=r){var o=this.video_timestamps_.get(e),s=this.video_extended_timestamps_.get(e);if(null!=o&&null!=s){var _=r.timescale,d=r.defaultPTSOffset;if(null!=_&&null!=d){var c=Math.floor((o.mpuPresentationTime.seconds+o.mpuPresentationTime.fractional*Math.pow(2,-32))*_)+t*d,u=c+(null!==(a=null===(i=s.accessUnits[t])||void 0===i?void 0:i.dtsPTSOffset)&&void 0!==a?a:0),l=Math.floor(1e3*c/_),h=Math.floor(1e3*u/_),f={units:this.video_units_,length:this.video_units_.reduce((function(e,t){return e+t.data.length}),0),isKeyframe:this.video_units_.some((function(e){return e.type===J.kSliceIDR_W_RADL||e.type===J.kSliceIDR_N_LP||e.type===J.kSliceCRA_NUT})),dts:l,pts:h,cts:h-l};this.video_units_=[],this.video_track_.samples.push(f),this.video_track_.length+=f.length}}}},t.prototype.onMPU=function(e){var t=e.mmtHeader,i=e.mpu;t.packetId===this.audio_packet_id_&&this.processAudioMPU(t,i),t.packetId===this.video_packet_id_&&this.processVideoMPU(t,i)},t.prototype.onNTP=function(e){var t=e.ntp,i=e.offset;this.system_clock_=Object(Ye.ntp64TimestampToSeconds)(t.transmitTimestamp),this.system_clock_offset_=i},t.prototype.processAudioMPU=function(e,t){var i,a,n,r;if("mfu"===t.fragmentType&&t.timedFlag&&(this.audio_mpu_sequence_number_!==t.mpuSequenceNumber&&(this.audio_mfu_queue_=[]),(!this.find_audio_rap_||e.rapFlag)&&((e.rapFlag||this.audio_mpu_sequence_number_!==t.mpuSequenceNumber)&&(this.audio_mpu_sequence_number_=t.mpuSequenceNumber,this.audio_access_unit_index_=0),this.find_audio_rap_=!1,t.fragmentationIndicator!==Ve.MMTP_FRAGMENTATION_INDICATOR_MIDDLE||0!==this.audio_mfu_queue_.length))){t.fragmentationIndicator!==Ve.MMTP_FRAGMENTATION_INDICATOR_HEAD&&t.fragmentationIndicator!==Ve.MMTP_FRAGMENTATION_INDICATOR_COMPLETE||(this.audio_mfu_queue_=[]);for(var o=0,s=t.mfuList;o<s.length;o++){var _=s[o];this.audio_mfu_queue_.push(_.mfuData)}if(t.fragmentationIndicator===Ve.MMTP_FRAGMENTATION_INDICATOR_COMPLETE||t.fragmentationIndicator===Ve.MMTP_FRAGMENTATION_INDICATOR_TAIL){var d=t.fragmentationIndicator===Ve.MMTP_FRAGMENTATION_INDICATOR_COMPLETE?this.audio_mfu_queue_:[Object(Ge.concatBuffers)(this.audio_mfu_queue_)];this.audio_mfu_queue_=[];for(var c=0,u=d;c<u.length;c++){var l=u[c],h=this.audio_access_unit_index_,f=t.mpuSequenceNumber,p=this.audio_timestamp_desc_.get(e.packetId),m=this.audio_extended_timestamp_desc_.get(e.packetId);if(null==p||null==m)return;var g=null===(i=this.audio_timestamps_.get(e.packetId))||void 0===i?void 0:i.get(f),v=null===(a=this.audio_extended_timestamps_.get(e.packetId))||void 0===a?void 0:a.get(f);if(null==g||null==v)return;var E=m.timescale,y=m.defaultPTSOffset;if(null==E||null==y)return;var T=Math.floor((g.mpuPresentationTime.seconds+g.mpuPresentationTime.fractional*Math.pow(2,-32))*E)+h*y,S=T+(null!==(r=null===(n=v.accessUnits[h])||void 0===n?void 0:n.dtsPTSOffset)&&void 0!==r?r:0),A=Math.floor(1e3*T/E),R=Math.floor(1e3*S/E),b=K(l,this.loas_previous_frame);if(null!=b){this.loas_previous_frame=b;var I={codec:"aac",data:b};(!1===this.audio_init_segment_dispatched_||this.detectAudioMetadataChange(I))&&(this.audio_metadata_={codec:"aac",audio_object_type:b.audio_object_type,sampling_freq_index:b.sampling_freq_index,sampling_frequency:b.sampling_frequency,channel_config:b.channel_config},this.dispatchAudioMediaSegment(!0),this.dispatchAudioInitSegment(I));var M=b.data,O={unit:M,length:M.byteLength,pts:R,dts:A};this.audio_track_.samples.push(O),this.audio_track_.length+=M.byteLength,this.audio_access_unit_index_+=1}else this.audio_access_unit_index_+=1}}}},t.prototype.processVideoMPU=function(e,t){if("mfu"===t.fragmentType&&t.timedFlag&&(this.video_mpu_sequence_number_!==t.mpuSequenceNumber&&(this.video_mfu_queue_=[]),(!this.find_video_rap_||e.rapFlag)&&((e.rapFlag||this.video_mpu_sequence_number_!==t.mpuSequenceNumber)&&(this.find_video_rap_||this.addVideoSample(this.video_mpu_sequence_number_,this.video_access_unit_index_),this.video_access_unit_index_=0,this.video_mpu_sequence_number_=t.mpuSequenceNumber),this.find_video_rap_=!1,t.fragmentationIndicator!==Ve.MMTP_FRAGMENTATION_INDICATOR_MIDDLE||0!==this.video_mfu_queue_.length))){t.fragmentationIndicator!==Ve.MMTP_FRAGMENTATION_INDICATOR_HEAD&&t.fragmentationIndicator!==Ve.MMTP_FRAGMENTATION_INDICATOR_COMPLETE||(this.video_mfu_queue_=[]);for(var i=0,a=t.mfuList;i<a.length;i++){var n=a[i];this.video_mfu_queue_.push(n.mfuData)}if(t.fragmentationIndicator===Ve.MMTP_FRAGMENTATION_INDICATOR_COMPLETE||t.fragmentationIndicator===Ve.MMTP_FRAGMENTATION_INDICATOR_TAIL){var o,s,_=t.fragmentationIndicator===Ve.MMTP_FRAGMENTATION_INDICATOR_COMPLETE?this.video_mfu_queue_:[Object(Ge.concatBuffers)(this.video_mfu_queue_)];this.video_mfu_queue_=[];for(var d=0,c=_;d<c.length;d++){var u=c[d],l=u[0]<<24|u[1]<<16|u[2]<<8|u[3],h=new he(u.subarray(0,l+4)),f=u.subarray(4);switch(h.type){case J.kSliceVPS:var p=g.parseVPS(h.data);this.video_metadata_.vps=h,this.video_metadata_.details=qe(qe({},this.video_metadata_.details),p),o=h,s=p;break;case J.kSliceSPS:p=g.parseSPS(f);this.video_init_segment_dispatched_?!0===this.detectVideoMetadataChange(h,p)&&(r.a.v(this.TAG,"H265: Critical h265 metadata has been changed, attempt to re-generate InitSegment"),this.video_metadata_changed_=!0,this.video_metadata_={vps:o,sps:h,pps:void 0,details:qe(qe({},s),p)}):(this.video_metadata_.sps=h,this.video_metadata_.details=qe(qe({},this.video_metadata_.details),p));break;case J.kSlicePPS:if(!this.video_init_segment_dispatched_||this.video_metadata_changed_){p=g.parsePPS(f);this.video_metadata_.pps=h,this.video_metadata_.details=qe(qe({},this.video_metadata_.details),p),this.video_metadata_.vps&&this.video_metadata_.sps&&this.video_metadata_.pps&&(this.video_metadata_changed_&&this.dispatchVideoMediaSegment(!0),this.dispatchVideoInitSegment())}}this.video_init_segment_dispatched_&&(h.type!==J.kSliceVPS&&h.type!==J.kSliceSPS&&h.type!==J.kSlicePPS&&(h.type===J.kSliceAUD&&this.video_units_.length>0&&(this.addVideoSample(this.video_mpu_sequence_number_,this.video_access_unit_index_),this.video_access_unit_index_+=1),this.video_units_.push(h)))}}}},t.prototype.detectVideoMetadataChange=function(e,t){if(t.codec_mimetype!==this.video_metadata_.details.codec_mimetype)return r.a.v(this.TAG,"Video: Codec mimeType changed from "+"".concat(this.video_metadata_.details.codec_mimetype," to ").concat(t.codec_mimetype)),!0;if(t.codec_size.width!==this.video_metadata_.details.codec_size.width||t.codec_size.height!==this.video_metadata_.details.codec_size.height){var i=this.video_metadata_.details.codec_size,a=t.codec_size;return r.a.v(this.TAG,"Video: Coded Resolution changed from "+"".concat(i.width,"x").concat(i.height," to ").concat(a.width,"x").concat(a.height)),!0}return t.present_size.width!==this.video_metadata_.details.present_size.width?(r.a.v(this.TAG,"Video: Present resolution width changed from "+"".concat(this.video_metadata_.details.present_size.width," to ").concat(t.present_size.width)),!0):t.colour_primaries!==this.video_metadata_.details.colour_primaries?(r.a.v(this.TAG,"Video: Colour primaries changed from "+"".concat(this.video_metadata_.details.colour_primaries," to ").concat(t.colour_primaries)),!0):t.transfer_characteristics!==this.video_metadata_.details.transfer_characteristics?(r.a.v(this.TAG,"Video: Transfer characteristics changed from "+"".concat(this.video_metadata_.details.transfer_characteristics," to ").concat(t.transfer_characteristics)),!0):t.matrix_coeffs!==this.video_metadata_.details.matrix_coeffs&&(r.a.v(this.TAG,"Video: Matrix coeffs changed from "+"".concat(this.video_metadata_.details.matrix_coeffs," to ").concat(t.matrix_coeffs)),!0)},t.prototype.isInitSegmentDispatched=function(){return this.has_video_&&this.has_audio_?this.video_init_segment_dispatched_&&this.audio_init_segment_dispatched_:this.has_video_&&!this.has_audio_?this.video_init_segment_dispatched_:!(this.has_video_||!this.has_audio_)&&this.audio_init_segment_dispatched_},t.prototype.dispatchVideoInitSegment=function(){var e=this.video_metadata_.details,t={type:"video"};t.id=this.video_track_.id,t.timescale=1e3,t.duration=this.duration_,t.codecWidth=e.codec_size.width,t.codecHeight=e.codec_size.height,t.presentWidth=e.present_size.width,t.presentHeight=e.present_size.height,t.profile=e.profile_string,t.level=e.level_string,t.bitDepth=e.bit_depth,t.chromaFormat=e.chroma_format,t.sarRatio=e.sar_ratio,t.frameRate=e.frame_rate;var i=t.frameRate.fps_den,a=t.frameRate.fps_num;if(t.refSampleDuration=i/a*1e3,t.codec=e.codec_mimetype,this.video_metadata_.vps){var n=this.video_metadata_.vps.data.subarray(4),o=this.video_metadata_.sps.data.subarray(4),s=this.video_metadata_.pps.data.subarray(4),_=new pe(n,o,s,e);t.hvcc=_.getData(),0==this.video_init_segment_dispatched_&&r.a.v(this.TAG,"Generated first HEVCDecoderConfigurationRecord for mimeType: ".concat(t.codec))}this.onTrackMetadata("video",t),this.video_init_segment_dispatched_=!0,this.video_metadata_changed_=!1;var d=this.media_info_;d.hasVideo=!0,d.width=t.codecWidth,d.height=t.codecHeight,d.fps=t.frameRate.fps,d.profile=t.profile,d.level=t.level,d.refFrames=e.ref_frames,d.chromaFormat=e.chroma_format_string,d.sarNum=t.sarRatio.width,d.sarDen=t.sarRatio.height,d.videoCodec=t.codec,d.hasAudio&&d.audioCodec?d.mimeType='video/mp2t; codecs="'.concat(d.videoCodec,",").concat(d.audioCodec,'"'):d.mimeType='video/mp2t; codecs="'.concat(d.videoCodec,'"'),d.isComplete()&&this.onMediaInfo(d)},t.prototype.dispatchVideoMediaSegment=function(e){void 0===e&&(e=!1),this.isInitSegmentDispatched()&&(e||this.video_track_.length)&&this.onDataAvailable(null,this.video_track_,e)},t.prototype.dispatchAudioMediaSegment=function(e){void 0===e&&(e=!1),this.isInitSegmentDispatched()&&(e||this.audio_track_.length)&&this.onDataAvailable(this.audio_track_,null,e)},t.prototype.dispatchAudioVideoMediaSegment=function(){this.isInitSegmentDispatched()&&(this.audio_track_.length||this.video_track_.length)&&this.onDataAvailable(this.audio_track_,this.video_track_)},t.prototype.detectAudioMetadataChange=function(e){if(e.codec!==this.audio_metadata_.codec)return r.a.v(this.TAG,"Audio: Audio Codecs changed from "+"".concat(this.audio_metadata_.codec," to ").concat(e.codec)),!0;if("aac"===e.codec&&"aac"===this.audio_metadata_.codec){var t=e.data;if(t.audio_object_type!==this.audio_metadata_.audio_object_type)return r.a.v(this.TAG,"AAC: AudioObjectType changed from "+"".concat(this.audio_metadata_.audio_object_type," to ").concat(t.audio_object_type)),!0;if(t.sampling_freq_index!==this.audio_metadata_.sampling_freq_index)return r.a.v(this.TAG,"AAC: SamplingFrequencyIndex changed from "+"".concat(this.audio_metadata_.sampling_freq_index," to ").concat(t.sampling_freq_index)),!0;if(t.channel_config!==this.audio_metadata_.channel_config)return r.a.v(this.TAG,"AAC: Channel configuration changed from "+"".concat(this.audio_metadata_.channel_config," to ").concat(t.channel_config)),!0}return!1},t.prototype.dispatchAudioInitSegment=function(e){var t={type:"audio"};if(t.id=this.audio_track_.id,t.timescale=1e3,t.duration=this.duration_,"aac"===this.audio_metadata_.codec){var i="aac"===e.codec?e.data:null,a=new X(i);t.audioSampleRate=a.sampling_rate,t.channelCount=a.channel_count,t.codec=a.codec_mimetype,t.originalCodec=a.original_codec_mimetype,t.config=a.config,t.refSampleDuration=1024/t.audioSampleRate*t.timescale}0==this.audio_init_segment_dispatched_&&r.a.v(this.TAG,"Generated first AudioSpecificConfig for mimeType: ".concat(t.codec)),this.onTrackMetadata("audio",t),this.audio_init_segment_dispatched_=!0;var n=this.media_info_;n.hasAudio=!0,n.audioCodec=t.originalCodec,n.audioSampleRate=t.audioSampleRate,n.audioChannelCount=t.channelCount,n.hasVideo&&n.videoCodec?n.mimeType='video/mp2t; codecs="'.concat(n.videoCodec,",").concat(n.audioCodec,'"'):n.mimeType='video/mp2t; codecs="'.concat(n.audioCodec,'"'),n.isComplete()&&this.onMediaInfo(n)},t.prototype.switchAudioTrack=function(e){this.selected_audio_component_tag_=parseInt(e,16)},t}(I),Ke=function(e,t,i,a){return new(i||(i=Promise))((function(n,r){function o(e){try{_(a.next(e))}catch(e){r(e)}}function s(e){try{_(a.throw(e))}catch(e){r(e)}}function _(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,s)}_((a=a.apply(e,t||[])).next())}))},We=function(e,t){var i,a,n,r,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(_){return function(s){if(i)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(i=1,a&&(n=2&s[0]?a.return:s[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,s[1])).done)return n;switch(a=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(6===s[0]&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{i=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,_])}}},Xe=function(){function e(e,t,i){this.TAG="MMTTLVSeekLocator",this.duration_probe_size=4194304,this.duration_probe_size_limit=33554432,this.max_seek_error_seconds=10,this.rap_cache=new Map,this.mediaDataSource_=e,this.config_=t,this.seek_info=this.probeSeekInfo(i)}return e.prototype.probeSeekInfo=function(e){return Ke(this,void 0,void 0,(function(){var t,i,a,n,o,s,_,d;return We(this,(function(c){switch(c.label){case 0:return[4,this.probeFirstTimestamp(0,this.duration_probe_size_limit)];case 1:if(t=c.sent(),i=t.video_timestamp,a=t.audio_timestamp,n=t.contentLength,null==i||null==a||null==n)return r.a.e(this.TAG,"probeSeekInfo: probeFirstTimestamp failed"),[2,void 0];r.a.v(this.TAG,"probeSeekInfo: video_timestamp=".concat(i," audio_timestamp=").concat(a)),o=Math.min(i,a),_=this.duration_probe_size,c.label=2;case 2:return null!=s?[3,4]:(d=Math.max(n-_,0),[4,this.probeLastTimestamp(d)]);case 3:return s=c.sent(),(_*=2)>this.duration_probe_size_limit||d===Math.max(n-_,0)?(r.a.e(this.TAG,"probeSeekInfo: probeLastTimestamp failed"),[2,void 0]):[3,2];case 4:return e(s-o),[2,{first_timestamp:o,last_timestamp:s,estimated_bitrate:8*n/(s-o),content_length:n}]}}))}))},e.prototype.probeFirstTimestamp=function(e,t,i){var a,n,r,o,s,_=new Ue.a(this.mediaDataSource_,this.config_,0,"probe"),d=new xe.MMTTLVReader;d.addEventListener("plt",(function(e){a=e.table.packages[0].locationInfo.packetId}));var c=new Map,u=new Map;return d.addEventListener("mpt",(function(e){var t;if(e.packetId===a)for(var i=0,r=e.table.assets;i<r.length;i++){var s=r[i],_=null===(t=s.locations[0])||void 0===t?void 0:t.packetId;if(null==n&&s.assetType===Fe.MMT_ASSET_TYPE_HEV1&&(n=_),null==o&&s.assetType===Fe.MMT_ASSET_TYPE_MP4A&&(o=_),_===n)for(var d=0,l=s.assetDescriptors;d<l.length;d++){if("mpuTimestamp"===(v=l[d]).tag){v;for(var h=0,f=v.timestamps;h<f.length;h++){var p=f[h];c.set(p.mpuSequenceNumber,p)}}}if(_===o)for(var m=0,g=s.assetDescriptors;m<g.length;m++){var v;if("mpuTimestamp"===(v=g[m]).tag){v;for(var E=0,y=v.timestamps;E<y.length;E++){p=y[E];u.set(p.mpuSequenceNumber,p)}}}}})),d.addEventListener("mpu",(function(e){if(e.mmtHeader.packetId===n){if(!e.mmtHeader.rapFlag)return;if(null!=r)return;r=e.mpu.mpuSequenceNumber}if(e.mmtHeader.packetId===o){if(!e.mmtHeader.rapFlag)return;if(null!=s)return;s=e.mpu.mpuSequenceNumber}})),new Promise((function(a,n){var o=0,l=function(){_.destroy(),n("aborted")};null==i||i.addEventListener("abort",l),_.onDataArrival=function(e,n){if(d.push(new Uint8Array(e)),o+=e.byteLength,null!=r&&null!=s){var h=1/0;c.forEach((function(e,t){h=Math.min(h,t)}));var f=c.get(Math.max(h,r)),p=1/0;u.forEach((function(e,t){p=Math.min(p,t)}));var m=u.get(Math.max(p,s));if(null!=f&&null!=m)return _.destroy(),null==i||i.removeEventListener("abort",l),void a({video_timestamp:f.mpuPresentationTime.seconds+f.mpuPresentationTime.fractional*Math.pow(2,-32),audio_timestamp:m.mpuPresentationTime.seconds+m.mpuPresentationTime.fractional*Math.pow(2,-32),contentLength:_.totalLength})}o>=t&&(_.destroy(),null==i||i.removeEventListener("abort",l),a({contentLength:_.totalLength}))},_.onComplete=function(){_.destroy(),null==i||i.removeEventListener("abort",l),a({contentLength:_.totalLength})},_.onError=function(e,t){_.destroy(),null==i||i.removeEventListener("abort",l),n("error ".concat(e," ").concat(t.msg))},_.open(e)}))},e.prototype.probeLastTimestamp=function(e,t){return Ke(this,void 0,void 0,(function(){var i,a,n,r,o,s,_,d;return We(this,(function(c){return i=new Ue.a(this.mediaDataSource_,this.config_,0,"probe"),(a=new xe.MMTTLVReader).addEventListener("plt",(function(e){n=e.table.packages[0].locationInfo.packetId})),s=new Map,d=new Map,a.addEventListener("mpt",(function(e){var t;if(e.packetId===n)for(var i=0,a=e.table.assets;i<a.length;i++){var o=a[i],c=null===(t=o.locations[0])||void 0===t?void 0:t.packetId;if(null==r&&o.assetType===Fe.MMT_ASSET_TYPE_HEV1&&(r=c),c===r)for(var u=0,l=o.assetDescriptors;u<l.length;u++){var h=l[u];if("mpuTimestamp"===h.tag){h;for(var f=0,p=h.timestamps;f<p.length;f++){var m=p[f];s.set(m.mpuSequenceNumber,m)}}else if("mpuExtendedTimestamp"===h.tag){_=h;for(var g=0,v=h.timestamps;g<v.length;g++){m=v[g];d.set(m.mpuSequenceNumber,m)}}}}})),a.addEventListener("mpu",(function(e){e.mmtHeader.packetId===r&&e.mmtHeader.rapFlag&&(o=e.mpu.mpuSequenceNumber)})),[2,new Promise((function(n,r){var d,c=0;i.onDataArrival=function(e,r){if(a.push(new Uint8Array(e)),c+=e.byteLength,null!=o){var u=s.get(o);if(null!=u&&(d=u.mpuPresentationTime.seconds+u.mpuPresentationTime.fractional*Math.pow(2,-32),null!=_)){var l=_.defaultPTSOffset,h=_.timescale;null!=l&&null!=h&&(d+=l/h)}}null!=t&&c>=t&&(i.destroy(),n(d))},i.onComplete=function(){i.destroy(),n(d)},i.onError=function(e,t){i.destroy(),n(void 0)},i.open(e)}))]}))}))},e.prototype.estimateCBR=function(e,t,i){return Ke(this,void 0,void 0,(function(){var a,n,o,s,_,d,c,u,l,h;return We(this,(function(f){switch(f.label){case 0:return a=t.first_timestamp,n=t.estimated_bitrate,o=Math.floor(n*Math.max(0,e-1)/8),i.aborted?[2,void 0]:null==(s=this.rap_cache.get(o))?[3,1]:(d=s,[3,3]);case 1:return[4,this.probeFirstTimestamp(o,33554432,i)];case 2:d=f.sent(),f.label=3;case 3:return null==(_=d)?[2,void 0]:(this.rap_cache.set(o,_),c=_.video_timestamp,u=_.audio_timestamp,null==c||null==u?[2,void 0]:(l=Math.min(c,u),h=e-(l-a),r.a.v(this.TAG,"probe RAP CBR".concat(s?" (cached)":""," offset=").concat(o," ts=").concat(l-t.first_timestamp," delta=").concat(h)),h>=0&&h<this.max_seek_error_seconds?h<.5?[2,Math.max(0,o-Math.floor(t.estimated_bitrate/8/2))]:[2,o]:[2,void 0]))}}))}))},e.prototype.estimateVBR=function(e,t,i){return Ke(this,void 0,void 0,(function(){var a,n,o,s,_,d,c,u,l,h,f;return We(this,(function(p){switch(p.label){case 0:a=0,n=t.content_length-1,o=a+Math.floor((n-a)/2),p.label=1;case 1:return a<=n?i.aborted?[2,void 0]:null==(s=this.rap_cache.get(o))?[3,2]:(d=s,[3,4]):[3,5];case 2:return[4,this.probeFirstTimestamp(o,33554432,i)];case 3:d=p.sent(),p.label=4;case 4:return _=d,this.rap_cache.set(o,_),c=_.video_timestamp,u=_.audio_timestamp,null==c||null==u?[2,void 0]:(l=Math.max(c,u),h=e-(l-t.first_timestamp),r.a.v(this.TAG,"probe RAP VBR".concat(s?" (cached)":""," offset=").concat(o," ts=").concat(l-t.first_timestamp," delta=").concat(h)),h>=0&&h<this.max_seek_error_seconds?h<.5?[2,Math.max(0,o-Math.floor(t.estimated_bitrate/8/2))]:[2,o]:(h>0?a=o+1:n=o-1,f=a+Math.floor((n-a)/2),Math.abs(f-o)<=32768?[2,Math.min(f,o)]:(o=f,[3,1])));case 5:return[2,void 0]}}))}))},e.prototype.locateSeekPosition=function(e,t){return Ke(this,void 0,void 0,(function(){var i,a,n,o;return We(this,(function(s){switch(s.label){case 0:if((i=e/1e3)<this.max_seek_error_seconds){if(t.aborted)throw"aborted";return[2,0]}return[4,this.seek_info];case 1:if(null==(a=s.sent()))throw"locateSeekPosition failed.";return[4,this.estimateCBR(i,a,t)];case 2:if(null!=(n=s.sent())){if(t.aborted)throw"aborted";return[2,n]}return r.a.v(this.TAG,"CBR estimation failed, falling back to VBR estimation."),[4,this.estimateVBR(i,a,t)];case 3:if(null!=(o=s.sent()))throw"locateSeekPosition failed.";if(t.aborted)throw"aborted";return[2,o]}}))}))},e}(),Qe=function(){function e(e,t){this.TAG="TransmuxingController",this._emitter=new n.a,this._config=t,e.segments||(e.segments=[{duration:e.duration,filesize:e.filesize,url:e.url}]),"boolean"!=typeof e.cors&&(e.cors=!0),"boolean"!=typeof e.withCredentials&&(e.withCredentials=!1),this._mediaDataSource=e,this._currentSegmentIndex=0;var i=0;this._mediaDataSource.segments.forEach((function(a){a.timestampBase=i,i+=a.duration,a.cors=e.cors,a.withCredentials=e.withCredentials,t.referrerPolicy&&(a.referrerPolicy=t.referrerPolicy)})),isNaN(i)||this._mediaDataSource.duration===i||(this._mediaDataSource.duration=i),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null,this._seekLocator=null}return e.prototype.destroy=function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null},e.prototype.on=function(e,t){this._emitter.addListener(e,t)},e.prototype.off=function(e,t){this._emitter.removeListener(e,t)},e.prototype.start=function(){this._loadSegment(0),this._enableStatisticsReporter()},e.prototype._loadSegment=function(e,t){this._currentSegmentIndex=e;var i=this._mediaDataSource.segments[e],a=this._ioctl=new Ue.a(i,this._config,e);a.onError=this._onIOException.bind(this),a.onSeeked=this._onIOSeeked.bind(this),a.onComplete=this._onIOComplete.bind(this),a.onRedirect=this._onIORedirect.bind(this),a.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),t?this._demuxer.bindDataSource(this._ioctl):a.onDataArrival=this._onInitChunkArrival.bind(this),a.open(t)},e.prototype.stop=function(){this._internalAbort(),this._disableStatisticsReporter()},e.prototype._internalAbort=function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)},e.prototype.pause=function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())},e.prototype.resume=function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())},e.prototype.seek=function(e){var t=this;if(null==this._mediaInfo||!this._mediaInfo.isSeekable()){var i=this._seekLocator;if(null==i)return;return null!=this._pendingSeekAbortController&&(this._pendingSeekAbortController.abort(),this._pendingSeekAbortController=null),this._pendingSeekAbortController=new AbortController,void i.locateSeekPosition(e,this._pendingSeekAbortController.signal).then((function(e){t._internalAbort(),t._remuxer.seek(),t._remuxer.insertDiscontinuity(),t._demuxer.insertDiscontinuity(),t._loadSegment(t._currentSegmentIndex,e)})).catch((function(i){r.a.e(t.TAG,"seek to ".concat(e," failed: ").concat(i))}))}var a=this._searchSegmentIndexContains(e);if(a===this._currentSegmentIndex){var n=this._mediaInfo.segments[a];if(null==n)this._pendingSeekTime=e;else{var o=n.getNearestKeyframe(e);this._remuxer.seek(o.milliseconds),this._ioctl.seek(o.fileposition),this._pendingResolveSeekPoint=o.milliseconds}}else{var s=this._mediaInfo.segments[a];if(null==s)this._pendingSeekTime=e,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(a);else{o=s.getNearestKeyframe(e);this._internalAbort(),this._remuxer.seek(e),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[a].timestampBase,this._loadSegment(a,o.fileposition),this._pendingResolveSeekPoint=o.milliseconds,this._reportSegmentMediaInfo(a)}}this._enableStatisticsReporter()},e.prototype._searchSegmentIndexContains=function(e){for(var t=this._mediaDataSource.segments,i=t.length-1,a=0;a<t.length;a++)if(e<t[a].timestampBase){i=a-1;break}return i},e.prototype._onInitChunkArrival=function(e,t){var i=this,a=0;if(t>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,a=this._demuxer.parseChunks(e,t);else if("mmttlv"===this._mediaDataSource.type)this._setupMMTTLVDemuxerRemuxer(),a=this._demuxer.parseChunks(e,t);else{var n=null;(n=b.probe(e)).match&&(this._setupFLVDemuxerRemuxer(n),a=this._demuxer.parseChunks(e,t)),n.match||n.needMoreData||(n=Ce.probe(e)).match&&(this._setupTSDemuxerRemuxer(n),a=this._demuxer.parseChunks(e,t)),n.match||n.needMoreData||(n=null,r.a.e(this.TAG,"Non MPEG-TS/FLV, Unsupported media type!"),Promise.resolve().then((function(){i._internalAbort()})),this._emitter.emit(Be.a.DEMUX_ERROR,m.a.FORMAT_UNSUPPORTED,"Non MPEG-TS/FLV, Unsupported media type!"))}return a},e.prototype._setupFLVDemuxerRemuxer=function(e){this._demuxer=new b(e,this._config),this._remuxer||(this._remuxer=new we(this._config));var t=this._mediaDataSource;null==t.duration||isNaN(t.duration)||(this._demuxer.overridedDuration=t.duration),"boolean"==typeof t.hasAudio&&(this._demuxer.overridedHasAudio=t.hasAudio),"boolean"==typeof t.hasVideo&&(this._demuxer.overridedHasVideo=t.hasVideo),this._demuxer.timestampBase=t.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this)},e.prototype._setupTSDemuxerRemuxer=function(e){var t=this._demuxer=new Ce(e,this._config);this._remuxer||(this._remuxer=new we(this._config)),t.onError=this._onDemuxException.bind(this),t.onMediaInfo=this._onMediaInfo.bind(this),t.onMetaDataArrived=this._onMetaDataArrived.bind(this),t.onTimedID3Metadata=this._onTimedID3Metadata.bind(this),t.onSynchronousKLVMetadata=this._onSynchronousKLVMetadata.bind(this),t.onAsynchronousKLVMetadata=this._onAsynchronousKLVMetadata.bind(this),t.onSMPTE2038Metadata=this._onSMPTE2038Metadata.bind(this),t.onSCTE35Metadata=this._onSCTE35Metadata.bind(this),t.onPESPrivateDataDescriptor=this._onPESPrivateDataDescriptor.bind(this),t.onPESPrivateData=this._onPESPrivateData.bind(this),this._remuxer.bindDataSource(this._demuxer),this._demuxer.bindDataSource(this._ioctl),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this)},e.prototype._setupMMTTLVDemuxerRemuxer=function(){var e=this,t=this._demuxer=new ze(this._config);this._remuxer||(this._remuxer=new we(this._config)),t.onError=this._onDemuxException.bind(this),t.onMediaInfo=this._onMediaInfo.bind(this),t.onAudioTracksMetadata=this._onAudioTracksMetadata.bind(this),this._remuxer.bindDataSource(this._demuxer),this._demuxer.bindDataSource(this._ioctl),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this),this._remuxer.onSystemClock=this._onSystemClock.bind(this),this._config.isLive||1!==this._mediaDataSource.segments.length||(this._seekLocator=new Xe(this._mediaDataSource,this._config,(function(t){return e._emitter.emit(Be.a.DURATION_AVAILABLE,t)})))},e.prototype._onMediaInfo=function(e){var t=this;null==this._mediaInfo&&(this._mediaInfo=Object.assign({},e),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,s.a.prototype));var i=Object.assign({},e);Object.setPrototypeOf(i,s.a.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=i,this._reportSegmentMediaInfo(this._currentSegmentIndex),null!=this._pendingSeekTime&&Promise.resolve().then((function(){var e=t._pendingSeekTime;t._pendingSeekTime=null,t.seek(e)}))},e.prototype._onMetaDataArrived=function(e){this._emitter.emit(Be.a.METADATA_ARRIVED,e)},e.prototype._onScriptDataArrived=function(e){this._emitter.emit(Be.a.SCRIPTDATA_ARRIVED,e)},e.prototype._onTimedID3Metadata=function(e){var t=this._remuxer.getTimestampBase();null!=t&&(null!=e.pts&&(e.pts-=t),null!=e.dts&&(e.dts-=t),this._emitter.emit(Be.a.TIMED_ID3_METADATA_ARRIVED,e))},e.prototype._onSynchronousKLVMetadata=function(e){var t=this._remuxer.getTimestampBase();null!=t&&(null!=e.pts&&(e.pts-=t),null!=e.dts&&(e.dts-=t),this._emitter.emit(Be.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,e))},e.prototype._onAsynchronousKLVMetadata=function(e){this._emitter.emit(Be.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,e)},e.prototype._onSMPTE2038Metadata=function(e){var t=this._remuxer.getTimestampBase();null!=t&&(null!=e.pts&&(e.pts-=t),null!=e.dts&&(e.dts-=t),null!=e.nearest_pts&&(e.nearest_pts-=t),this._emitter.emit(Be.a.SMPTE2038_METADATA_ARRIVED,e))},e.prototype._onSCTE35Metadata=function(e){var t=this._remuxer.getTimestampBase();null!=t&&(null!=e.pts&&(e.pts-=t),null!=e.nearest_pts&&(e.nearest_pts-=t),this._emitter.emit(Be.a.SCTE35_METADATA_ARRIVED,e))},e.prototype._onPESPrivateDataDescriptor=function(e){this._emitter.emit(Be.a.PES_PRIVATE_DATA_DESCRIPTOR,e)},e.prototype._onPESPrivateData=function(e){var t=this._remuxer.getTimestampBase();null!=t&&(null!=e.pts&&(e.pts-=t),null!=e.nearest_pts&&(e.nearest_pts-=t),null!=e.dts&&(e.dts-=t),this._emitter.emit(Be.a.PES_PRIVATE_DATA_ARRIVED,e))},e.prototype._onAudioTracksMetadata=function(e){this._emitter.emit(Be.a.AUDIO_TRACKS_METADATA,e)},e.prototype._onIOSeeked=function(){this._remuxer.insertDiscontinuity()},e.prototype._onIOComplete=function(e){var t=e+1;t<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer&&this._remuxer.flushStashedSamples(),this._loadSegment(t)):(this._remuxer&&this._remuxer.flushStashedSamples(),this._emitter.emit(Be.a.LOADING_COMPLETE),this._disableStatisticsReporter())},e.prototype._onIORedirect=function(e){var t=this._ioctl.extraData;this._mediaDataSource.segments[t].redirectedURL=e},e.prototype._onIORecoveredEarlyEof=function(){this._emitter.emit(Be.a.RECOVERED_EARLY_EOF)},e.prototype._onIOException=function(e,t){r.a.e(this.TAG,"IOException: type = ".concat(e,", code = ").concat(t.code,", msg = ").concat(t.msg)),this._emitter.emit(Be.a.IO_ERROR,e,t),this._disableStatisticsReporter()},e.prototype._onDemuxException=function(e,t){r.a.e(this.TAG,"DemuxException: type = ".concat(e,", info = ").concat(t)),this._emitter.emit(Be.a.DEMUX_ERROR,e,t)},e.prototype._onRemuxerInitSegmentArrival=function(e,t){this._emitter.emit(Be.a.INIT_SEGMENT,e,t)},e.prototype._onRemuxerMediaSegmentArrival=function(e,t){if(null==this._pendingSeekTime&&(this._emitter.emit(Be.a.MEDIA_SEGMENT,e,t),null!=this._pendingResolveSeekPoint&&"video"===e)){var i=t.info.syncPoints,a=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,o.a.safari&&i.length>0&&i[0].originalDts===a&&(a=i[0].pts),this._emitter.emit(Be.a.RECOMMEND_SEEKPOINT,a)}},e.prototype._onSystemClock=function(e,t){this._emitter.emit(Be.a.SYSTEM_CLOCK,e,t)},e.prototype._enableStatisticsReporter=function(){null==this._statisticsReporter&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))},e.prototype._disableStatisticsReporter=function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},e.prototype._reportSegmentMediaInfo=function(e){var t=this._mediaInfo.segments[e],i=Object.assign({},t);i.duration=this._mediaInfo.duration,i.segmentCount=this._mediaInfo.segmentCount,delete i.segments,delete i.keyframesIndex,this._emitter.emit(Be.a.MEDIA_INFO,i)},e.prototype._reportStatisticsInfo=function(){var e={};e.url=this._ioctl.currentURL,e.hasRedirect=this._ioctl.hasRedirect,e.hasRedirect&&(e.redirectedURL=this._ioctl.currentRedirectedURL),e.speed=this._ioctl.currentSpeed,e.loaderType=this._ioctl.loaderType,e.currentSegmentIndex=this._currentSegmentIndex,e.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(Be.a.STATISTICS_INFO,e)},e.prototype.switchAudioTrack=function(e){this._demuxer.switchAudioTrack(e)},e}();t.a=Qe},function(e,t,i){"use strict";var a=function(){function e(){}return e.install=function(){Object.setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Object.assign=Object.assign||function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),i=1;i<arguments.length;i++){var a=arguments[i];if(null!=a)for(var n in a)a.hasOwnProperty(n)&&(t[n]=a[n])}return t},String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(e,t){var i=t>0?0|t:0;return this.substring(i,i+e.length)===e}}),"function"!=typeof self.Promise&&i(30).polyfill()},e}();a.install(),t.a=a},function(e,t,i){function a(e){var t={};function i(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.i=function(e){return e},i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/",i.oe=function(e){throw console.error(e),e};var a=i(i.s=ENTRY_MODULE);return a.default||a}function n(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function r(e,t,a){var r={};r[a]=[];var o=t.toString(),s=o.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!s)return r;for(var _,d=s[1],c=new RegExp("(\\\\n|\\W)"+n(d)+"\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)","g");_=c.exec(o);)"dll-reference"!==_[3]&&r[a].push(_[3]);for(c=new RegExp("\\("+n(d)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)',"g");_=c.exec(o);)e[_[2]]||(r[a].push(_[1]),e[_[2]]=i(_[1]).m),r[_[2]]=r[_[2]]||[],r[_[2]].push(_[4]);for(var u,l=Object.keys(r),h=0;h<l.length;h++)for(var f=0;f<r[l[h]].length;f++)u=r[l[h]][f],isNaN(1*u)||(r[l[h]][f]=1*r[l[h]][f]);return r}function o(e){return Object.keys(e).reduce((function(t,i){return t||e[i].length>0}),!1)}e.exports=function(e,t){t=t||{};var n={main:i.m},s=t.all?{main:Object.keys(n.main)}:function(e,t){for(var i={main:[t]},a={main:[]},n={main:{}};o(i);)for(var s=Object.keys(i),_=0;_<s.length;_++){var d=s[_],c=i[d].pop();if(n[d]=n[d]||{},!n[d][c]&&e[d][c]){n[d][c]=!0,a[d]=a[d]||[],a[d].push(c);for(var u=r(e,e[d][c],d),l=Object.keys(u),h=0;h<l.length;h++)i[l[h]]=i[l[h]]||[],i[l[h]]=i[l[h]].concat(u[l[h]])}}return a}(n,e),_="";Object.keys(s).filter((function(e){return"main"!==e})).forEach((function(e){for(var t=0;s[e][t];)t++;s[e].push(t),n[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",_=_+"var "+e+" = ("+a.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+s[e].map((function(t){return JSON.stringify(t)+": "+n[e][t].toString()})).join(",")+"});\n"})),_=_+"new (("+a.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+s.main.map((function(e){return JSON.stringify(e)+": "+n.main[e].toString()})).join(",")+"}))(self);";var d=new self.Blob([_],{type:"text/javascript"});if(t.bare)return d;var c=(self.URL||self.webkitURL||self.mozURL||self.msURL).createObjectURL(d),u=new self.Worker(c);return u.objectURL=c,u}},function(e,t,i){"use strict";var a=i(9),n=i.n(a),r=i(0),o=i(5),s=i(7),_=i(3),d=function(){function e(e){this.TAG="MSEController",this._config=e,this._emitter=new n.a,this._config.isLive&&null==this._config.autoCleanupSourceBuffer&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onStartStreaming:this._onStartStreaming.bind(this),onEndStreaming:this._onEndStreaming.bind(this),onQualityChange:this._onQualityChange.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._useManagedMediaSource="ManagedMediaSource"in self&&!("MediaSource"in self),this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElementProxy=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._onDurationAvailableCalled=!1,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]}}return e.prototype.destroy=function(){this._mediaSource&&this.shutdown(),this._mediaSourceObjectURL&&this.revokeObjectURL(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null},e.prototype.on=function(e,t){this._emitter.addListener(e,t)},e.prototype.off=function(e,t){this._emitter.removeListener(e,t)},e.prototype.initialize=function(e){if(this._mediaSource)throw new _.a("MediaSource has been attached to an HTMLMediaElement!");this._useManagedMediaSource&&r.a.v(this.TAG,"Using ManagedMediaSource");var t=this._mediaSource=this._useManagedMediaSource?new self.ManagedMediaSource:new self.MediaSource;t.addEventListener("sourceopen",this.e.onSourceOpen),t.addEventListener("sourceended",this.e.onSourceEnded),t.addEventListener("sourceclose",this.e.onSourceClose),this._useManagedMediaSource&&(t.addEventListener("startstreaming",this.e.onStartStreaming),t.addEventListener("endstreaming",this.e.onEndStreaming),t.addEventListener("qualitychange",this.e.onQualityChange)),this._mediaElementProxy=e},e.prototype.shutdown=function(){if(this._mediaSource){var e=this._mediaSource;for(var t in this._sourceBuffers){var i=this._pendingSegments[t];i.splice(0,i.length),this._pendingSegments[t]=null,this._pendingRemoveRanges[t]=null,this._lastInitSegments[t]=null;var a=this._sourceBuffers[t];if(a){if("closed"!==e.readyState){try{e.removeSourceBuffer(a)}catch(e){r.a.e(this.TAG,e.message)}a.removeEventListener("error",this.e.onSourceBufferError),a.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[t]=null,this._sourceBuffers[t]=null}}if("open"===e.readyState)try{e.endOfStream()}catch(e){r.a.e(this.TAG,e.message)}this._mediaElementProxy=null,e.removeEventListener("sourceopen",this.e.onSourceOpen),e.removeEventListener("sourceended",this.e.onSourceEnded),e.removeEventListener("sourceclose",this.e.onSourceClose),this._useManagedMediaSource&&(e.removeEventListener("startstreaming",this.e.onStartStreaming),e.removeEventListener("endstreaming",this.e.onEndStreaming),e.removeEventListener("qualitychange",this.e.onQualityChange)),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._mediaSource=null}},e.prototype.isManagedMediaSource=function(){return this._useManagedMediaSource},e.prototype.getObject=function(){if(!this._mediaSource)throw new _.a("MediaSource has not been initialized yet!");return this._mediaSource},e.prototype.getHandle=function(){if(!this._mediaSource)throw new _.a("MediaSource has not been initialized yet!");return this._mediaSource.handle},e.prototype.getObjectURL=function(){if(!this._mediaSource)throw new _.a("MediaSource has not been initialized yet!");return null==this._mediaSourceObjectURL&&(this._mediaSourceObjectURL=URL.createObjectURL(this._mediaSource)),this._mediaSourceObjectURL},e.prototype.revokeObjectURL=function(){this._mediaSourceObjectURL&&(URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)},e.prototype.appendInitSegment=function(e,t){if(void 0===t&&(t=void 0),!this._mediaSource||"open"!==this._mediaSource.readyState||!1===this._mediaSource.streaming)return this._pendingSourceBufferInit.push(e),void this._pendingSegments[e.type].push(e);var i=e,a="".concat(i.container);i.codec&&i.codec.length>0&&("opus"===i.codec&&o.a.safari&&(i.codec="Opus"),a+=";codecs=".concat(i.codec));var n=!1;if(r.a.v(this.TAG,"Received Initialization Segment, mimeType: "+a),this._lastInitSegments[i.type]=i,a!==this._mimeTypes[i.type]){if(this._mimeTypes[i.type])r.a.v(this.TAG,"Notice: ".concat(i.type," mimeType changed, origin: ").concat(this._mimeTypes[i.type],", target: ").concat(a));else{n=!0;try{var _=this._sourceBuffers[i.type]=this._mediaSource.addSourceBuffer(a);_.addEventListener("error",this.e.onSourceBufferError),_.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(e){return r.a.e(this.TAG,e.message),void this._emitter.emit(s.a.ERROR,{code:e.code,msg:e.message})}}this._mimeTypes[i.type]=a}t||this._pendingSegments[i.type].push(i),n||this._sourceBuffers[i.type]&&!this._sourceBuffers[i.type].updating&&this._doAppendSegments(),o.a.safari&&"audio/mpeg"===i.container&&i.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=i.mediaDuration/1e3,this._updateMediaSourceDuration())},e.prototype.appendMediaSegment=function(e){var t=e;this._pendingSegments[t.type].push(t),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var i=this._sourceBuffers[t.type];!i||i.updating||this._hasPendingRemoveRanges()||this._doAppendSegments()},e.prototype.flush=function(e){for(var t in this._sourceBuffers)if(this._sourceBuffers[t]&&(null==e||e===t)){var i=this._sourceBuffers[t];if("open"===this._mediaSource.readyState)try{i.abort()}catch(e){r.a.e(this.TAG,e.message)}var a=this._pendingSegments[t];if(a.splice(0,a.length),"closed"!==this._mediaSource.readyState){for(var n=0;n<i.buffered.length;n++){var s=i.buffered.start(n),_=i.buffered.end(n);this._pendingRemoveRanges[t].push({start:s,end:_})}if(i.updating||this._doRemoveRanges(),o.a.safari){var d=this._lastInitSegments[t];d&&(this._pendingSegments[t].push(d),i.updating||this._doAppendSegments())}}}},e.prototype.endOfStream=function(){var e=this._mediaSource,t=this._sourceBuffers;e&&"open"===e.readyState?t.video&&t.video.updating||t.audio&&t.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,e.endOfStream()):e&&"closed"===e.readyState&&this._hasPendingSegments()&&(this._hasPendingEos=!0)},e.prototype._needCleanupSourceBuffer=function(){if(!this._config.autoCleanupSourceBuffer)return!1;var e=this._mediaElementProxy.getCurrentTime();for(var t in this._sourceBuffers){var i=this._sourceBuffers[t];if(i){var a=i.buffered;if(a.length>=1&&e-a.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1},e.prototype._doCleanupSourceBuffer=function(){var e=this._mediaElementProxy.getCurrentTime();for(var t in this._sourceBuffers){var i=this._sourceBuffers[t];if(i){for(var a=i.buffered,n=!1,r=0;r<a.length;r++){var o=a.start(r),s=a.end(r);if(o<=e&&e<s+3){if(e-o>=this._config.autoCleanupMaxBackwardDuration){n=!0;var _=e-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[t].push({start:o,end:_})}}else s<e&&(n=!0,this._pendingRemoveRanges[t].push({start:o,end:s}))}n&&!i.updating&&this._doRemoveRanges()}}},e.prototype._updateMediaSourceDuration=function(){var e=this._sourceBuffers;if(0!==this._mediaElementProxy.getReadyState()&&"open"===this._mediaSource.readyState&&!(e.video&&e.video.updating||e.audio&&e.audio.updating)){var t=this._mediaSource.duration,i=this._pendingMediaDuration;i>0&&(isNaN(t)||t===1/0&&this._onDurationAvailableCalled||i>t)&&(r.a.v(this.TAG,"Update MediaSource duration from ".concat(t," to ").concat(i)),this._mediaSource.duration=i),this._requireSetMediaDuration=!1,this._onDurationAvailableCalled=!1,this._pendingMediaDuration=0}},e.prototype.onDurationAvailable=function(e){this._requireSetMediaDuration=!0,this._onDurationAvailableCalled=!0,this._pendingMediaDuration=e},e.prototype._doRemoveRanges=function(){for(var e in this._pendingRemoveRanges)if(this._sourceBuffers[e]&&!this._sourceBuffers[e].updating)for(var t=this._sourceBuffers[e],i=this._pendingRemoveRanges[e];i.length&&!t.updating;){var a=i.shift();t.remove(a.start,a.end)}},e.prototype._doAppendSegments=function(){var e=this._pendingSegments;for(var t in e)if(this._sourceBuffers[t]&&!this._sourceBuffers[t].updating&&!1!==this._mediaSource.streaming&&e[t].length>0){var i=e[t].shift();if("number"==typeof i.timestampOffset&&isFinite(i.timestampOffset)){var a=this._sourceBuffers[t].timestampOffset,n=i.timestampOffset/1e3;Math.abs(a-n)>.1&&(r.a.v(this.TAG,"Update MPEG audio timestampOffset from ".concat(a," to ").concat(n)),this._sourceBuffers[t].timestampOffset=n),delete i.timestampOffset}if(!i.data||0===i.data.byteLength)continue;try{this._sourceBuffers[t].appendBuffer(i.data),this._isBufferFull=!1}catch(e){this._pendingSegments[t].unshift(i),22===e.code?(this._isBufferFull||this._emitter.emit(s.a.BUFFER_FULL),this._isBufferFull=!0):(r.a.e(this.TAG,e.message),this._emitter.emit(s.a.ERROR,{code:e.code,msg:e.message}))}}},e.prototype._onSourceOpen=function(){if(r.a.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var e=this._pendingSourceBufferInit;e.length;){var t=e.shift();this.appendInitSegment(t,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(s.a.SOURCE_OPEN)},e.prototype._onStartStreaming=function(){r.a.v(this.TAG,"ManagedMediaSource onStartStreaming"),this._emitter.emit(s.a.START_STREAMING)},e.prototype._onEndStreaming=function(){r.a.v(this.TAG,"ManagedMediaSource onEndStreaming"),this._emitter.emit(s.a.END_STREAMING)},e.prototype._onQualityChange=function(){r.a.v(this.TAG,"ManagedMediaSource onQualityChange")},e.prototype._onSourceEnded=function(){r.a.v(this.TAG,"MediaSource onSourceEnded")},e.prototype._onSourceClose=function(){r.a.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&null!=this.e&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose),this._useManagedMediaSource&&(this._mediaSource.removeEventListener("startstreaming",this.e.onStartStreaming),this._mediaSource.removeEventListener("endstreaming",this.e.onEndStreaming),this._mediaSource.removeEventListener("qualitychange",this.e.onQualityChange)))},e.prototype._hasPendingSegments=function(){var e=this._pendingSegments;return e.video.length>0||e.audio.length>0},e.prototype._hasPendingRemoveRanges=function(){var e=this._pendingRemoveRanges;return e.video.length>0||e.audio.length>0},e.prototype._onSourceBufferUpdateEnd=function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(s.a.UPDATE_END)},e.prototype._onSourceBufferError=function(e){r.a.e(this.TAG,"SourceBuffer Error: ".concat(e))},e}();t.a=d},function(e,t,i){"use strict";var a=i(9),n=i.n(a),r=i(21),o=i.n(r),s=i(0),_=i(8),d=i(19),c=i(1),u=(i(28),i(10)),l=function(){function e(e,t){if(this.TAG="Transmuxer",this._emitter=new n.a,t.enableWorker&&"undefined"!=typeof Worker)try{this._worker=o()(28),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[e,t]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},_.a.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:_.a.getConfig()})}catch(i){s.a.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new d.a(e,t)}else this._controller=new d.a(e,t);if(this._controller){var i=this._controller;i.on(c.a.IO_ERROR,this._onIOError.bind(this)),i.on(c.a.DEMUX_ERROR,this._onDemuxError.bind(this)),i.on(c.a.INIT_SEGMENT,this._onInitSegment.bind(this)),i.on(c.a.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),i.on(c.a.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),i.on(c.a.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),i.on(c.a.MEDIA_INFO,this._onMediaInfo.bind(this)),i.on(c.a.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),i.on(c.a.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),i.on(c.a.TIMED_ID3_METADATA_ARRIVED,this._onTimedID3MetadataArrived.bind(this)),i.on(c.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,this._onSynchronousKLVMetadataArrived.bind(this)),i.on(c.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,this._onAsynchronousKLVMetadataArrived.bind(this)),i.on(c.a.SMPTE2038_METADATA_ARRIVED,this._onSMPTE2038MetadataArrived.bind(this)),i.on(c.a.SCTE35_METADATA_ARRIVED,this._onSCTE35MetadataArrived.bind(this)),i.on(c.a.PES_PRIVATE_DATA_DESCRIPTOR,this._onPESPrivateDataDescriptor.bind(this)),i.on(c.a.PES_PRIVATE_DATA_ARRIVED,this._onPESPrivateDataArrived.bind(this)),i.on(c.a.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),i.on(c.a.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this)),i.on(c.a.DURATION_AVAILABLE,this._onDurationAvailable.bind(this)),i.on(c.a.SYSTEM_CLOCK,this._onSystemClock.bind(this)),i.on(c.a.AUDIO_TRACKS_METADATA,this._onAudioTracksMetadata.bind(this))}}return e.prototype.destroy=function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),_.a.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null},e.prototype.on=function(e,t){this._emitter.addListener(e,t)},e.prototype.off=function(e,t){this._emitter.removeListener(e,t)},e.prototype.hasWorker=function(){return null!=this._worker},e.prototype.open=function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()},e.prototype.close=function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()},e.prototype.seek=function(e){this._worker?this._worker.postMessage({cmd:"seek",param:e}):this._controller.seek(e)},e.prototype.pause=function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()},e.prototype.resume=function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()},e.prototype._onInitSegment=function(e,t){var i=this;Promise.resolve().then((function(){i._emitter.emit(c.a.INIT_SEGMENT,e,t)}))},e.prototype._onMediaSegment=function(e,t){var i=this;Promise.resolve().then((function(){i._emitter.emit(c.a.MEDIA_SEGMENT,e,t)}))},e.prototype._onLoadingComplete=function(){var e=this;Promise.resolve().then((function(){e._emitter.emit(c.a.LOADING_COMPLETE)}))},e.prototype._onRecoveredEarlyEof=function(){var e=this;Promise.resolve().then((function(){e._emitter.emit(c.a.RECOVERED_EARLY_EOF)}))},e.prototype._onMediaInfo=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(c.a.MEDIA_INFO,e)}))},e.prototype._onMetaDataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(c.a.METADATA_ARRIVED,e)}))},e.prototype._onScriptDataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(c.a.SCRIPTDATA_ARRIVED,e)}))},e.prototype._onTimedID3MetadataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(c.a.TIMED_ID3_METADATA_ARRIVED,e)}))},e.prototype._onSynchronousKLVMetadataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(c.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,e)}))},e.prototype._onAsynchronousKLVMetadataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(c.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,e)}))},e.prototype._onSMPTE2038MetadataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(c.a.SMPTE2038_METADATA_ARRIVED,e)}))},e.prototype._onSCTE35MetadataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(c.a.SCTE35_METADATA_ARRIVED,e)}))},e.prototype._onPESPrivateDataDescriptor=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(c.a.PES_PRIVATE_DATA_DESCRIPTOR,e)}))},e.prototype._onPESPrivateDataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(c.a.PES_PRIVATE_DATA_ARRIVED,e)}))},e.prototype._onStatisticsInfo=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(c.a.STATISTICS_INFO,e)}))},e.prototype._onIOError=function(e,t){var i=this;Promise.resolve().then((function(){i._emitter.emit(c.a.IO_ERROR,e,t)}))},e.prototype._onDemuxError=function(e,t){var i=this;Promise.resolve().then((function(){i._emitter.emit(c.a.DEMUX_ERROR,e,t)}))},e.prototype._onRecommendSeekpoint=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(c.a.RECOMMEND_SEEKPOINT,e)}))},e.prototype._onDurationAvailable=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(c.a.DURATION_AVAILABLE,e)}))},e.prototype._onSystemClock=function(e,t){this._emitter.emit(c.a.SYSTEM_CLOCK,e,t)},e.prototype._onAudioTracksMetadata=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(c.a.AUDIO_TRACKS_METADATA,e)}))},e.prototype._onLoggingConfigChanged=function(e){this._worker&&this._worker.postMessage({cmd:"logging_config",param:e})},e.prototype._onWorkerMessage=function(e){var t=e.data,i=t.data;if("destroyed"===t.msg||this._workerDestroying)return this._workerDestroying=!1,this._worker.terminate(),void(this._worker=null);switch(t.msg){case c.a.INIT_SEGMENT:case c.a.MEDIA_SEGMENT:this._emitter.emit(t.msg,i.type,i.data);break;case c.a.LOADING_COMPLETE:case c.a.RECOVERED_EARLY_EOF:this._emitter.emit(t.msg);break;case c.a.MEDIA_INFO:Object.setPrototypeOf(i,u.a.prototype),this._emitter.emit(t.msg,i);break;case c.a.METADATA_ARRIVED:case c.a.SCRIPTDATA_ARRIVED:case c.a.TIMED_ID3_METADATA_ARRIVED:case c.a.SYNCHRONOUS_KLV_METADATA_ARRIVED:case c.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED:case c.a.SMPTE2038_METADATA_ARRIVED:case c.a.SCTE35_METADATA_ARRIVED:case c.a.PES_PRIVATE_DATA_DESCRIPTOR:case c.a.PES_PRIVATE_DATA_ARRIVED:case c.a.STATISTICS_INFO:case c.a.DURATION_AVAILABLE:case c.a.AUDIO_TRACKS_METADATA:this._emitter.emit(t.msg,i);break;case c.a.IO_ERROR:case c.a.DEMUX_ERROR:this._emitter.emit(t.msg,i.type,i.info);break;case c.a.RECOMMEND_SEEKPOINT:this._emitter.emit(t.msg,i);break;case"logcat_callback":s.a.emitter.emit("log",i.type,i.logcat);break;case c.a.SYSTEM_CLOCK:this._emitter.emit(t.msg,i.system_clock,i.received_time)}},e.prototype.switchAudioTrack=function(e){this._worker?this._worker.postMessage({cmd:"switch_audio_track",param:e}):this._controller.switchAudioTrack(e)},e}();t.a=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.readNetworkNameDescriptor=function(e){return{tag:"networkName",name:e.slice()}},t.readSystemManagementDescriptor=function(e){if(e.length<2)return;return{tag:"systemManagement",broadcastingFlag:e[0]>>6,broadcastingIdentifier:63&e[0],additionalBroadcastingIdentification:e[1],additionalIdentificationInfo:e.slice(2)}},t.readServiceListDescriptor=function(e){for(var t=[],i=0;i+3<=e.length;i+=3){var a=e[i]<<8|e[i+1],n=e[i+2];t.push({serviceId:a,serviceType:n})}return{tag:"serviceList",services:t}},t.readEmergencyInformationDescriptor=function(e){var t=new a.BinaryReader(e),i=[];for(;t.canRead(4);){var n=t.readUint16(),r=t.readUint8(),o=!!(128&r),s=!!(64&r),_=t.readUint8();if(!t.canRead(2*_))break;for(var d=[],c=0;c<_;c++)d.push(t.readUint16()>>4);i.push({serviceId:n,startEndFlag:o,signalLevel:s,areaCodes:d})}return{tag:"emergencyInformation",services:i}},t.readSatelliteDeliverySystemDescriptor=function(e){if(e.length<11)return;var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{tag:"satelliteDeliverySystem",frequency:t.getUint32(0),orbitalPosition:t.getUint16(4),westEastFlag:!!(128&t.getUint8(6)),polarization:(96&t.getUint8(6))>>5,modulation:31&t.getUint8(6),symbolRate:t.getUint32(7)>>4,fecInner:15&t.getUint32(7)}},t.readChannelBondingCableDeliverySystemDescriptor=function(e){var t=new a.BinaryReader(e),i=[];for(;t.canRead(12);){var n=t.readUint32();t.skip(1);var r=t.readUint8(),o=r>>4,s=15&r,_=t.readUint8(),d=t.readUint32(),c=d>>>4,u=15&d,l=t.readUint8();i.push({frequency:n,frameType:o,fecOuter:s,modulation:_,symbolRate:c,fecInner:u,groupId:l})}return{tag:"channelBondingCableDeliverySystem",carriers:i}};var a=i(15)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.readNTPPacket=function(e){var t=new a.BinaryReader(e);if(!t.canRead(48))return;var i=t.readUint8(),n=i>>6,r=i>>3&7,o=7&i,s=t.readUint8(),_=t.readUint8(),d=t.readUint8(),c=t.readUint32(),u=t.readUint32(),l=t.readUint32(),h=t.readNTP64Timestamp(),f=t.readNTP64Timestamp(),p=t.readNTP64Timestamp(),m=t.readNTP64Timestamp();return{leapIndicator:n,version:r,mode:o,stratum:s,poll:_,precision:d,rootDelay:c,rootDispersion:u,referenceIdentification:l,referenceTimestamp:h,originTimestamp:f,receiveTimestamp:p,transmitTimestamp:m}},t.ntp64TimestampToDate=function(e){var t=e.seconds,i=e.fractional;return new Date(1e3*(t+i*Math.pow(2,-32)))},t.ntp64TimestampToSeconds=function(e){var t=e.seconds,i=e.fractional;return t+i*Math.pow(2,-32)};var a=i(15)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TLV_HEADER_SIZE=void 0,t.TLV_HEADER_SIZE=4},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.readMMTGeneralLocationInfo=function(e){if(!e.canRead(1))return;switch(e.readUint8()){case 0:if(!e.canRead(2))return;return{locationType:"sameDataflow",packetId:e.readUint16()};default:return}}},function(e,t,i){"use strict";i.r(t);i(0);var a=i(8),n=i(20),r=i(19),o=i(1);t.default=function(e){var t=null,i=function(t,i){e.postMessage({msg:"logcat_callback",data:{type:t,logcat:i}})}.bind(this);function s(t,i){var a={msg:o.a.INIT_SEGMENT,data:{type:t,data:i}};e.postMessage(a,[i.data])}function _(t,i){var a={msg:o.a.MEDIA_SEGMENT,data:{type:t,data:i}};e.postMessage(a,[i.data])}function d(){var t={msg:o.a.LOADING_COMPLETE};e.postMessage(t)}function c(){var t={msg:o.a.RECOVERED_EARLY_EOF};e.postMessage(t)}function u(t){var i={msg:o.a.MEDIA_INFO,data:t};e.postMessage(i)}function l(t){var i={msg:o.a.METADATA_ARRIVED,data:t};e.postMessage(i)}function h(t){var i={msg:o.a.SCRIPTDATA_ARRIVED,data:t};e.postMessage(i)}function f(t){var i={msg:o.a.TIMED_ID3_METADATA_ARRIVED,data:t};e.postMessage(i)}function p(t){var i={msg:o.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,data:t};e.postMessage(i)}function m(t){var i={msg:o.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,data:t};e.postMessage(i)}function g(t){var i={msg:o.a.SMPTE2038_METADATA_ARRIVED,data:t};e.postMessage(i)}function v(t){var i={msg:o.a.SCTE35_METADATA_ARRIVED,data:t};e.postMessage(i)}function E(t){var i={msg:o.a.PES_PRIVATE_DATA_DESCRIPTOR,data:t};e.postMessage(i)}function y(t){var i={msg:o.a.PES_PRIVATE_DATA_ARRIVED,data:t};e.postMessage(i)}function T(t){var i={msg:o.a.STATISTICS_INFO,data:t};e.postMessage(i)}function S(t,i){e.postMessage({msg:o.a.IO_ERROR,data:{type:t,info:i}})}function A(t,i){e.postMessage({msg:o.a.DEMUX_ERROR,data:{type:t,info:i}})}function R(t){e.postMessage({msg:o.a.RECOMMEND_SEEKPOINT,data:t})}function b(t){e.postMessage({msg:o.a.DURATION_AVAILABLE,data:t})}function I(t,i){e.postMessage({msg:o.a.SYSTEM_CLOCK,data:{system_clock:t,received_time:i}})}function M(t){var i={msg:o.a.AUDIO_TRACKS_METADATA,data:data};e.postMessage(i)}n.a.install(),e.addEventListener("message",(function(n){switch(n.data.cmd){case"init":(t=new r.a(n.data.param[0],n.data.param[1])).on(o.a.IO_ERROR,S.bind(this)),t.on(o.a.DEMUX_ERROR,A.bind(this)),t.on(o.a.INIT_SEGMENT,s.bind(this)),t.on(o.a.MEDIA_SEGMENT,_.bind(this)),t.on(o.a.LOADING_COMPLETE,d.bind(this)),t.on(o.a.RECOVERED_EARLY_EOF,c.bind(this)),t.on(o.a.MEDIA_INFO,u.bind(this)),t.on(o.a.METADATA_ARRIVED,l.bind(this)),t.on(o.a.SCRIPTDATA_ARRIVED,h.bind(this)),t.on(o.a.TIMED_ID3_METADATA_ARRIVED,f.bind(this)),t.on(o.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,p.bind(this)),t.on(o.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,m.bind(this)),t.on(o.a.SMPTE2038_METADATA_ARRIVED,g.bind(this)),t.on(o.a.SCTE35_METADATA_ARRIVED,v.bind(this)),t.on(o.a.PES_PRIVATE_DATA_DESCRIPTOR,E.bind(this)),t.on(o.a.PES_PRIVATE_DATA_ARRIVED,y.bind(this)),t.on(o.a.STATISTICS_INFO,T.bind(this)),t.on(o.a.RECOMMEND_SEEKPOINT,R.bind(this)),t.on(o.a.DURATION_AVAILABLE,b.bind(this)),t.on(o.a.SYSTEM_CLOCK,I.bind(this)),t.on(o.a.AUDIO_TRACKS_METADATA,M.bind(this));break;case"destroy":t&&(t.destroy(),t=null),e.postMessage({msg:"destroyed"});break;case"start":t.start();break;case"stop":t.stop();break;case"seek":t.seek(n.data.param);break;case"pause":t.pause();break;case"resume":t.resume();break;case"logging_config":var O=n.data.param;a.a.applyConfig(O),!0===O.enableCallback?a.a.addLogListener(i):a.a.removeLogListener(i);break;case"switch_audio_track":t.switchAudioTrack(n.data.param)}}))}},function(e,t,i){e.exports=i(38).default},function(e,t,i){(function(t,i){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var a;a=function(){"use strict";function e(e){return"function"==typeof e}var a=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},n=0,r=void 0,o=void 0,s=function(e,t){f[n]=e,f[n+1]=t,2===(n+=2)&&(o?o(p):y())},_="undefined"!=typeof window?window:void 0,d=_||{},c=d.MutationObserver||d.WebKitMutationObserver,u="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),l="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function h(){var e=setTimeout;return function(){return e(p,1)}}var f=new Array(1e3);function p(){for(var e=0;e<n;e+=2)(0,f[e])(f[e+1]),f[e]=void 0,f[e+1]=void 0;n=0}var m,g,v,E,y=void 0;function T(e,t){var i=this,a=new this.constructor(R);void 0===a[A]&&N(a);var n=i._state;if(n){var r=arguments[n-1];s((function(){return P(n,a,r,i._result)}))}else D(i,a,e,t);return a}function S(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(R);return I(t,e),t}u?y=function(){return t.nextTick(p)}:c?(g=0,v=new c(p),E=document.createTextNode(""),v.observe(E,{characterData:!0}),y=function(){E.data=g=++g%2}):l?((m=new MessageChannel).port1.onmessage=p,y=function(){return m.port2.postMessage(0)}):y=void 0===_?function(){try{var e=Function("return this")().require("vertx");return void 0!==(r=e.runOnLoop||e.runOnContext)?function(){r(p)}:h()}catch(e){return h()}}():h();var A=Math.random().toString(36).substring(2);function R(){}function b(t,i,a){i.constructor===t.constructor&&a===T&&i.constructor.resolve===S?function(e,t){1===t._state?O(e,t._result):2===t._state?C(e,t._result):D(t,void 0,(function(t){return I(e,t)}),(function(t){return C(e,t)}))}(t,i):void 0===a?O(t,i):e(a)?function(e,t,i){s((function(e){var a=!1,n=function(e,t,i,a){try{e.call(t,i,a)}catch(e){return e}}(i,t,(function(i){a||(a=!0,t!==i?I(e,i):O(e,i))}),(function(t){a||(a=!0,C(e,t))}),e._label);!a&&n&&(a=!0,C(e,n))}),e)}(t,i,a):O(t,i)}function I(e,t){if(e===t)C(e,new TypeError("You cannot resolve a promise with itself"));else if(n=typeof(a=t),null===a||"object"!==n&&"function"!==n)O(e,t);else{var i=void 0;try{i=t.then}catch(t){return void C(e,t)}b(e,t,i)}var a,n}function M(e){e._onerror&&e._onerror(e._result),L(e)}function O(e,t){void 0===e._state&&(e._result=t,e._state=1,0!==e._subscribers.length&&s(L,e))}function C(e,t){void 0===e._state&&(e._state=2,e._result=t,s(M,e))}function D(e,t,i,a){var n=e._subscribers,r=n.length;e._onerror=null,n[r]=t,n[r+1]=i,n[r+2]=a,0===r&&e._state&&s(L,e)}function L(e){var t=e._subscribers,i=e._state;if(0!==t.length){for(var a=void 0,n=void 0,r=e._result,o=0;o<t.length;o+=3)a=t[o],n=t[o+i],a?P(i,a,n,r):n(r);e._subscribers.length=0}}function P(t,i,a,n){var r=e(a),o=void 0,s=void 0,_=!0;if(r){try{o=a(n)}catch(e){_=!1,s=e}if(i===o)return void C(i,new TypeError("A promises callback cannot return that same promise."))}else o=n;void 0!==i._state||(r&&_?I(i,o):!1===_?C(i,s):1===t?O(i,o):2===t&&C(i,o))}var k=0;function N(e){e[A]=k++,e._state=void 0,e._result=void 0,e._subscribers=[]}var w=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(R),this.promise[A]||N(this.promise),a(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?O(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&O(this.promise,this._result))):C(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;void 0===this._state&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var i=this._instanceConstructor,a=i.resolve;if(a===S){var n=void 0,r=void 0,o=!1;try{n=e.then}catch(e){o=!0,r=e}if(n===T&&void 0!==e._state)this._settledAt(e._state,t,e._result);else if("function"!=typeof n)this._remaining--,this._result[t]=e;else if(i===U){var s=new i(R);o?C(s,r):b(s,e,n),this._willSettleAt(s,t)}else this._willSettleAt(new i((function(t){return t(e)})),t)}else this._willSettleAt(a(e),t)},e.prototype._settledAt=function(e,t,i){var a=this.promise;void 0===a._state&&(this._remaining--,2===e?C(a,i):this._result[t]=i),0===this._remaining&&O(a,this._result)},e.prototype._willSettleAt=function(e,t){var i=this;D(e,void 0,(function(e){return i._settledAt(1,t,e)}),(function(e){return i._settledAt(2,t,e)}))},e}(),U=function(){function t(e){this[A]=k++,this._result=this._state=void 0,this._subscribers=[],R!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t((function(t){I(e,t)}),(function(t){C(e,t)}))}catch(t){C(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var i=this.constructor;return e(t)?this.then((function(e){return i.resolve(t()).then((function(){return e}))}),(function(e){return i.resolve(t()).then((function(){throw e}))})):this.then(t,t)},t}();return U.prototype.then=T,U.all=function(e){return new w(this,e).promise},U.race=function(e){var t=this;return a(e)?new t((function(i,a){for(var n=e.length,r=0;r<n;r++)t.resolve(e[r]).then(i,a)})):new t((function(e,t){return t(new TypeError("You must pass an array to race."))}))},U.resolve=S,U.reject=function(e){var t=new this(R);return C(t,e),t},U._setScheduler=function(e){o=e},U._setAsap=function(e){s=e},U._asap=s,U.polyfill=function(){var e=void 0;if(void 0!==i)e=i;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var a=null;try{a=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===a&&!t.cast)return}e.Promise=U},U.Promise=U,U},e.exports=a()}).call(this,i(31),i(32))},function(e,t){var i,a,n=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(i===setTimeout)return setTimeout(e,0);if((i===r||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:r}catch(e){i=r}try{a="function"==typeof clearTimeout?clearTimeout:o}catch(e){a=o}}();var _,d=[],c=!1,u=-1;function l(){c&&_&&(c=!1,_.length?d=_.concat(d):u=-1,d.length&&h())}function h(){if(!c){var e=s(l);c=!0;for(var t=d.length;t;){for(_=d,d=[];++u<t;)_&&_[u].run();u=-1,t=d.length}_=null,c=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===o||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function p(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];d.push(new f(e,t)),1!==d.length||c||s(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"==typeof window&&(i=window)}e.exports=i},function(e,t,i){"use strict";i.r(t);var a=i(0),n=i(8),r=i(3),o=i(7),s=i(22),_=i(23),d=i(1),c=i(4),u=i(12);t.default=function(e){var t="PlayerEngineWorker",i=function(t,i){e.postMessage({msg:"logcat_callback",type:t,logcat:i})}.bind(void 0),l=null,h=null,f=null,p=null,m=!1,g=!1,v=0,E=0,y=!1;function T(){f&&(f.shutdown(),f.destroy(),f=null)}function S(){if(null==l||null==h)throw new r.a("Worker not initialized");if(p)throw new r.a("Transmuxer has been initialized");g||(!h.deferLoadAfterSourceOpen||m?((p=new _.a(l,h)).on(d.a.INIT_SEGMENT,(function(e,t){f.appendInitSegment(t)})),p.on(d.a.MEDIA_SEGMENT,(function(t,i){f.appendMediaSegment(i),e.postMessage({msg:"buffered_position_changed",buffered_position_milliseconds:i.info.endDts})})),p.on(d.a.LOADING_COMPLETE,(function(){f.endOfStream(),e.postMessage({msg:"player_event",event:c.a.LOADING_COMPLETE})})),p.on(d.a.RECOVERED_EARLY_EOF,(function(){e.postMessage({msg:"player_event",event:c.a.RECOVERED_EARLY_EOF})})),p.on(d.a.IO_ERROR,(function(t,i){e.postMessage({msg:"player_event",event:c.a.ERROR,error_type:u.b.NETWORK_ERROR,error_detail:t,info:i})})),p.on(d.a.DEMUX_ERROR,(function(t,i){e.postMessage({msg:"player_event",event:c.a.ERROR,error_type:u.b.MEDIA_ERROR,error_detail:t,info:i})})),p.on(d.a.MEDIA_INFO,(function(e){O(d.a.MEDIA_INFO,e)})),p.on(d.a.STATISTICS_INFO,(function(e){O(d.a.STATISTICS_INFO,e)})),p.on(d.a.RECOMMEND_SEEKPOINT,(function(t){!function(t){e.postMessage({msg:"transmuxing_event",event:d.a.RECOMMEND_SEEKPOINT,milliseconds:t})}(t)})),p.on(d.a.METADATA_ARRIVED,(function(e){C(c.a.METADATA_ARRIVED,e)})),p.on(d.a.SCRIPTDATA_ARRIVED,(function(e){C(c.a.SCRIPTDATA_ARRIVED,e)})),p.on(d.a.TIMED_ID3_METADATA_ARRIVED,(function(e){C(c.a.TIMED_ID3_METADATA_ARRIVED,e)})),p.on(d.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,(function(e){C(c.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,e)})),p.on(d.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,(function(e){C(c.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,e)})),p.on(d.a.SMPTE2038_METADATA_ARRIVED,(function(e){C(c.a.SMPTE2038_METADATA_ARRIVED,e)})),p.on(d.a.SCTE35_METADATA_ARRIVED,(function(e){C(c.a.SCTE35_METADATA_ARRIVED,e)})),p.on(d.a.PES_PRIVATE_DATA_DESCRIPTOR,(function(e){C(c.a.PES_PRIVATE_DATA_DESCRIPTOR,e)})),p.on(d.a.PES_PRIVATE_DATA_ARRIVED,(function(e){C(c.a.PES_PRIVATE_DATA_ARRIVED,e)})),p.on(d.a.DURATION_AVAILABLE,(function(e){f.onDurationAvailable(e)})),p.on(d.a.SYSTEM_CLOCK,(function(t,i){e.postMessage({msg:"system_clock",system_clock:t,received_time:i})})),p.on(d.a.AUDIO_TRACKS_METADATA,(function(e){C(c.a.AUDIO_TRACKS_METADATA,e)})),p.open()):g=!0)}function A(){f&&f.flush(),p&&(p.close(),p.destroy(),p=null)}function R(){m=!0,g&&(g=!1,S())}function b(){e.postMessage({msg:"mse_event",event:o.a.UPDATE_END})}function I(){a.a.v(t,"MSE SourceBuffer is full, report to main thread"),e.postMessage({msg:"mse_event",event:o.a.BUFFER_FULL})}function M(t){e.postMessage({msg:"player_event",event:c.a.ERROR,error_type:u.b.MEDIA_ERROR,error_detail:u.b.MEDIA_MSE_ERROR,info:t})}function O(t,i){e.postMessage({msg:"transmuxing_event",event:t,info:i})}function C(t,i){e.postMessage({msg:"player_event",event:t,extraData:i})}e.addEventListener("message",(function(r){if(!y){var _=r.data;switch(_.cmd){case"logging_config":var d=_;n.a.applyConfig(d.logging_config),!0===d.logging_config.enableCallback?n.a.addLogListener(i):n.a.removeLogListener(i);break;case"init":l=(d=_).media_data_source,h=d.config;break;case"destroy":!function(){p&&A();f&&T();y=!0,e.postMessage({msg:"destroyed"})}();break;case"initialize_mse":!function(){a.a.v(t,"Initializing MediaSource in DedicatedWorker"),(f=new s.a(h)).on(o.a.SOURCE_OPEN,R.bind(this)),f.on(o.a.UPDATE_END,b.bind(this)),f.on(o.a.BUFFER_FULL,I.bind(this)),f.on(o.a.ERROR,M.bind(this)),f.initialize({getCurrentTime:function(){return v},getReadyState:function(){return E}});var i=f.getHandle();e.postMessage({msg:"mse_init",handle:i},[i])}();break;case"shutdown_mse":T();break;case"load":S();break;case"unload":A();break;case"unbuffered_seek":d=_;f.flush(),p.seek(d.milliseconds);break;case"timeupdate":v=(d=_).current_time;break;case"readystatechange":E=(d=_).ready_state;break;case"pause_transmuxer":p.pause();break;case"resume_transmuxer":p.resume();break;case"switch_audio_track":d=_;p.switchAudioTrack(d.id);break;case"reset_audio":d=_;f.flush("audio"),p.seek(d.milliseconds)}}}))}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TLV_SI_CHANNEL_BONDING_CABLE_DELIVERY_SYSTEM_DESCRIPTOR=t.TLV_SI_SATELLITE_DELIVERY_SYSTEM_DESCRIPTOR=t.TLV_SI_SERVICE_LIST_DESCRIPTOR=t.TLV_SI_REMOTE_CONTROL_KEY_DESCRIPTOR=t.TLV_SI_SYSTEM_MANAGEMENT_DESCRIPTOR=t.TLV_SI_NETWORK_NAME_DESCRIPTOR=t.TLV_SI_AMT=t.TLV_SI_NIT_OTHER=t.TLV_SI_NIT_ACTUAL=void 0,t.readDescriptors=s,t.readNIT=_,t.readAMT=d,t.readTLVSI=function(e){var i=new r.BinaryReader(e,n.TLV_HEADER_SIZE);if(!i.canRead(1))return;switch(i.readUint8()){case t.TLV_SI_NIT_ACTUAL:return _(i,"TLV-NIT[actual]");case t.TLV_SI_NIT_OTHER:return _(i,"TLV-NIT[other]");case t.TLV_SI_AMT:return d(i)}};var a=i(24),n=i(26),r=i(15);function o(e){if(!(e.length<1)){for(var t=e[0],i=[],a=0;a<t&&!(e.length<1+5*a+2);a++){var n=e[1+5*a],r=e[1+5*a+1]<<8|e[1+5*a+2];i.push({remoteControlKeyId:n,serviceId:r})}return{tag:"remoteControlKey",keys:i}}}function s(e){for(var i=new r.BinaryReader(e),n=[];i.canRead(4);){var s=i.readUint8(),_=i.readUint8();if(!i.canRead(_))break;var d=i.subarray(_);switch(s){case t.TLV_SI_NETWORK_NAME_DESCRIPTOR:n.push((0,a.readNetworkNameDescriptor)(d));break;case t.TLV_SI_SYSTEM_MANAGEMENT_DESCRIPTOR:null!=(c=(0,a.readSystemManagementDescriptor)(d))&&n.push(c);break;case t.TLV_SI_REMOTE_CONTROL_KEY_DESCRIPTOR:null!=(c=o(d))&&n.push(c);break;case t.TLV_SI_SERVICE_LIST_DESCRIPTOR:null!=(c=(0,a.readServiceListDescriptor)(d))&&n.push(c);break;case t.TLV_SI_SATELLITE_DELIVERY_SYSTEM_DESCRIPTOR:null!=(c=(0,a.readSatelliteDeliverySystemDescriptor)(d))&&n.push(c);break;case t.TLV_SI_CHANNEL_BONDING_CABLE_DELIVERY_SYSTEM_DESCRIPTOR:var c;null!=(c=(0,a.readChannelBondingCableDeliverySystemDescriptor)(d))&&n.push(c)}}return n}function _(e,t){if(e.canRead(7)){var i=e.readUint16();if(!!(32768&i)){var a=4095&i;if(e.canRead(a)){var n=e.readUint16(),r=e.readUint8(),o=62&r,_=!!(1&r),d=e.readUint8(),c=e.readUint8();if(e.canRead(2)){var u=4095&e.readUint16();if(e.canRead(u)){var l=s(e.subarray(u)),h=4095&e.readUint16();if(e.canRead(h)){for(var f=[];e.canRead(10);){var p=e.readUint16(),m=e.readUint16(),g=4095&e.readUint16();if(!e.canRead(g))return;var v=s(e.subarray(g));f.push({tlvStreamId:p,originalNetworkId:m,descriptors:v})}return{tableId:t,networkId:n,versionNumber:o,currentNextIndicator:_,sectionNumber:d,lastSectionNumber:c,networkDescriptors:l,tlvStreams:f}}}}}}}}function d(e){if(e.canRead(7)){var t=e.readUint16();if(!!(32768&t)){var i=4095&t;if(e.canRead(i)){var a=e.readUint16(),n=e.readUint8(),r=62&n,o=!!(1&n),s=e.readUint8(),_=e.readUint8();if(e.canRead(2)){for(var d=(65472&e.readUint16())>>6,c=[],u=0;u<d;u++){if(!e.canRead(4))return;var l=e.readUint16(),h=e.readUint16(),f=1023&h,p=void 0,m=void 0;if(0===(32768&h)){if(!e.canRead(10))return;if(p={version:"IPv4",sourceAddress:e.slice(4),sourceAddressMask:e.readUint8(),destAddress:e.slice(4),destAddressMask:e.readUint8()},!e.canRead(f-10))return;m=e.slice(f-10)}else{if(!e.canRead(34))return;if(p={version:"IPv6",sourceAddress:e.slice(16),sourceAddressMask:e.readUint8(),destAddress:e.slice(16),destAddressMask:e.readUint8()},!e.canRead(f-34))return;m=e.slice(f-34)}c.push({serviceId:l,ip:p,privateData:m})}return{tableId:"AMT",tableIdExtension:a,versionNumber:r,currentNextIndicator:o,sectionNumber:s,lastSectionNumber:_,services:c}}}}}}t.TLV_SI_NIT_ACTUAL=64,t.TLV_SI_NIT_OTHER=65,t.TLV_SI_AMT=254,t.TLV_SI_NETWORK_NAME_DESCRIPTOR=64,t.TLV_SI_SYSTEM_MANAGEMENT_DESCRIPTOR=254,t.TLV_SI_REMOTE_CONTROL_KEY_DESCRIPTOR=205,t.TLV_SI_SERVICE_LIST_DESCRIPTOR=65,t.TLV_SI_SATELLITE_DELIVERY_SYSTEM_DESCRIPTOR=67,t.TLV_SI_CHANNEL_BONDING_CABLE_DELIVERY_SYSTEM_DESCRIPTOR=243},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT_TYPE_1080I_4_3=t.COMPONENT_TYPE_480P_OVER_16_9=t.COMPONENT_TYPE_480P_16_9=t.COMPONENT_TYPE_480P_4_3=t.COMPONENT_TYPE_480I_OVER_16_9=t.COMPONENT_TYPE_480I_16_9=t.COMPONENT_TYPE_480I_4_3=t.STREAM_CONTENT_VIDEO=t.LOGO_TRANSMISSION_TYPE_SIMPLE=t.LOGO_TRANSMISSION_TYPE_INDIRECT=t.LOGO_TRANSMISSION_TYPE_DIRECT=t.STUFFING_DESCRIPTOR=t.CHANNEL_BONDING_CABLE_DELIVERY_SYSTEM_DESCRIPTOR=t.CABLE_DELIVERY_SYSTEM_DESCRIPTOR=t.LOCAL_TIME_OFFSET_DESCRIPTOR=t.EXTENDED_EVENT_DESCRIPTOR=t.SERIES_DESCRIPTOR=t.COMPONENT_GROUP_DESCRIPTOR=t.EVENT_GROUP_DESCRIPTOR=t.PARENTAL_RATING_DESCRIPTOR=t.CONTENT_DESCRIPTOR=t.DATA_CONTENT_DESCRIPTOR=t.AUDIO_COMPONENT_DESCRIPTOR=t.COMPONENT_DESCRIPTOR=t.SHORT_EVENT_DESCRIPTOR=t.LINKAGE_DESCRIPTOR=t.LOGO_TRANSMISSION_DESCRIPTOR=t.CA_CONTRACT_INFO_DESCRIPTOR=t.SERVICE_DESCRIPTOR=t.EXTENDED_BROADCASTER_DESCRIPTOR=t.BROADCASTER_NAME_DESCRIPTOR=t.SI_PARAMETER_DESCRIPTOR=t.TS_INFORMATION_DESCRIPTOR=t.PARTIAL_RECEPTION_DESCRIPTOR=t.TERRESTRIAL_DELIVERY_SYSTEM_DESCRIPTOR=t.SATELLITE_DELIVERY_SYSTEM_DESCRIPTOR=t.SERVICE_LIST_DESCRIPTOR=t.CA_EMM_TS_DESCRIPTOR=t.SYSTEM_MANAGEMENT_DESCRIPTOR=t.NETWORK_NAME_DESCRIPTOR=t.VIDEO_DECODE_CONTROL_DESCRIPTOR=t.DATA_COMPONENT_DESCRIPTOR=t.HIERARCHICAL_TRANSMISSION_DESCRIPTOR=t.STREAM_IDENTIFIER_DESCRIPTOR=t.CONTENT_AVAILABILITY_DESCRIPTOR=t.EMERGENCY_INFORMATION_DESCRIPTOR=t.DIGITAL_COPY_CONTROL_DESCRIPTOR=t.CA_SERVICE_DESCRIPTOR=t.ACCESS_CONTROL_DESCRIPTOR=t.CA_DESCRIPTOR=void 0,t.EVENT_GROUP_TYPE_MOVEMENT_FROM_OTHER_NETWORK=t.EVENT_GROUP_TYPE_RELAY_TO_OTHER_NETWORK=t.EVENT_GROUP_TYPE_MOVEMENT=t.EVENT_GROUP_TYPE_RELAY=t.EVENT_GROUP_TYPE_SHARING=t.STREAM_TYPE_LATM_LOAS=t.STREAM_TYPE_ADTS_AAC=t.SAMPLING_RATE_48000=t.SAMPLING_RATE_32000=t.SAMPLING_RATE_24000=t.QUALITY_INDICATOR_MODE3=t.QUALITY_INDICATOR_MODE2=t.QUALITY_INDICATOR_MODE1=t.AUDIO_COMPONENT_TYPE_5POINT1=t.AUDIO_COMPONENT_TYPE_3_2=t.AUDIO_COMPONENT_TYPE_3_1=t.AUDIO_COMPONENT_TYPE_STEREO=t.AUDIO_COMPONENT_TYPE_DUAL_MONO=t.AUDIO_COMPONENT_TYPE_MONO=t.STREAM_CONTENT_AUDIO=t.COMPONENT_TYPE_240P_OVER_16_9=t.COMPONENT_TYPE_240P_16_9=t.COMPONENT_TYPE_240P_4_3=t.COMPONENT_TYPE_720P_OVER_16_9=t.COMPONENT_TYPE_720P_16_9=t.COMPONENT_TYPE_720P_4_3=t.COMPONENT_TYPE_1080I_OVER_16_9=t.COMPONENT_TYPE_1080I_16_9=void 0,t.readDescriptors=function(e){var i=[],B=new a.BinaryReader(e);for(;B.canRead(2);){var x=B.readUint8(),V=B.readUint8();if(!B.canRead(V))break;var G=B.subarray(V),F=void 0;switch(x){case t.CA_DESCRIPTOR:F=r(G);break;case t.ACCESS_CONTROL_DESCRIPTOR:F=o(G);break;case t.CA_SERVICE_DESCRIPTOR:F=s(G);break;case t.DIGITAL_COPY_CONTROL_DESCRIPTOR:F=_(G);break;case t.EMERGENCY_INFORMATION_DESCRIPTOR:F=(0,n.readEmergencyInformationDescriptor)(G);break;case t.CONTENT_AVAILABILITY_DESCRIPTOR:F=d(G);break;case t.STREAM_IDENTIFIER_DESCRIPTOR:F=c(G);break;case t.HIERARCHICAL_TRANSMISSION_DESCRIPTOR:F=u(G);break;case t.DATA_COMPONENT_DESCRIPTOR:F=l(G);break;case t.VIDEO_DECODE_CONTROL_DESCRIPTOR:F=h(G);break;case t.NETWORK_NAME_DESCRIPTOR:F=(0,n.readNetworkNameDescriptor)(G);break;case t.SYSTEM_MANAGEMENT_DESCRIPTOR:F=(0,n.readSystemManagementDescriptor)(G);break;case t.CA_EMM_TS_DESCRIPTOR:F=f(G);break;case t.SERVICE_LIST_DESCRIPTOR:F=(0,n.readServiceListDescriptor)(G);break;case t.SATELLITE_DELIVERY_SYSTEM_DESCRIPTOR:F=(0,n.readSatelliteDeliverySystemDescriptor)(G);break;case t.TERRESTRIAL_DELIVERY_SYSTEM_DESCRIPTOR:F=p(G);break;case t.PARTIAL_RECEPTION_DESCRIPTOR:F=m(G);break;case t.TS_INFORMATION_DESCRIPTOR:F=g(G);break;case t.SI_PARAMETER_DESCRIPTOR:F=v(G);break;case t.BROADCASTER_NAME_DESCRIPTOR:F=E(G);break;case t.EXTENDED_BROADCASTER_DESCRIPTOR:F=y(G);break;case t.SERVICE_DESCRIPTOR:F=T(G);break;case t.CA_CONTRACT_INFO_DESCRIPTOR:F=S(G);break;case t.LOGO_TRANSMISSION_DESCRIPTOR:F=A(G);break;case t.LINKAGE_DESCRIPTOR:F=R(G);break;case t.SHORT_EVENT_DESCRIPTOR:F=b(G);break;case t.COMPONENT_DESCRIPTOR:F=I(G);break;case t.AUDIO_COMPONENT_DESCRIPTOR:F=M(G);break;case t.DATA_CONTENT_DESCRIPTOR:F=O(G);break;case t.CONTENT_DESCRIPTOR:F=C(G);break;case t.PARENTAL_RATING_DESCRIPTOR:F=D(G);break;case t.EVENT_GROUP_DESCRIPTOR:F=L(G);break;case t.COMPONENT_GROUP_DESCRIPTOR:F=P(G);break;case t.SERIES_DESCRIPTOR:F=k(G);break;case t.EXTENDED_EVENT_DESCRIPTOR:F=N(G);break;case t.LOCAL_TIME_OFFSET_DESCRIPTOR:F=w(G);break;case t.CABLE_DELIVERY_SYSTEM_DESCRIPTOR:F=U(G);break;case t.CHANNEL_BONDING_CABLE_DELIVERY_SYSTEM_DESCRIPTOR:F=(0,n.readChannelBondingCableDeliverySystemDescriptor)(G);break;case t.STUFFING_DESCRIPTOR:F={tag:"stuffing"};break;default:continue}null!=F&&i.push(F)}return i},t.readComponentGroupDescriptor=P;var a=i(15),n=i(24);function r(e){var t=new a.BinaryReader(e);if(t.canRead(4))return{tag:"ca",caSystemId:t.readUint16(),caPID:8191&t.readUint16(),privateData:t.slice()}}function o(e){var t=new a.BinaryReader(e);if(t.canRead(4)){var i=t.readUint16(),n=t.readUint16();return{tag:"accessControl",caSystemId:i,transmissionType:n>>13,pid:8191&n,privateData:t.slice()}}}function s(e){var t=new a.BinaryReader(e);if(t.canRead(4)){for(var i=t.readUint16(),n=t.readUint8(),r=t.readUint8(),o=[];t.canRead(2);)o.push(t.readUint16());return{tag:"caService",caSystemId:i,caBroadcasterGroupId:n,messageControl:r,serviceIdList:o}}}function _(e){var t=new a.BinaryReader(e);if(t.canRead(1)){var i=t.readUint8(),n=i>>6,r=!!(i>>5&1),o=!!(i>>4&1),s=i>>2&3,_=0!==s?3&i:void 0;if(!r||t.canRead(1)){var d=r?t.readUint8():void 0,c=o?[]:void 0;if(null!=c){if(!t.canRead(1))return;var u=t.readUint8();if(!t.canRead(u))return;for(var l=new a.BinaryReader(t.subarray(u));l.canRead(2);){var h=l.readUint8(),f=l.readUint8(),p=f>>6,m=!!(f>>5&1),g=f>>2&3,v=0!==g?3&f:void 0;if(m&&!l.canRead(1))break;var E=m?l.readUint8():void 0;c.push({componentTag:h,digitalRecordingControlData:p,copyControlType:g,apsControlData:v,maximumBitRate:E})}}return{tag:"digitalCopyControl",digitalRecordingControlData:n,copyControlType:s,apsControlData:_,maximumBitRate:d,componentControls:c}}}}function d(e){if(!(e.length<1))return{tag:"contentAvailability",copyRestrictionMode:!!(64&e[0]),imageConstraintToken:!!(32&e[0]),retentionMode:!!(16&e[0]),retentionState:e[0]>>1&7,encryptionMode:!!(1&e[0])}}function c(e){if(!(e.length<1))return{tag:"streamIdentifier",componentTag:e[0]}}function u(e){var t=new a.BinaryReader(e);if(t.canRead(3))t.readUint8(),t.readUint16()}function l(e){var t=new a.BinaryReader(e);if(t.canRead(2))return{tag:"dataComponent",dataComponentId:t.readUint16(),additionalDataComponentInfo:t.slice()}}function h(e){if(!(e.length<1))return{tag:"videoDecodeControl",stillPictureFlag:!!(128&e[0]),sequenceEndCodeFlag:!!(64&e[0]),videoEncodeFormat:e[0]>>2&15}}function f(e){var t=new a.BinaryReader(e);if(t.canRead(7))return{tag:"caEMMTS",caSystemId:t.readUint16(),transportStreamId:t.readUint16(),originalNetworkId:t.readUint16(),powerSupplyPeriod:t.readUint8()}}function p(e){var t=new a.BinaryReader(e);if(t.canRead(2)){for(var i=t.readUint16(),n=i>>4,r=i>>2&3,o=3&i,s=[];t.canRead(2);)s.push(t.readUint16());return{tag:"terrestrialDeliverySystem",areaCode:n,guardInterval:r,transmissionMode:o,frequencies:s}}}function m(e){for(var t=new a.BinaryReader(e),i=[];t.canRead(2);)i.push(t.readUint16());return{tag:"partialReception",serviceIdList:i}}function g(e){var t=new a.BinaryReader(e);if(t.canRead(2)){var i=t.readUint8(),n=t.readUint8(),r=n>>2,o=3&n;if(t.canRead(r)){for(var s=t.slice(r),_=[],d=0;d<o;d++){if(!t.canRead(2))return;for(var c=t.readUint8(),u=t.readUint8(),l=[],h=0;h<u;h++){if(!t.canRead(2))return;var f=t.readUint16();l.push(f)}_.push({transmissionTypeInfo:c,serviceIdList:l})}return{tag:"tsInformation",remoteControlKeyId:i,tsName:s,transmissionTypes:_}}}}function v(e){var t=new a.BinaryReader(e);if(t.canRead(3)){for(var i=t.readUint8(),n=t.readUint16(),r=[];t.canRead(2);){var o=t.readUint8(),s=t.readUint8(),_=t.slice(s);r.push({tableId:o,tableDescription:_})}return{tag:"siParameterDescriptor",parameterVersion:i,updateTime:n,tableParameters:r}}}function E(e){return{tag:"broadcasterName",name:e.slice()}}function y(e){var t=new a.BinaryReader(e);if(t.canRead(1)){var i=t.readUint8()>>4;if(1===i){var n=t.readUint16(),r=t.readUint8(),o=r>>4,s=15&r,_=[];if(!t.canRead(o))return;for(var d=0;d<o;d++){var c=t.readUint8();_.push(c)}if(!t.canRead(3*s))return;var u=[];for(d=0;d<s;d++){var l=t.readUint16(),h=t.readUint8();u.push({originalNetworkId:l,broadcasterId:h})}t.slice();return{tag:"extendedBroadcaster",broadcasterType:i,terrestrialBroadcasterId:n,affiliationIdList:_,broadcasters:u}}return{tag:"extendedBroadcaster",broadcasterType:i}}}function T(e){var t=new a.BinaryReader(e);if(t.canRead(2)){var i=t.readUint8(),n=t.readUint8();if(t.canRead(n)){var r=t.slice(n);if(t.canRead(1)){var o=t.readUint8();if(t.canRead(o))return{tag:"serviceDescriptor",serviceType:i,serviceProviderName:r,serviceName:t.slice(o)}}}}}function S(e){var t=new a.BinaryReader(e);if(t.canRead(3)){var i=t.readUint16(),n=t.readUint8(),r=n>>4,o=15&n;if(t.canRead(o)){for(var s=[],_=0;_<o;_++)s.push(t.readUint8());if(t.canRead(1)){var d=t.readUint8();if(t.canRead(d)){var c=t.slice(d);if(t.canRead(1)){var u=t.readUint8();if(t.canRead(u))return{tag:"caContractInfoDescriptor",caSystemId:i,caUnitId:r,components:s,contractVerificationInfo:c,feeName:t.slice(u)}}}}}}}function A(e){var i=new a.BinaryReader(e);if(i.canRead(1)){var n=i.readUint8();if(n===t.LOGO_TRANSMISSION_TYPE_DIRECT){if(!i.canRead(6))return;return{tag:"logoTransmission",logoTransmissionType:n,logoId:511&i.readUint16(),logoVersion:4095&i.readUint16(),downloadDataId:i.readUint16()}}if(n===t.LOGO_TRANSMISSION_TYPE_INDIRECT){if(!i.canRead(2))return;return{tag:"logoTransmission",logoTransmissionType:n,logoId:511&i.readUint16()}}return n===t.LOGO_TRANSMISSION_TYPE_SIMPLE?{tag:"logoTransmission",logoTransmissionType:n,logoChar:i.slice()}:void 0}}function R(e){var t=new a.BinaryReader(e);if(t.canRead(7))return{tag:"linkage",transportStreamId:t.readUint16(),originalNetworkId:t.readUint16(),serviceId:t.readUint16(),linkageType:t.readUint8(),privateData:t.slice()}}function b(e){var t=new a.BinaryReader(e);if(t.canRead(4)){var i=t.readUint24(),n=t.readUint8();if(t.canRead(n)){var r=t.slice(n);if(t.canRead(1)){var o=t.readUint8();if(t.canRead(o))return{tag:"shortEvent",iso639LanguageCode:i,eventName:r,text:t.slice(o)}}}}}function I(e){var t=new a.BinaryReader(e);if(t.canRead(6))return{tag:"component",streamContent:15&t.readUint8(),componentType:t.readUint8(),componentTag:t.readUint8(),iso639LanguageCode:t.readUint24(),text:t.slice()}}function M(e){var t=new a.BinaryReader(e);if(t.canRead(9)){var i=15&t.readUint8(),n=t.readUint8(),r=t.readUint8(),o=t.readUint8(),s=t.readUint8(),_=t.readUint8(),d=!!(128&_),c=!!(64&_),u=_>>4&3,l=_>>1&7,h=t.readUint24();if(!d||t.canRead(3))return{tag:"audioComponent",streamContent:i,componentType:n,componentTag:r,streamType:o,simulcastGroupTag:s,mainComponentFlag:c,qualityIndicator:u,samplingRate:l,iso639LanguageCode:h,esMultiLingualISO639LanguageCode:d?t.readUint24():void 0,text:t.slice()}}}function O(e){var t=new a.BinaryReader(e);if(t.canRead(4)){var i=t.readUint16(),n=t.readUint8(),r=t.readUint8();if(t.canRead(r)){var o=t.slice(r);if(t.canRead(5)){var s=t.readUint8();if(t.canRead(s)){var _=Array.from(t.subarray(s));if(t.canRead(4)){var d=t.readUint24(),c=t.readUint8();if(t.canRead(c))return{tag:"dataContent",dataComponentId:i,entryComponent:n,selector:o,componentReferences:_,iso639LanguageCode:d,text:t.slice(c)}}}}}}}function C(e){for(var t=new a.BinaryReader(e),i=[];t.canRead(2);){var n=t.readUint8(),r=t.readUint8();i.push({contentNibbleLevel1:n>>4,contentNibbleLevel2:15&n,userNibble:r})}return{tag:"content",items:i}}function D(e){for(var t=new a.BinaryReader(e),i=[];t.canRead(4);){var n=t.readUint24(),r=t.readUint8();i.push({countryCode:n,rating:r})}return{tag:"parentalRating",ratings:i}}function L(e){var i=new a.BinaryReader(e);if(i.canRead(1)){var n=i.readUint8(),r=n>>4,o=15&n,s=[];if(i.canRead(4*o)){for(var _=0;_<o;_++){var d=i.readUint16(),c=i.readUint16();s.push({serviceId:d,eventId:c})}if(r===t.EVENT_GROUP_TYPE_RELAY_TO_OTHER_NETWORK||r===t.EVENT_GROUP_TYPE_MOVEMENT_FROM_OTHER_NETWORK){for(var u=[];i.canRead(8);){var l=i.readUint16(),h=i.readUint16();d=i.readUint16(),c=i.readUint16();u.push({originalNetworkId:l,transportStreamId:h,serviceId:d,eventId:c})}return{tag:"eventGroup",groupType:r,events:s,otherNetworkEvents:u}}return{tag:"eventGroup",groupType:r,events:s,privateData:i.slice()}}}}function P(e){var t=new a.BinaryReader(e);if(t.canRead(1)){for(var i=t.readUint8(),n=i>>5,r=16&i,o=15&i,s=[],_=0;_<o;_++){if(!t.canRead(1))return;for(var d=t.readUint8(),c=d>>4,u=15&d,l=[],h=0;h<u;h++){if(!t.canRead(1))return;var f=t.readUint8(),p=f>>4,m=15&f;if(!t.canRead(m))return;var g=Array.from(t.subarray(m));l.push({caUnitId:p,componentTags:g})}if(r&&!t.canRead(1))return;var v=r?t.readUint8():void 0;if(!t.canRead(1))return;var E=t.readUint8();if(!t.canRead(E))return;var y=t.slice(E);s.push({componentGroupId:c,caUnits:l,totalBitRate:v,text:y})}return{tag:"componentGroup",componentGroupType:n,groups:s}}}function k(e){var t=new a.BinaryReader(e);if(t.canRead(8)){var i=t.readUint16(),n=t.readUint8(),r=n>>4,o=n>>1&7,s=!!(1&n),_=t.readUint16(),d=t.readUint24();return{tag:"series",seriesId:i,repeatLabel:r,programPattern:o,expireDateValidFlag:s,expireDate:_,episodeNumber:d>>12,lastEpisodeNumber:4095&d,seriesName:t.slice()}}}function N(e){var t=new a.BinaryReader(e);if(t.canRead(5)){var i=t.readUint8(),n=i>>4,r=15&i,o=t.readUint24(),s=t.readUint8();if(t.canRead(s)){for(var _=[],d=new a.BinaryReader(t.subarray(s));d.canRead(1);){var c=d.readUint8();if(!d.canRead(c))break;var u=d.slice(c);if(!d.canRead(1))break;var l=d.readUint8();if(!d.canRead(l))break;var h=d.slice(l);_.push({itemDescription:u,item:h})}if(t.canRead(1)){var f=t.readUint8();if(t.canRead(f))return{tag:"extendedEvent",descriptorNumber:n,lastDescriptorNumber:r,iso639LanguageCode:o,items:_,text:t.slice(f)}}}}}function w(e){for(var t=new a.BinaryReader(e),i=[];t.canRead(13);){var n=t.readUint24(),r=t.readUint8(),o=r>>2,s=!!(1&r),_=t.readUint16(),d=t.readUint40(),c=t.readUint16();i.push({countryCode:n,countryRegionId:o,localTimeOffsetPolarity:s,localTimeOffset:_,timeOfChange:d,nextTimeOffset:c})}return{tag:"localTimeOffset",offsets:i}}function U(e){var t=new a.BinaryReader(e);if(t.canRead(11)){var i=t.readUint32();t.skip(1);var n=t.readUint8(),r=n>>4,o=15&n,s=t.readUint8(),_=t.readUint32();return{tag:"cableDeliverySystemDescriptor",frequency:i,frameType:r,fecOuter:o,modulation:s,symbolRate:_>>>4,fecInner:15&_}}}t.CA_DESCRIPTOR=9,t.ACCESS_CONTROL_DESCRIPTOR=246,t.CA_SERVICE_DESCRIPTOR=204,t.DIGITAL_COPY_CONTROL_DESCRIPTOR=193,t.EMERGENCY_INFORMATION_DESCRIPTOR=252,t.CONTENT_AVAILABILITY_DESCRIPTOR=222,t.STREAM_IDENTIFIER_DESCRIPTOR=82,t.HIERARCHICAL_TRANSMISSION_DESCRIPTOR=192,t.DATA_COMPONENT_DESCRIPTOR=253,t.VIDEO_DECODE_CONTROL_DESCRIPTOR=200,t.NETWORK_NAME_DESCRIPTOR=64,t.SYSTEM_MANAGEMENT_DESCRIPTOR=254,t.CA_EMM_TS_DESCRIPTOR=202,t.SERVICE_LIST_DESCRIPTOR=65,t.SATELLITE_DELIVERY_SYSTEM_DESCRIPTOR=67,t.TERRESTRIAL_DELIVERY_SYSTEM_DESCRIPTOR=250,t.PARTIAL_RECEPTION_DESCRIPTOR=251,t.TS_INFORMATION_DESCRIPTOR=205,t.SI_PARAMETER_DESCRIPTOR=215,t.BROADCASTER_NAME_DESCRIPTOR=216,t.EXTENDED_BROADCASTER_DESCRIPTOR=206,t.SERVICE_DESCRIPTOR=72,t.CA_CONTRACT_INFO_DESCRIPTOR=203,t.LOGO_TRANSMISSION_DESCRIPTOR=207,t.LINKAGE_DESCRIPTOR=74,t.SHORT_EVENT_DESCRIPTOR=77,t.COMPONENT_DESCRIPTOR=80,t.AUDIO_COMPONENT_DESCRIPTOR=196,t.DATA_CONTENT_DESCRIPTOR=199,t.CONTENT_DESCRIPTOR=84,t.PARENTAL_RATING_DESCRIPTOR=85,t.EVENT_GROUP_DESCRIPTOR=214,t.COMPONENT_GROUP_DESCRIPTOR=217,t.SERIES_DESCRIPTOR=213,t.EXTENDED_EVENT_DESCRIPTOR=78,t.LOCAL_TIME_OFFSET_DESCRIPTOR=88,t.CABLE_DELIVERY_SYSTEM_DESCRIPTOR=68,t.CHANNEL_BONDING_CABLE_DELIVERY_SYSTEM_DESCRIPTOR=243,t.STUFFING_DESCRIPTOR=66,t.LOGO_TRANSMISSION_TYPE_DIRECT=1,t.LOGO_TRANSMISSION_TYPE_INDIRECT=2,t.LOGO_TRANSMISSION_TYPE_SIMPLE=3,t.STREAM_CONTENT_VIDEO=1,t.COMPONENT_TYPE_480I_4_3=1,t.COMPONENT_TYPE_480I_16_9=3,t.COMPONENT_TYPE_480I_OVER_16_9=4,t.COMPONENT_TYPE_480P_4_3=161,t.COMPONENT_TYPE_480P_16_9=163,t.COMPONENT_TYPE_480P_OVER_16_9=164,t.COMPONENT_TYPE_1080I_4_3=177,t.COMPONENT_TYPE_1080I_16_9=179,t.COMPONENT_TYPE_1080I_OVER_16_9=180,t.COMPONENT_TYPE_720P_4_3=193,t.COMPONENT_TYPE_720P_16_9=195,t.COMPONENT_TYPE_720P_OVER_16_9=196,t.COMPONENT_TYPE_240P_4_3=209,t.COMPONENT_TYPE_240P_16_9=211,t.COMPONENT_TYPE_240P_OVER_16_9=212,t.STREAM_CONTENT_AUDIO=2,t.AUDIO_COMPONENT_TYPE_MONO=1,t.AUDIO_COMPONENT_TYPE_DUAL_MONO=2,t.AUDIO_COMPONENT_TYPE_STEREO=3,t.AUDIO_COMPONENT_TYPE_3_1=7,t.AUDIO_COMPONENT_TYPE_3_2=8,t.AUDIO_COMPONENT_TYPE_5POINT1=9,t.QUALITY_INDICATOR_MODE1=1,t.QUALITY_INDICATOR_MODE2=2,t.QUALITY_INDICATOR_MODE3=3,t.SAMPLING_RATE_24000=3,t.SAMPLING_RATE_32000=5,t.SAMPLING_RATE_48000=7,t.STREAM_TYPE_ADTS_AAC=15,t.STREAM_TYPE_LATM_LOAS=17,t.EVENT_GROUP_TYPE_SHARING=1,t.EVENT_GROUP_TYPE_RELAY=2,t.EVENT_GROUP_TYPE_MOVEMENT=3,t.EVENT_GROUP_TYPE_RELAY_TO_OTHER_NETWORK=4,t.EVENT_GROUP_TYPE_MOVEMENT_FROM_OTHER_NETWORK=5},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.readMPU=function(e){var t=new a.BinaryReader(e);if(!t.canRead(6))return;var i=t.readUint8(),n=i>>4,r=!!(i>>3&1),o=i>>1&3,s=!!(1&i),_=t.readUint8(),d=t.readUint32();if(2!==n)return;if(r){var c=[];if(s)for(;t.canRead(2);){var u=t.readUint16();if(!t.canRead(u))break;if(u<14)break;l=t.readUint32(),h=t.readUint32(),f=t.readUint32(),p=t.readUint8(),m=t.readUint8(),g=t.subarray(u-4-4-4-1-1);c.push({movieFragmentSequenceNumber:l,sampleNumber:h,offset:f,priority:p,dependencyCounter:m,mfuData:g})}else{if(!t.canRead(14))return;var l=t.readUint32(),h=t.readUint32(),f=t.readUint32(),p=t.readUint8(),m=t.readUint8(),g=e.subarray(t.tell());c.push({movieFragmentSequenceNumber:l,sampleNumber:h,offset:f,priority:p,dependencyCounter:m,mfuData:g})}return{fragmentType:"mfu",timedFlag:r,fragmentationIndicator:o,aggregationFlag:s,fragmentCounter:_,mpuSequenceNumber:d,mfuList:c}}c=[];if(s)for(;t.canRead(2);){u=t.readUint16();if(!t.canRead(u))break;if(u<4)break;v=t.readUint32(),g=t.subarray(u-4);c.push({itemId:v,mfuData:g})}else{if(!t.canRead(4))return;var v=t.readUint32(),g=e.subarray(t.tell());c.push({itemId:v,mfuData:g})}return{fragmentType:"mfu",timedFlag:r,fragmentationIndicator:o,aggregationFlag:s,fragmentCounter:_,mpuSequenceNumber:d,mfuList:c}};var a=i(15)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CustomEventTarget=void 0;var a=function(){function e(){this.events={}}return e.prototype.addEventListener=function(e,t){var i=this.events[e];null==i&&(i=new Set,this.events[e]=i),i.add(t)},e.prototype.getListenerCount=function(e){var t,i;return null!==(i=null===(t=this.events[e])||void 0===t?void 0:t.size)&&void 0!==i?i:0},e.prototype.dispatchEvent=function(e,t){var i=this.events[e];null!=i&&i.forEach((function(e){return e(t)}))},e.prototype.removeEventListener=function(e,t){var i=this.events[e];null!=i&&i.delete(t)},e}();t.CustomEventTarget=a},function(e,t,i){"use strict";i.r(t);var a=i(20),n=i(17),r={enableWorker:!1,enableWorkerForMSE:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,liveBufferLatencyChasing:!1,liveBufferLatencyChasingOnPaused:!1,liveBufferLatencyMaxLatency:1.5,liveBufferLatencyMinRemain:.5,liveSync:!1,liveSyncMaxLatency:1.2,liveSyncTargetLatency:.8,liveSyncPlaybackRate:1.2,liveSyncMinLatency:void 0,liveSyncMinPlaybackRate:.95,lazyLoad:!0,lazyLoadMaxDuration:180,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:180,autoCleanupMinBackwardDuration:120,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function o(){return Object.assign({},r)}var s=i(9),_=i.n(s),d=i(21),c=i(0),u=i(8),l=i(7),h=i(4),f=i(1),p=i(5),m=i(14),g=function(){function e(e,t,i){this.TAG="SeekingHandler",this._config=null,this._media_element=null,this._always_seek_keyframe=!1,this._on_unbuffered_seek=null,this._request_set_current_time=!1,this._seek_request_record_clocktime=null,this._idr_sample_list=new m.a,this.e=null,this._config=e,this._media_element=t,this._on_unbuffered_seek=i,this.e={onMediaSeeking:this._onMediaSeeking.bind(this)};var a=p.a.chrome&&(p.a.version.major<50||50===p.a.version.major&&p.a.version.build<2661);this._always_seek_keyframe=!!(a||p.a.msedge||p.a.msie),this._always_seek_keyframe&&(this._config.accurateSeek=!1),this._media_element.addEventListener("seeking",this.e.onMediaSeeking)}return e.prototype.destroy=function(){this._idr_sample_list.clear(),this._idr_sample_list=null,this._media_element.removeEventListener("seeking",this.e.onMediaSeeking),this._media_element=null,this._on_unbuffered_seek=null},e.prototype.seek=function(e){var t=this._isPositionBuffered(e),i=!1;if(e<1&&this._media_element.buffered.length>0){var a=this._media_element.buffered.start(0);(a<1&&e<a||p.a.safari)&&(i=!0,e=p.a.safari?.1:a)}if(i)this.directSeek(e);else if(t)if(this._always_seek_keyframe){var n=this._getNearestKeyframe(Math.floor(1e3*e));null!=n&&(e=n.dts/1e3),this.directSeek(e)}else this.directSeek(e);else this._idr_sample_list.clear(),this._on_unbuffered_seek(Math.floor(1e3*e)),this._config.accurateSeek&&this.directSeek(e)},e.prototype.directSeek=function(e){this._request_set_current_time=!0,this._media_element.currentTime=e},e.prototype.appendSyncPoints=function(e){this._idr_sample_list.appendArray(e)},e.prototype._onMediaSeeking=function(t){if(this._request_set_current_time)this._request_set_current_time=!1;else{var i=this._media_element.currentTime,a=this._media_element.buffered;if(i<1&&a.length>0){var n=a.start(0);if(n<1&&i<n||p.a.safari){var r=p.a.safari?.1:n;return void this.directSeek(r)}}if(this._isPositionBuffered(i)){if(this._always_seek_keyframe){var o=this._getNearestKeyframe(Math.floor(1e3*i));null!=o&&(i=o.dts/1e3,this.directSeek(i))}}else this._seek_request_record_clocktime=e._getClockTime(),window.setTimeout(this._pollAndApplyUnbufferedSeek.bind(this),50)}},e.prototype._pollAndApplyUnbufferedSeek=function(){if(null!=this._seek_request_record_clocktime)if(this._seek_request_record_clocktime<=e._getClockTime()-100){var t=this._media_element.currentTime;this._seek_request_record_clocktime=null,this._isPositionBuffered(t)||(this._idr_sample_list.clear(),this._on_unbuffered_seek(Math.floor(1e3*t)),this._config.accurateSeek&&this.directSeek(t))}else window.setTimeout(this._pollAndApplyUnbufferedSeek.bind(this),50)},e.prototype._isPositionBuffered=function(e){for(var t=this._media_element.buffered,i=0;i<t.length;i++){var a=t.start(i),n=t.end(i);if(e>=a&&e<n)return!0}return!1},e.prototype._getNearestKeyframe=function(e){return this._idr_sample_list.getLastSyncPointBeforeDts(e)},e._getClockTime=function(){return self.performance&&self.performance.now?self.performance.now():Date.now()},e}(),v=function(){function e(e,t,i,a){this.TAG="LoadingController",this._config=null,this._media_element=null,this._on_pause_transmuxer=null,this._on_resume_transmuxer=null,this._paused=!1,this.e=null,this._config=e,this._media_element=t,this._on_pause_transmuxer=i,this._on_resume_transmuxer=a,this.e={onMediaTimeUpdate:this._onMediaTimeUpdate.bind(this)}}return e.prototype.destroy=function(){this._media_element.removeEventListener("timeupdate",this.e.onMediaTimeUpdate),this.e=null,this._media_element=null,this._config=null,this._on_pause_transmuxer=null,this._on_resume_transmuxer=null},e.prototype.notifyBufferedPositionChanged=function(e){!this._config.isLive&&this._config.lazyLoad&&(null==e?this._suspendTransmuxerIfNeeded():this._suspendTransmuxerIfBufferedPositionExceeded(e))},e.prototype._onMediaTimeUpdate=function(e){this._paused&&this._resumeTransmuxerIfNeeded()},e.prototype._suspendTransmuxerIfNeeded=function(){for(var e=this._media_element.buffered,t=this._media_element.currentTime,i=0,a=0;a<e.length;a++){var n=e.start(a),r=e.end(a);if(n<=t&&t<r){i=r;break}}i>0&&this._suspendTransmuxerIfBufferedPositionExceeded(i)},e.prototype._suspendTransmuxerIfBufferedPositionExceeded=function(e){e>=this._media_element.currentTime+this._config.lazyLoadMaxDuration&&!this._paused&&(c.a.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this.suspendTransmuxer(),this._media_element.addEventListener("timeupdate",this.e.onMediaTimeUpdate))},e.prototype.suspendTransmuxer=function(){this._paused=!0,this._on_pause_transmuxer()},e.prototype._resumeTransmuxerIfNeeded=function(){for(var e=this._media_element.buffered,t=this._media_element.currentTime,i=this._config.lazyLoadRecoverDuration,a=!1,n=0;n<e.length;n++){var r=e.start(n),o=e.end(n);if(t>=r&&t<o){t>=o-i&&(a=!0);break}}a&&(c.a.v(this.TAG,"Continue loading from paused position"),this.resumeTransmuxer(),this._media_element.removeEventListener("timeupdate",this.e.onMediaTimeUpdate))},e.prototype.resumeTransmuxer=function(){this._paused=!1,this._on_resume_transmuxer()},e}(),E=function(){function e(e,t){this.TAG="StartupStallJumper",this._media_element=null,this._on_direct_seek=null,this._canplay_received=!1,this.e=null,this._media_element=e,this._on_direct_seek=t,this.e={onMediaCanPlay:this._onMediaCanPlay.bind(this),onMediaStalled:this._onMediaStalled.bind(this),onMediaProgress:this._onMediaProgress.bind(this)},this._media_element.addEventListener("canplay",this.e.onMediaCanPlay),this._media_element.addEventListener("stalled",this.e.onMediaStalled),this._media_element.addEventListener("progress",this.e.onMediaProgress)}return e.prototype.destroy=function(){this._media_element.removeEventListener("canplay",this.e.onMediaCanPlay),this._media_element.removeEventListener("stalled",this.e.onMediaStalled),this._media_element.removeEventListener("progress",this.e.onMediaProgress),this._media_element=null,this._on_direct_seek=null},e.prototype._onMediaCanPlay=function(e){this._canplay_received=!0,this._media_element.removeEventListener("canplay",this.e.onMediaCanPlay)},e.prototype._onMediaStalled=function(e){this._detectAndFixStuckPlayback(!0)},e.prototype._onMediaProgress=function(e){this._detectAndFixStuckPlayback()},e.prototype._detectAndFixStuckPlayback=function(e){var t=this._media_element,i=t.buffered;e||!this._canplay_received||t.readyState<2?i.length>0&&t.currentTime<i.start(0)&&(c.a.w(this.TAG,"Playback seems stuck at ".concat(t.currentTime,", seek to ").concat(i.start(0))),this._on_direct_seek(i.start(0)),this._media_element.removeEventListener("progress",this.e.onMediaProgress)):this._media_element.removeEventListener("progress",this.e.onMediaProgress)},e}(),y=function(){function e(e,t,i){this._config=null,this._media_element=null,this._on_direct_seek=null,this._config=e,this._media_element=t,this._on_direct_seek=i}return e.prototype.destroy=function(){this._on_direct_seek=null,this._media_element=null,this._config=null},e.prototype.notifyBufferedRangeUpdate=function(){if(!this._config.systemClockSync){var e=this._media_element.buffered;if(0!==e.length){var t=e.end(e.length-1);this._chaseLiveLatency(t)}}},e.prototype.onSystemClock=function(e){this._chaseLiveLatency(e)},e.prototype._chaseLiveLatency=function(e){var t=this._media_element.currentTime,i=this._media_element.paused;if(this._config.isLive&&this._config.liveBufferLatencyChasing&&(this._config.liveBufferLatencyChasingOnPaused||!i)&&e>this._config.liveBufferLatencyMaxLatency&&e-t>this._config.liveBufferLatencyMaxLatency){var a=e-this._config.liveBufferLatencyMinRemain;this._on_direct_seek(a)}},e}(),T=function(){function e(e,t){this.TAG="LiveLatencySynchronizer",this._config=null,this._media_element=null,this.e=null,this._config=e,this._media_element=t,this.e={onMediaTimeUpdate:this._onMediaTimeUpdate.bind(this)},this._media_element.addEventListener("timeupdate",this.e.onMediaTimeUpdate)}return e.prototype.destroy=function(){this._media_element.removeEventListener("timeupdate",this.e.onMediaTimeUpdate),this._media_element=null,this._config=null},e.prototype.onSystemClock=function(e){var t=e-this._media_element.currentTime;this._sync(t)},e.prototype._onMediaTimeUpdate=function(e){this._config.isLive&&this._config.liveSync&&!this._config.systemClockSync&&this._sync(this._getCurrentLatency())},e.prototype._sync=function(e){if(e>this._config.liveSyncMaxLatency){var t=Math.min(2,Math.max(1,this._config.liveSyncPlaybackRate));this._media_element.playbackRate!==t&&(c.a.v(this.TAG,"playbackRate ".concat(this._media_element.playbackRate," => ").concat(t)),this._media_element.playbackRate=t)}else if(e>this._config.liveSyncTargetLatency);else if(null!=this._config.liveSyncMinLatency&&e<this._config.liveSyncMinLatency){t=Math.min(1,Math.max(.5,this._config.liveSyncMinPlaybackRate));this._media_element.playbackRate!==t&&(c.a.v(this.TAG,"playbackRate ".concat(this._media_element.playbackRate," => ").concat(t)),this._media_element.playbackRate=t)}else 1!==this._media_element.playbackRate&&0!==this._media_element.playbackRate&&(c.a.v(this.TAG,"playbackRate ".concat(this._media_element.playbackRate," => 1")),this._media_element.playbackRate=1)},e.prototype._getCurrentLatency=function(){if(!this._media_element)return 0;var e=this._media_element.buffered,t=this._media_element.currentTime;return 0==e.length?0:e.end(e.length-1)-t},e}(),S=function(){function e(e,t){this.TAG="PlayerEngineDedicatedThread",this._emitter=new s,this._media_element=null,this._worker_destroying=!1,this._seeking_handler=null,this._loading_controller=null,this._startup_stall_jumper=null,this._live_latency_chaser=null,this._live_latency_synchronizer=null,this._pending_seek_time=null,this._media_info=null,this._statistics_info=null,this.e=null,this._prev_ready_state=0,this._media_data_source=e,this._config=o(),"object"==typeof t&&Object.assign(this._config,t),!0===e.isLive&&(this._config.isLive=!0),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this),onMediaLoadedMetadata:this._onMediaLoadedMetadata.bind(this),onMediaTimeUpdate:this._onMediaTimeUpdate.bind(this),onMediaReadyStateChanged:this._onMediaReadyStateChange.bind(this)},u.a.registerListener(this.e.onLoggingConfigChanged),this._worker=d(33,{all:!0}),this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",media_data_source:this._media_data_source,config:this._config}),this._worker.postMessage({cmd:"logging_config",logging_config:u.a.getConfig()})}return e.isSupported=function(){return!!self.Worker&&(!(!self.MediaSource||!("canConstructInDedicatedWorker"in self.MediaSource)||!0!==self.MediaSource.canConstructInDedicatedWorker)||!(!self.ManagedMediaSource||!("canConstructInDedicatedWorker"in self.ManagedMediaSource)||!0!==self.ManagedMediaSource.canConstructInDedicatedWorker))},e.prototype.destroy=function(){this._emitter.emit(h.a.DESTROYING),this.unload(),this.detachMediaElement(),this._worker_destroying=!0,this._worker.postMessage({cmd:"destroy"}),u.a.removeListener(this.e.onLoggingConfigChanged),this.e=null,this._media_data_source=null,this._emitter.removeAllListeners(),this._emitter=null},e.prototype.on=function(e,t){var i=this;this._emitter.addListener(e,t),e===h.a.MEDIA_INFO&&this._media_info?Promise.resolve().then((function(){return i._emitter.emit(h.a.MEDIA_INFO,i.mediaInfo)})):e==h.a.STATISTICS_INFO&&this._statistics_info&&Promise.resolve().then((function(){return i._emitter.emit(h.a.STATISTICS_INFO,i.statisticsInfo)}))},e.prototype.off=function(e,t){this._emitter.removeListener(e,t)},e.prototype.attachMediaElement=function(e){this._media_element=e,this._media_element.src="",this._media_element.removeAttribute("src"),this._media_element.srcObject=null,this._media_element.load(),this._media_element.addEventListener("loadedmetadata",this.e.onMediaLoadedMetadata),this._media_element.addEventListener("timeupdate",this.e.onMediaTimeUpdate),this._media_element.addEventListener("emptied",this.e.onMediaReadyStateChanged),this._media_element.addEventListener("ended",this.e.onMediaReadyStateChanged),this._media_element.addEventListener("waiting",this.e.onMediaReadyStateChanged),this._media_element.addEventListener("canplay",this.e.onMediaReadyStateChanged),this._media_element.addEventListener("canplaythrough",this.e.onMediaReadyStateChanged),this._media_element.addEventListener("loadstart",this.e.onMediaReadyStateChanged),this._media_element.addEventListener("loadeddata",this.e.onMediaReadyStateChanged),this._media_element.addEventListener("loadedmetadata",this.e.onMediaReadyStateChanged),this._media_element.addEventListener("progress",this.e.onMediaReadyStateChanged),this._media_element.addEventListener("stalled",this.e.onMediaReadyStateChanged),this._worker.postMessage({cmd:"initialize_mse"})},e.prototype.detachMediaElement=function(){this._worker.postMessage({cmd:"shutdown_mse"}),this._media_element&&(this._media_element.removeEventListener("loadedmetadata",this.e.onMediaLoadedMetadata),this._media_element.removeEventListener("timeupdate",this.e.onMediaTimeUpdate),this._media_element.removeEventListener("emptied",this.e.onMediaReadyStateChanged),this._media_element.removeEventListener("ended",this.e.onMediaReadyStateChanged),this._media_element.removeEventListener("waiting",this.e.onMediaReadyStateChanged),this._media_element.removeEventListener("canplay",this.e.onMediaReadyStateChanged),this._media_element.removeEventListener("canplaythrough",this.e.onMediaReadyStateChanged),this._media_element.removeEventListener("loadstart",this.e.onMediaReadyStateChanged),this._media_element.removeEventListener("loadeddata",this.e.onMediaReadyStateChanged),this._media_element.removeEventListener("loadedmetadata",this.e.onMediaReadyStateChanged),this._media_element.removeEventListener("progress",this.e.onMediaReadyStateChanged),this._media_element.removeEventListener("stalled",this.e.onMediaReadyStateChanged),this._media_element.src="",this._media_element.removeAttribute("src"),this._media_element.srcObject=null,this._media_element.load(),this._media_element=null)},e.prototype.load=function(){this._worker.postMessage({cmd:"load"}),this._seeking_handler=new g(this._config,this._media_element,this._onRequiredUnbufferedSeek.bind(this)),this._loading_controller=new v(this._config,this._media_element,this._onRequestPauseTransmuxer.bind(this),this._onRequestResumeTransmuxer.bind(this)),this._startup_stall_jumper=new E(this._media_element,this._onRequestDirectSeek.bind(this)),this._config.isLive&&this._config.liveBufferLatencyChasing&&(this._live_latency_chaser=new y(this._config,this._media_element,this._onRequestDirectSeek.bind(this))),this._config.isLive&&this._config.liveSync&&(this._live_latency_synchronizer=new T(this._config,this._media_element)),this._media_element.readyState>0&&this._seeking_handler.directSeek(0)},e.prototype.unload=function(){var e,t,i,a,n,r;null===(e=this._media_element)||void 0===e||e.pause(),this._worker.postMessage({cmd:"unload"}),null===(t=this._live_latency_synchronizer)||void 0===t||t.destroy(),this._live_latency_synchronizer=null,null===(i=this._live_latency_chaser)||void 0===i||i.destroy(),this._live_latency_chaser=null,null===(a=this._startup_stall_jumper)||void 0===a||a.destroy(),this._startup_stall_jumper=null,null===(n=this._loading_controller)||void 0===n||n.destroy(),this._loading_controller=null,null===(r=this._seeking_handler)||void 0===r||r.destroy(),this._seeking_handler=null},e.prototype.play=function(){return this._media_element.play()},e.prototype.pause=function(){this._media_element.pause()},e.prototype.seek=function(e){this._media_element&&this._seeking_handler?this._seeking_handler.seek(e):this._pending_seek_time=e},Object.defineProperty(e.prototype,"mediaInfo",{get:function(){return Object.assign({},this._media_info)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"statisticsInfo",{get:function(){return Object.assign({},this._statistics_info)},enumerable:!1,configurable:!0}),e.prototype._onLoggingConfigChanged=function(e){var t;null===(t=this._worker)||void 0===t||t.postMessage({cmd:"logging_config",logging_config:e})},e.prototype._onMSEUpdateEnd=function(){this._config.isLive&&this._config.liveBufferLatencyChasing&&this._live_latency_chaser&&this._live_latency_chaser.notifyBufferedRangeUpdate(),this._loading_controller.notifyBufferedPositionChanged()},e.prototype._onMSEBufferFull=function(){c.a.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._loading_controller.suspendTransmuxer()},e.prototype._onMediaLoadedMetadata=function(e){null!=this._pending_seek_time&&(this._seeking_handler.seek(this._pending_seek_time),this._pending_seek_time=null)},e.prototype._onRequestDirectSeek=function(e){this._seeking_handler.directSeek(e)},e.prototype._onRequiredUnbufferedSeek=function(e){this._worker.postMessage({cmd:"unbuffered_seek",milliseconds:e})},e.prototype._onRequestPauseTransmuxer=function(){this._worker.postMessage({cmd:"pause_transmuxer"})},e.prototype._onRequestResumeTransmuxer=function(){this._worker.postMessage({cmd:"resume_transmuxer"})},e.prototype._onMediaTimeUpdate=function(e){this._worker.postMessage({cmd:"timeupdate",current_time:e.target.currentTime})},e.prototype._onMediaReadyStateChange=function(){var e;null!=this._media_element&&this._prev_ready_state!==(null===(e=this._media_element)||void 0===e?void 0:e.readyState)&&(this._prev_ready_state=this._media_element.readyState,this._worker.postMessage({cmd:"readystatechange",ready_state:this._media_element.readyState}))},e.prototype._onWorkerMessage=function(e){var t,i=e.data,a=i.msg;if("destroyed"==a||this._worker_destroying)return this._worker_destroying=!1,null===(t=this._worker)||void 0===t||t.terminate(),void(this._worker=null);switch(a){case"mse_init":var n=i;"ManagedMediaSource"in self&&!("MediaSource"in self)&&(this._media_element.disableRemotePlayback=!0),this._media_element.srcObject=n.handle;break;case"mse_event":(n=i).event==l.a.UPDATE_END?this._onMSEUpdateEnd():n.event==l.a.BUFFER_FULL&&this._onMSEBufferFull();break;case"transmuxing_event":if((n=i).event==f.a.MEDIA_INFO){var r=i;this._media_info=r.info,this._emitter.emit(h.a.MEDIA_INFO,Object.assign({},r.info))}else if(n.event==f.a.STATISTICS_INFO){var o=i;this._statistics_info=this._fillStatisticsInfo(o.info),this._emitter.emit(h.a.STATISTICS_INFO,Object.assign({},o.info))}else if(n.event==f.a.RECOMMEND_SEEKPOINT){var s=i;this._media_element&&!this._config.accurateSeek&&this._seeking_handler.directSeek(s.milliseconds/1e3)}break;case"player_event":if((n=i).event==h.a.ERROR){var _=i;this._emitter.emit(h.a.ERROR,_.error_type,_.error_detail,_.info)}else if("extraData"in n){var d=i;this._emitter.emit(d.event,d.extraData)}break;case"logcat_callback":n=i;c.a.emitter.emit("log",n.type,n.logcat);break;case"buffered_position_changed":n=i;this._loading_controller.notifyBufferedPositionChanged(n.buffered_position_milliseconds/1e3);break;case"system_clock":n=i;var u=(performance.now()+performance.timeOrigin-n.received_time)/1e3;this._config.isLive&&this._config.systemClockSync&&this._config.liveBufferLatencyChasing&&this._live_latency_chaser&&this._live_latency_chaser.onSystemClock(n.system_clock+u),this._config.isLive&&this._config.systemClockSync&&this._config.liveSync&&this._live_latency_synchronizer&&this._live_latency_synchronizer.onSystemClock(n.system_clock+u),this._emitter.emit(h.a.SYSTEM_CLOCK,{system_clock:n.system_clock+u})}},e.prototype._fillStatisticsInfo=function(e){if(e.playerType="MSEPlayer",!(this._media_element instanceof HTMLVideoElement))return e;var t=!0,i=0,a=0;if(this._media_element.getVideoPlaybackQuality){var n=this._media_element.getVideoPlaybackQuality();i=n.totalVideoFrames,a=n.droppedVideoFrames}else null!=this._media_element.webkitDecodedFrameCount?(i=this._media_element.webkitDecodedFrameCount,a=this._media_element.webkitDroppedFrameCount):t=!1;return t&&(e.decodedFrames=i,e.droppedFrames=a),e},e.prototype.switchAudioTrack=function(e){this._worker.postMessage({cmd:"switch_audio_track",id:e}),this._config.isLive||this._worker.postMessage({cmd:"reset_audio",milliseconds:Math.floor(1e3*this._media_element.currentTime)})},e}(),A=function(){function e(){}return e.supportMSEH264Playback=function(){var e=self.MediaSource&&self.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),t=self.ManagedMediaSource&&self.ManagedMediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"');return!0===e||!0===t},e.supportMSEH265Playback=function(){var e=self.MediaSource&&self.MediaSource.isTypeSupported('video/mp4; codecs="hvc1.1.6.L93.B0"'),t=self.ManagedMediaSource&&self.ManagedMediaSource.isTypeSupported('video/mp4; codecs="hvc1.1.6.L93.B0"');return!0===e||!0===t},e.supportWorkerForMSEH265Playback=function(){return new Promise((function(e){if(S.isSupported()){var t=URL.createObjectURL(new Blob(["\n                const hevc_mime_type = 'video/mp4; codecs=\"hvc1.1.6.L93.B0\"';\n                const support_w3c_mse = self.MediaSource && self.MediaSource.isTypeSupported(hevc_mime_type);\n                const support_apple_mme = self.ManagedMediaSource && self.ManagedMediaSource.isTypeSupported(hevc_mime_type);\n                self.postMessage(support_w3c_mse === true || support_apple_mme === true);\n            "],{type:"application/javascript"}));new Worker(t).addEventListener("message",(function(t){return e(t.data)})),URL.revokeObjectURL(t)}else e(!1)}))},e.supportNetworkStreamIO=function(){var e=new n.a({},o()),t=e.loaderType;return e.destroy(),"fetch-stream-loader"==t||"xhr-moz-chunked-loader"==t},e.getNetworkLoaderTypeName=function(){var e=new n.a({},o()),t=e.loaderType;return e.destroy(),t},e.supportNativeMediaPlayback=function(t){null==e.videoElement&&(e.videoElement=window.document.createElement("video"));var i=e.videoElement.canPlayType(t);return"probably"===i||"maybe"==i},e.getFeatureList=function(){var t={msePlayback:!1,mseLivePlayback:!1,mseH265Playback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeMP4H265Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return t.msePlayback=e.supportMSEH264Playback(),t.networkStreamIO=e.supportNetworkStreamIO(),t.networkLoaderName=e.getNetworkLoaderTypeName(),t.mseLivePlayback=t.msePlayback&&t.networkStreamIO,t.mseH265Playback=e.supportMSEH265Playback(),t.nativeMP4H264Playback=e.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),t.nativeMP4H265Playback=e.supportNativeMediaPlayback('video/mp4; codecs="hvc1.1.6.L93.B0"'),t.nativeWebmVP8Playback=e.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),t.nativeWebmVP9Playback=e.supportNativeMediaPlayback('video/webm; codecs="vp9"'),t},e}(),R=i(2),b=i(22),I=i(23),M=i(12),O=i(3),C=function(){function e(e,t){this.TAG="PlayerEngineMainThread",this._emitter=new s,this._media_element=null,this._mse_controller=null,this._transmuxer=null,this._pending_seek_time=null,this._seeking_handler=null,this._loading_controller=null,this._startup_stall_jumper=null,this._live_latency_chaser=null,this._live_latency_synchronizer=null,this._mse_source_opened=!1,this._has_pending_load=!1,this._loaded_metadata_received=!1,this._media_info=null,this._statistics_info=null,this.e=null,this._media_data_source=e,this._config=o(),"object"==typeof t&&Object.assign(this._config,t),!0===e.isLive&&(this._config.isLive=!0),this.e={onMediaLoadedMetadata:this._onMediaLoadedMetadata.bind(this)}}return e.prototype.destroy=function(){this._emitter.emit(h.a.DESTROYING),this._transmuxer&&this.unload(),this._media_element&&this.detachMediaElement(),this.e=null,this._media_data_source=null,this._emitter.removeAllListeners(),this._emitter=null},e.prototype.on=function(e,t){var i=this;this._emitter.addListener(e,t),e===h.a.MEDIA_INFO&&this._media_info?Promise.resolve().then((function(){return i._emitter.emit(h.a.MEDIA_INFO,i.mediaInfo)})):e==h.a.STATISTICS_INFO&&this._statistics_info&&Promise.resolve().then((function(){return i._emitter.emit(h.a.STATISTICS_INFO,i.statisticsInfo)}))},e.prototype.off=function(e,t){this._emitter.removeListener(e,t)},e.prototype.attachMediaElement=function(e){var t=this;this._media_element=e,e.src="",e.removeAttribute("src"),e.srcObject=null,e.load(),e.addEventListener("loadedmetadata",this.e.onMediaLoadedMetadata),this._mse_controller=new b.a(this._config),this._mse_controller.on(l.a.UPDATE_END,this._onMSEUpdateEnd.bind(this)),this._mse_controller.on(l.a.BUFFER_FULL,this._onMSEBufferFull.bind(this)),this._mse_controller.on(l.a.SOURCE_OPEN,this._onMSESourceOpen.bind(this)),this._mse_controller.on(l.a.ERROR,this._onMSEError.bind(this)),this._mse_controller.on(l.a.START_STREAMING,this._onMSEStartStreaming.bind(this)),this._mse_controller.on(l.a.END_STREAMING,this._onMSEEndStreaming.bind(this)),this._mse_controller.initialize({getCurrentTime:function(){return t._media_element.currentTime},getReadyState:function(){return t._media_element.readyState}}),this._mse_controller.isManagedMediaSource()?(e.disableRemotePlayback=!0,e.srcObject=this._mse_controller.getObject()):e.src=this._mse_controller.getObjectURL()},e.prototype.detachMediaElement=function(){this._media_element&&(this._mse_controller.shutdown(),this._media_element.removeEventListener("loadedmetadata",this.e.onMediaLoadedMetadata),this._media_element.src="",this._media_element.removeAttribute("src"),this._media_element.srcObject=null,this._media_element.load(),this._media_element=null,this._mse_controller.revokeObjectURL()),this._mse_controller&&(this._mse_controller.destroy(),this._mse_controller=null)},e.prototype.load=function(){var e=this;if(!this._media_element)throw new O.a("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new O.a("load() has been called, please call unload() first!");this._has_pending_load||(!this._config.deferLoadAfterSourceOpen||this._mse_source_opened?(this._transmuxer=new I.a(this._media_data_source,this._config),this._transmuxer.on(f.a.INIT_SEGMENT,(function(t,i){e._mse_controller.appendInitSegment(i)})),this._transmuxer.on(f.a.MEDIA_SEGMENT,(function(t,i){e._mse_controller.appendMediaSegment(i),!e._config.isLive&&"video"===t&&i.data&&i.data.byteLength>0&&"info"in i&&e._seeking_handler.appendSyncPoints(i.info.syncPoints),e._loading_controller.notifyBufferedPositionChanged(i.info.endDts/1e3)})),this._transmuxer.on(f.a.LOADING_COMPLETE,(function(){e._mse_controller.endOfStream(),e._emitter.emit(h.a.LOADING_COMPLETE)})),this._transmuxer.on(f.a.RECOVERED_EARLY_EOF,(function(){e._emitter.emit(h.a.RECOVERED_EARLY_EOF)})),this._transmuxer.on(f.a.IO_ERROR,(function(t,i){e._emitter.emit(h.a.ERROR,M.b.NETWORK_ERROR,t,i)})),this._transmuxer.on(f.a.DEMUX_ERROR,(function(t,i){e._emitter.emit(h.a.ERROR,M.b.MEDIA_ERROR,t,i)})),this._transmuxer.on(f.a.MEDIA_INFO,(function(t){e._media_info=t,e._emitter.emit(h.a.MEDIA_INFO,Object.assign({},t))})),this._transmuxer.on(f.a.STATISTICS_INFO,(function(t){e._statistics_info=e._fillStatisticsInfo(t),e._emitter.emit(h.a.STATISTICS_INFO,Object.assign({},t))})),this._transmuxer.on(f.a.RECOMMEND_SEEKPOINT,(function(t){e._media_element&&!e._config.accurateSeek&&e._seeking_handler.directSeek(t/1e3)})),this._transmuxer.on(f.a.METADATA_ARRIVED,(function(t){e._emitter.emit(h.a.METADATA_ARRIVED,t)})),this._transmuxer.on(f.a.SCRIPTDATA_ARRIVED,(function(t){e._emitter.emit(h.a.SCRIPTDATA_ARRIVED,t)})),this._transmuxer.on(f.a.TIMED_ID3_METADATA_ARRIVED,(function(t){e._emitter.emit(h.a.TIMED_ID3_METADATA_ARRIVED,t)})),this._transmuxer.on(f.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,(function(t){e._emitter.emit(h.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,t)})),this._transmuxer.on(f.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,(function(t){e._emitter.emit(h.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,t)})),this._transmuxer.on(f.a.SMPTE2038_METADATA_ARRIVED,(function(t){e._emitter.emit(h.a.SMPTE2038_METADATA_ARRIVED,t)})),this._transmuxer.on(f.a.SCTE35_METADATA_ARRIVED,(function(t){e._emitter.emit(h.a.SCTE35_METADATA_ARRIVED,t)})),this._transmuxer.on(f.a.PES_PRIVATE_DATA_DESCRIPTOR,(function(t){e._emitter.emit(h.a.PES_PRIVATE_DATA_DESCRIPTOR,t)})),this._transmuxer.on(f.a.PES_PRIVATE_DATA_ARRIVED,(function(t){e._emitter.emit(h.a.PES_PRIVATE_DATA_ARRIVED,t)})),this._transmuxer.on(f.a.DURATION_AVAILABLE,(function(t){e._mse_controller.onDurationAvailable(t)})),this._transmuxer.on(f.a.SYSTEM_CLOCK,(function(t,i){var a=(performance.now()+performance.timeOrigin-i)/1e3;e._config.isLive&&e._config.systemClockSync&&e._config.liveBufferLatencyChasing&&e._live_latency_chaser&&e._live_latency_chaser.onSystemClock(t+a),e._config.isLive&&e._config.systemClockSync&&e._config.liveSync&&e._live_latency_synchronizer&&e._live_latency_synchronizer.onSystemClock(t+a),e._emitter.emit(h.a.SYSTEM_CLOCK,{system_clock:t+a})})),this._transmuxer.on(f.a.AUDIO_TRACKS_METADATA,(function(t){e._emitter.emit(h.a.AUDIO_TRACKS_METADATA,t)})),this._seeking_handler=new g(this._config,this._media_element,this._onRequiredUnbufferedSeek.bind(this)),this._loading_controller=new v(this._config,this._media_element,this._onRequestPauseTransmuxer.bind(this),this._onRequestResumeTransmuxer.bind(this)),this._startup_stall_jumper=new E(this._media_element,this._onRequestDirectSeek.bind(this)),this._config.isLive&&this._config.liveBufferLatencyChasing&&(this._live_latency_chaser=new y(this._config,this._media_element,this._onRequestDirectSeek.bind(this))),this._config.isLive&&this._config.liveSync&&(this._live_latency_synchronizer=new T(this._config,this._media_element)),this._media_element.readyState>0&&this._seeking_handler.directSeek(0),this._transmuxer.open()):this._has_pending_load=!0)},e.prototype.unload=function(){var e,t,i,a,n,r,o,s,_;null===(e=this._media_element)||void 0===e||e.pause(),null===(t=this._live_latency_synchronizer)||void 0===t||t.destroy(),this._live_latency_synchronizer=null,null===(i=this._live_latency_chaser)||void 0===i||i.destroy(),this._live_latency_chaser=null,null===(a=this._startup_stall_jumper)||void 0===a||a.destroy(),this._startup_stall_jumper=null,null===(n=this._loading_controller)||void 0===n||n.destroy(),this._loading_controller=null,null===(r=this._seeking_handler)||void 0===r||r.destroy(),this._seeking_handler=null,null===(o=this._mse_controller)||void 0===o||o.flush(),null===(s=this._transmuxer)||void 0===s||s.close(),null===(_=this._transmuxer)||void 0===_||_.destroy(),this._transmuxer=null},e.prototype.play=function(){return this._media_element.play()},e.prototype.pause=function(){this._media_element.pause()},e.prototype.seek=function(e){this._media_element&&this._seeking_handler?this._seeking_handler.seek(e):this._pending_seek_time=e},Object.defineProperty(e.prototype,"mediaInfo",{get:function(){return Object.assign({},this._media_info)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"statisticsInfo",{get:function(){return Object.assign({},this._statistics_info)},enumerable:!1,configurable:!0}),e.prototype._onMSESourceOpen=function(){this._mse_source_opened=!0,this._has_pending_load&&(this._has_pending_load=!1,this.load())},e.prototype._onMSEUpdateEnd=function(){this._config.isLive&&this._config.liveBufferLatencyChasing&&this._live_latency_chaser&&this._live_latency_chaser.notifyBufferedRangeUpdate(),this._loading_controller.notifyBufferedPositionChanged()},e.prototype._onMSEBufferFull=function(){c.a.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._loading_controller.suspendTransmuxer()},e.prototype._onMSEError=function(e){this._emitter.emit(h.a.ERROR,M.b.MEDIA_ERROR,M.a.MEDIA_MSE_ERROR,e)},e.prototype._onMSEStartStreaming=function(){this._loaded_metadata_received&&(this._config.isLive||(c.a.v(this.TAG,"Resume transmuxing task due to ManagedMediaSource onStartStreaming"),this._loading_controller.resumeTransmuxer()))},e.prototype._onMSEEndStreaming=function(){this._config.isLive||(c.a.v(this.TAG,"Suspend transmuxing task due to ManagedMediaSource onEndStreaming"),this._loading_controller.suspendTransmuxer())},e.prototype._onMediaLoadedMetadata=function(e){this._loaded_metadata_received=!0,null!=this._pending_seek_time&&(this._seeking_handler.seek(this._pending_seek_time),this._pending_seek_time=null)},e.prototype._onRequestDirectSeek=function(e){this._seeking_handler.directSeek(e)},e.prototype._onRequiredUnbufferedSeek=function(e){this._mse_controller.flush(),this._transmuxer.seek(e)},e.prototype._onRequestPauseTransmuxer=function(){this._transmuxer.pause()},e.prototype._onRequestResumeTransmuxer=function(){this._transmuxer.resume()},e.prototype._fillStatisticsInfo=function(e){if(e.playerType="MSEPlayer",!(this._media_element instanceof HTMLVideoElement))return e;var t=!0,i=0,a=0;if(this._media_element.getVideoPlaybackQuality){var n=this._media_element.getVideoPlaybackQuality();i=n.totalVideoFrames,a=n.droppedVideoFrames}else null!=this._media_element.webkitDecodedFrameCount?(i=this._media_element.webkitDecodedFrameCount,a=this._media_element.webkitDroppedFrameCount):t=!1;return t&&(e.decodedFrames=i,e.droppedFrames=a),e},e.prototype.switchAudioTrack=function(e){this._transmuxer.switchAudioTrack(e),this._config.isLive||(this._mse_controller.flush("audio"),this._transmuxer.seek(Math.floor(1e3*this._media_element.currentTime)))},e}(),D=function(){function e(e,t){this.TAG="MSEPlayer",this._type="MSEPlayer",this._media_element=null,this._player_engine=null;var i=e.type.toLowerCase();if("mse"!==i&&"mpegts"!==i&&"m2ts"!==i&&"flv"!==i&&"mmttlv"!==i)throw new O.b("MSEPlayer requires an mpegts/m2ts/flv/mmttlv MediaDataSource input!");if(t&&t.enableWorkerForMSE&&S.isSupported())try{this._player_engine=new S(e,t)}catch(i){c.a.e(this.TAG,"Error while initializing PlayerEngineDedicatedThread, fallback to PlayerEngineMainThread"),this._player_engine=new C(e,t)}else this._player_engine=new C(e,t)}return e.prototype.destroy=function(){this._player_engine.destroy(),this._player_engine=null,this._media_element=null},e.prototype.on=function(e,t){this._player_engine.on(e,t)},e.prototype.off=function(e,t){this._player_engine.off(e,t)},e.prototype.attachMediaElement=function(e){this._media_element=e,this._player_engine.attachMediaElement(e)},e.prototype.detachMediaElement=function(){this._media_element=null,this._player_engine.detachMediaElement()},e.prototype.load=function(){this._player_engine.load()},e.prototype.unload=function(){this._player_engine.unload()},e.prototype.play=function(){return this._player_engine.play()},e.prototype.pause=function(){this._player_engine.pause()},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buffered",{get:function(){return this._media_element.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._media_element.duration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._media_element.volume},set:function(e){this._media_element.volume=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return this._media_element.muted},set:function(e){this._media_element.muted=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._media_element?this._media_element.currentTime:0},set:function(e){this._player_engine.seek(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mediaInfo",{get:function(){return this._player_engine.mediaInfo},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"statisticsInfo",{get:function(){return this._player_engine.statisticsInfo},enumerable:!1,configurable:!0}),e.prototype.switchAudioTrack=function(e){this._player_engine.switchAudioTrack(e)},e}(),L=function(){function e(e,t){this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new _.a,this._config=o(),"object"==typeof t&&Object.assign(this._config,t);var i=e.type.toLowerCase();if("mse"===i||"mpegts"===i||"m2ts"===i||"flv"===i)throw new O.b("NativePlayer does't support mse/mpegts/m2ts/flv MediaDataSource input!");if(e.hasOwnProperty("segments"))throw new O.b("NativePlayer(".concat(e.type,") doesn't support multipart playback!"));this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=e,this._mediaElement=null}return e.prototype.destroy=function(){this._emitter.emit(h.a.DESTROYING),this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},e.prototype.on=function(e,t){var i=this;e===h.a.MEDIA_INFO?null!=this._mediaElement&&0!==this._mediaElement.readyState&&Promise.resolve().then((function(){i._emitter.emit(h.a.MEDIA_INFO,i.mediaInfo)})):e===h.a.STATISTICS_INFO&&null!=this._mediaElement&&0!==this._mediaElement.readyState&&Promise.resolve().then((function(){i._emitter.emit(h.a.STATISTICS_INFO,i.statisticsInfo)})),this._emitter.addListener(e,t)},e.prototype.off=function(e,t){this._emitter.removeListener(e,t)},e.prototype.attachMediaElement=function(e){if(this._mediaElement=e,e.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),null!=this._pendingSeekTime)try{e.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(e){}},e.prototype.detachMediaElement=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),null!=this._statisticsReporter&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},e.prototype.load=function(){if(!this._mediaElement)throw new O.a("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)},e.prototype.unload=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),null!=this._statisticsReporter&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},e.prototype.play=function(){return this._mediaElement.play()},e.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(e){this._mediaElement.volume=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(e){this._mediaElement.muted=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(e){this._mediaElement?this._mediaElement.currentTime=e:this._pendingSeekTime=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mediaInfo",{get:function(){var e={mimeType:(this._mediaElement instanceof HTMLAudioElement?"audio/":"video/")+this._mediaDataSource.type};return this._mediaElement&&(e.duration=Math.floor(1e3*this._mediaElement.duration),this._mediaElement instanceof HTMLVideoElement&&(e.width=this._mediaElement.videoWidth,e.height=this._mediaElement.videoHeight)),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"statisticsInfo",{get:function(){var e={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return e;var t=!0,i=0,a=0;if(this._mediaElement.getVideoPlaybackQuality){var n=this._mediaElement.getVideoPlaybackQuality();i=n.totalVideoFrames,a=n.droppedVideoFrames}else null!=this._mediaElement.webkitDecodedFrameCount?(i=this._mediaElement.webkitDecodedFrameCount,a=this._mediaElement.webkitDroppedFrameCount):t=!1;return t&&(e.decodedFrames=i,e.droppedFrames=a),e},enumerable:!1,configurable:!0}),e.prototype._onvLoadedMetadata=function(e){null!=this._pendingSeekTime&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(h.a.MEDIA_INFO,this.mediaInfo)},e.prototype._reportStatisticsInfo=function(){this._emitter.emit(h.a.STATISTICS_INFO,this.statisticsInfo)},e.prototype.switchAudioTrack=function(e){if(!("audioTracks"in this._mediaElement))throw new O.b("NativePlayer doesn't support switchAudioTrack");for(var t=this._mediaElement.audioTracks,i=0;i<t.length;i++)t[i].enabled=e===String(i)},e}();a.a.install();var P={createPlayer:function(e,t){var i=e;if(null==i||"object"!=typeof i)throw new O.b("MediaDataSource must be an javascript object!");if(!i.hasOwnProperty("type"))throw new O.b("MediaDataSource must has type field to indicate video file type!");switch(i.type){case"mse":case"mpegts":case"m2ts":case"flv":case"mmttlv":return new D(i,t);default:return new L(i,t)}},isSupported:function(){return A.supportMSEH264Playback()},getFeatureList:function(){return A.getFeatureList()},supportWorkerForMSEH265Playback:function(){return A.supportWorkerForMSEH265Playback()}};P.BaseLoader=R.a,P.LoaderStatus=R.c,P.LoaderErrors=R.b,P.Events=h.a,P.ErrorTypes=M.b,P.ErrorDetails=M.a,P.MSEPlayer=D,P.NativePlayer=L,P.LoggingControl=u.a,Object.defineProperty(P,"version",{enumerable:!0,get:function(){return"1.7.3"}});t.default=P}])}));
//# sourceMappingURL=mpegts.js.map